flexbe_cli.entity.setClientJs("element","text01",{isPure:!0});function te(r,t){let e=r.getBoundingClientRect();return{x:t.clientX-e.left,y:t.clientY-e.top}}function ee(){var r;let t=typeof flexbe_cli=="object"&&((r=flexbe_cli.vars)==null?void 0:r.site.images)||{};return{lazy:!0,lazy_priority:!1,avif:!1,webp:!1,avif_support:t.avif_support,webp_support:t.webp_support,slow_network:!1,maxSize:2160,minSize:150,quality_map:{jpg:70,webp:70,avif:55}}}async function U(r){return new Promise((t,e)=>{let i=new Image,s=()=>{t(i),setTimeout(()=>{typeof i.remove=="function"&&i.remove()},10)};"decode"in i&&!/\.svg/.test(r)?(i.src=r,i.decode().then(s).catch(e)):(i.onerror=e,i.onload=s,i.src=r)})}function ie(r,t){let e=t.avif_support,i=t.webp_support,s=t.avif,a=t.webp,n=r.ext;return e&&s?n="avif":i&&a?n="webp":r.ext==="webp"&&(n=i?"webp":r.transparent?"png":"jpg"),n}function J(r){if(typeof r=="string"&&(r=function(a){if(typeof a!="string")return a;a=a.replace(/(\/img\/[\d_q]+)\/[\w-]+(\.\w{3,4})/i,"$1$2");let[,n,o,l,d]=a.match(/\/img\/(\d+)_?(\d+)?_?q?(\d+)?\.(\w{3,4})/i)||[];return{id:+n,ext:d,name:`${n}.${d}`,size:o?+o:0,quality:l?+l:null}}(r)),!r||typeof r!="object")return{};let t=r.img_ext||r.ext,e=r.img_id||r.id,i=r.img_name||r.name;t&&t!=="false"||(t=i?function(a){let n=String(a).match(/\.(jpg|jpeg|png|gif|svg|bmp|webp)$/i);return n&&n[1]?n[1]:""}(i):"jpg");let s=r.img_border||r.border;return{id:e,ext:t,average:function(a){return a!=="transparent"?a:"#000000"}(r.img_average||r.average),preview:r.img_preview||r.preview||"",width:r.img_width||r.width||0,height:r.img_height||r.height||0,proportion:+(+r.img_proportion||+r.proportion||0).toFixed(2),border:s,animated:r.img_animated||r.animated||t==="gif",transparent:r.img_transparent||r.transparent||0}}function B(r,t=0,e){return function(i,s=null,a=null){var n;a={...ee(),...a};let{id:o,ext:l}=i;if(!o)return"";let d=a.maxSize||2160;s||i.ext!=="webp"||a.webp_support||(s=Math.min(i.width||d,d));let h=(n=i.animated)!=null?n:l==="gif",u=`/img/${o}.${l}`;if(!s||h||l==="svg")return u;let f=ie(i,a),g=a.slow_network&&se(),c=a.quality_map;switch(g&&(c={jpg:50,webp:50,avif:45}),f){case"png":return`/img/${o}_${s}.png`;case"avif":case"webp":case"jpg":return`/img/${o}_${s}_q${c[f]}.${f}`;default:return u}}(J(r),typeof t=="number"?Math.round(t):typeof t=="string"?parseInt(t,10):null,e)}async function kt(r){let t=r,e=typeof r=="object"&&(+r.proportion||+r.img_proportion)||0;if(e&&(e<2||e<5&&e%1>0)&&(e*=100),typeof t=="string"||!e){typeof t=="object"&&(t=B(r,50));let i=await U(t);e=i.naturalHeight/i.naturalWidth*100}return e}function se(){var r;return typeof navigator>"u"?!1:(((r=navigator.connection)==null?void 0:r.effectiveType)||"4g")!=="4g"}async function q(r,t,e){e={...ee(),...e};let i=r.width||0,s=r.img_scale||r.scale||"cover",a=r.img_type||r.type||"background",n=t.height/t.width,o=await kt(r)/100,l=e.slow_network&&se()?Math.min(1.5,self.devicePixelRatio):Math.min(2,self.devicePixelRatio),d=ie(r,e),h,u;a==="image"||n>o&&s==="contain"||n<o&&s==="cover"?(h=t.width,u=h*o):(u=t.height,h=u/o),l>1&&(h*=l,u*=l),e.sizes&&(h=function(c,p){let m=(p=p.sort((v,C)=>C-v))[0];return p.forEach(v=>{c<m&&c<=v&&(m=v)}),m}(h,e.sizes),u=h*o);let f=e.minSize||150,g=e.maxSize||2160;return h<=f&&/webp|jpg/.test(d)&&(h=h/l*2,u=h*o),i&&h>i&&(h=i,u=h*o),h>g&&(h=g,u=h*o),{width:Math.ceil(h),height:Math.ceil(u)}}function w(r,t){if(!{}.hasOwnProperty.call(r,t))throw new TypeError("attempted to use private field on non-instance");return r}var ge=0;function j(r){return"__private_"+ge+++"_"+r}var Ft=new WeakMap,ae=r=>{let{is:t,component:e}=r;return Ft.has(e)||Ft.set(e,Math.floor(999999999*Math.random())),`.component-${t}-${Ft.get(e)}`},Tt=j("inheritEvents"),I=j("syncStates"),_=class{get is(){return this.constructor.is}constructor({component:t,core:e,reason:i}){Object.defineProperty(this,I,{value:$e}),Object.defineProperty(this,Tt,{value:ve}),this.require=[],this.core=null,this.owner=null,this.root=null,this.component=null,this.$component=null,this.componentWidth=null,this.componentHeight=null,this.isInited=!1,this.isLoaded=!1,this.isUpdated=!1,this.isOpen=null,this.isVisible=null,this.inScreen=!1,this.inBeside=!1,this.inView=!1,this.inFocus=!1,this.wasVisible=null,this.wasScreen=!1,this.wasBeside=!1,this.wasView=!1,this.wasFocus=!1,this.core=e,this.owner=e.area,this.root=e.root,this.component=t,this.$component=$(t),this.isUpdated=i==="update"}onInit(){}onLoad(){}onVisible(t){}onScreen(t){}onBeside(t){}onView(t){}onFocus(t){}onResize(t){}onOpen(t){}onClose(t){}onHideShowUI(t){}onDestroy(){}_clearEvents(){let t=ae(this);$(this.owner).off(t),$(this.root).off(t)}_onInit(){this.isInited=!0,typeof this.onInit=="function"&&this.onInit(),w(this,I)[I](),w(this,Tt)[Tt](),flexbe_cli.require(this.require,()=>this._onLoad())}_onLoad(){this.isLoaded=!0,typeof this.onLoad=="function"&&this.onLoad(),this.require.length&&w(this,I)[I]()}_onVisible({state:t}){if(this.isVisible==null)return this.isVisible=t,void(this.wasVisible=t);let e=t&&!this.wasVisible;this.isVisible=t,this.onVisible({state:t,first:e}),t&&(this.wasVisible=!0)}_onScreen({state:t}){let e=t&&!this.wasScreen;this.inScreen=t,this.onScreen({state:t,first:e}),t&&(this.wasScreen=!0)}_onView({state:t}){let e=t&&!this.wasView;this.inView=t,this.onView({state:t,first:e}),t&&(this.wasView=!0)}_onBeside({state:t}){let e=t&&!this.wasBeside;this.inBeside=t,this.onBeside({state:t,first:e}),t&&(this.wasBeside=!0)}_onFocus({state:t}){let e=t&&!this.wasFocus;this.inFocus=t,this.onFocus({state:t,first:e}),t&&(this.wasFocus=!0)}_onResize(t){this.onResize(t)}_onOpen(t){this.isOpen=!0,w(this,I)[I](),this.onOpen(t)}_onClose(t){this.isOpen=!1,w(this,I)[I](),this.onClose(t)}_onWindowResize(){this.onWindowResize&&(w(this,I)[I](),this.onWindowResize())}_onHideShowUI(t){this.onHideShowUI(t)}destroy(){this._clearEvents(),this.onDestroy()}};function ve(){this._clearEvents();let r=ae(this);$(this.owner).on(`tween${r}`,t=>w(this,I)[I](t.detail)),$(this.root).on(`open${r}`,t=>this._onOpen(t.detail)),$(this.root).on(`close${r}`,t=>this._onClose(t.detail))}function $e({force:r=!1}={}){let t=this.componentWidth==null||this.componentHeight==null,e=this.core.isVisible,i=e&&this.component.offsetWidth||0,s=e&&this.component.offsetHeight||0,a=!(!i&&!s),n=a&&this.core.inBeside,o=a&&this.core.inScreen,l=a&&this.core.inView,d=a&&this.core.inFocus,h=this.componentWidth!==i,u=this.componentHeight!==s,f=r||a&&!t&&(h||u);a&&(this.componentWidth=i,this.componentHeight=s),a!==this.isVisible&&this._onVisible({state:a}),f&&this._onResize({force:r}),n!==this.inBeside&&this._onBeside({state:n}),o!==this.inScreen&&this._onScreen({state:o}),l!==this.inView&&this._onView({state:l}),d!==this.inFocus&&this._onFocus({state:d})}_.is=null;var Y=class extends _{constructor(...t){super(...t),this.$glareElement=this.$component.find("> .bg-glare-hover").eq(0),this.$bgElement=this.$component.find(".bg-fill").eq(0),this.$hoverElement=this.$component.find(".bg-fill-hover").eq(0),this.lazy=this.$bgElement.data("img-lazy"),this.isImgLoaded=this.$bgElement.data("img-loaded"),this.bgType=this.$bgElement.data("type"),this.hoverType=this.$hoverElement.data("hover-type"),this.hasImagePlaceholder=!!this.$bgElement.data("img-has-placeholder"),this.imageLoadingOptions=flexbe_cli.vars.site.images}async onInit(){this.$bgElement.on("setImage",async()=>{!this.isVisible||this.isImgLoading||this.isImgLoaded||(this.setImageParams(),await this.loadImage())}),this.$glareElement.length&&this.$component.off("mousemove.bg-glare").on("mousemove.bg-glare",t=>{let{x:e,y:i}=te(this.$component[0],t);this.$glareElement.css({"--bgGlareX":`${e}px`,"--bgGlareY":`${i}px`})})}async onBeside({state:t,first:e}){t&&e&&(this.lazy&&this.bgType==="image"&&!this.isImgLoaded&&(this.setImageParams(),await this.loadImage()),this.hoverType==="image"&&(this.setHoverImageParams(),await this.loadHoverImage()),this.dispatchEffects())}onWindowResize(){this.dispatchEffects()}getComponentSize(){return{width:this.componentWidth,height:this.componentHeight}}dispatchEffects(){let t=flexbe_cli.resize.responsiveMode==="mobile",e=this.$component.hasClass("hover-trigger"),i=this.$component.hasClass("hover-trigger-am"),s=t?i:e;this.$component.toggleClass("js-hover",s)}async loadImage(){this.isImgLoading=!0;let t=0;if(!this.image.original){let{width:i}=await q(this.image,this.getComponentSize(),this.imageLoadingOptions);t=i}let e=B(this.image,t,this.imageLoadingOptions);this.hasImagePlaceholder&&await U(e),this.setImage(this.$bgElement,e),this.isImgLoading=!1,this.isImgLoaded=!0}async loadHoverImage(){let t=0;if(!this.hoverImage.original){let{width:i}=await q(this.hoverImage,this.getComponentSize(),this.imageLoadingOptions);t=i}let e=B(this.hoverImage,t,this.imageLoadingOptions);this.setImage(this.$hoverElement,e)}setImage(t,e){t.css("background-image",`url(${e})`),this.$component.find(".bg-preview").eq(0).addClass("invisible")}setImageParams(){let{$bgElement:t}=this;this.image={id:t.data("img-id"),ext:t.data("img-ext"),width:t.data("img-width"),animated:t.data("img-animated"),transparent:t.data("img-transparent"),proportion:t.data("img-proportion"),original:t.is("[data-img-original]"),type:"background",scale:"cover"}}setHoverImageParams(){let{$hoverElement:t}=this;this.hoverImage={id:t.data("img-id"),ext:t.data("img-ext"),width:t.data("img-width"),animated:t.data("img-animated"),transparent:t.data("img-transparent"),proportion:t.data("img-proportion"),original:t.is("[data-img-original]"),type:"background",scale:"cover"}}};Y.is="backgroundElement";flexbe_cli.entity.setClientJs("element","zone",{components:[Y],onInit(){this.setMeta()},onUpdate(){this.setMeta()},setMeta(){let r=this.lastViewport,t=this.hideHidden;this.lastViewport=flexbe_cli.resize.viewportWidth,this.hideHidden=flexbe_cli.is_admin&&$("body").hasClass("hide-hidden"),this.needFixOrder=this.needFixOrder||this.lastViewport!==r||this.hideHidden!==t},onResize(){this.inScreen&&this.isVisible&&this.fixElementOrder()},fixElementOrder(){if(this.setMeta(),!this.needFixOrder)return;this.needFixOrder=!1;let r=this.$area.find(".elements-list");r.find("[data-hidden]").length&&r.each((t,e)=>{let i=$(e).find(".element-item--static"),s=i.filter(":visible");i.removeClass("is-first-child is-last-child"),s.first().addClass("is-first-child"),s.last().addClass("is-last-child")})}});var O=(r,t=0)=>(...e)=>new Promise(i=>{setTimeout(()=>i(r(...e)),t)}),Dt=(r,t=0,...e)=>O(r,t)(...e),ne=(r,t=0,...e)=>((i,s=0)=>flexbe_cli.is_admin?i:O(i,s))(r,t)(...e),Rt=Symbol("ref"),oe="detached";function re(r){let t=flexbe_cli.resize.responsiveMode;$(r).find(`[data-hidden="all"], [data-hidden="${t}"]`).toArray().forEach(e=>{let i=$(`<!--${oe}-->`)[0];i[Rt]=e,$(e).before(i).detach()})}function le(r){let t=document.createNodeIterator(r,NodeFilter.SHOW_COMMENT),e=[];for(;t.nextNode();){let i=t.referenceNode;i.textContent===oe&&i[Rt]&&e.push(i)}e.forEach(i=>{let s=i[Rt];i.parentNode.replaceChild(s,i)})}function z(r,t,e,i={}){let s=$(r),a=t?`[data-component="${t}"]`:"[data-component]";s.is(a)&&s.trigger(e,i),$(r).find(a).each((n,o)=>{$(o).trigger(e,i)})}function lt(r=[]){r.forEach(O(t=>{z(t,"image","setImage")}))}function gt(r){r.params.virtualTranslate=!0,r.params.cssMode=!1,r.params.slidesPerGroup=1,r.params.spaceBetween=0,r.on("init",O(()=>{$(r.el).addClass("swiper-effect-fade")})),r.on("setTranslate",(t,e)=>{let{slides:i,size:s,slidesSizesGrid:a}=t;if(t.params.effect!=="fade"||Number.isNaN(e))return;$(t.wrapperEl).css("transform","");for(let o=0;o<i.length;o+=1){let l=t.slides.eq(o),d=a.slice(0,o).reduce((u,f)=>u+f,0),h=-(d+e)/a[o];l.css({left:`-${100*o}%`,opacity:Math.min(Math.max(1-Math.abs(h),0),1)})}let n=!1;t.slides.transitionEnd(()=>{n||!t||t.destroyed||(n=!0,t.animating=!1,$(t.wrapperEl).trigger("transitionend"))})})}var Bt=class{constructor(t,e){e={init:!0,targets:"span",...e},this.options=e,this.pagination=t,this.tag=this.options.tag,this.filled=!1,this.states=["hidden","prev-prev","prev","main","next","next-next","hidden"],this.init()}init(){this.bindEvents(),this.options.init&&this.render({states:this.states,force:!0})}bindEvents(){let{tag:t,pagination:e,options:i}=this,s=$(e);typeof i.onClick=="function"&&s.off("click").on("click",t,a=>{let n=$(a.currentTarget),o=+n.siblings('[data-state="main"]').attr("data-index"),l=+n.attr("data-index")-o;i.onClick(l)})}move(t){let e=this.states,i=this.filled&&t;if((!i||this.inAnimate!==t)&&(this.render({states:e,force:!0}),i)){let s=e.map((a,n)=>e[n+(t==="prev"?1:-1)]||"hidden");this.inAnimate=t,clearTimeout(this._anim),this._anim=setTimeout(()=>{this.inAnimate=!1},200),requestAnimationFrame(()=>{this.render({states:s})})}}render({states:t,force:e}={}){let i=$(this.pagination),s=this.tag;if(this.filled=!0,e){let a=t.reduce(n=>`${n}<${s}></${s}>`,"");i.html(a)}i.addClass("swiper-pagination-bullets-dynamic"),i.find(s).each((a,n)=>{let o=$(n),l=t[a]||"hidden",d=["swiper-pagination-bullet"];l==="main"&&d.push("swiper-pagination-bullet-active"),l==="hidden"?d.push("swiper-pagination-bullet-hidden"):d.push(`swiper-pagination-bullet-active-${l}`),o.attr("class",d.join(" ")),o.attr("data-state",l),o.attr("data-index",a)})}},Pt={},G=class extends _{constructor(...t){super(...t);let{component:e,$component:i}=this;if(this.id=this.core.id,this.mode=e.getAttribute("data-mode"),this.mode==="slider"){let s;this.require=["/_s/lib/swiper8/dist/swiper-bundle.min.js?v847"],this.$cardsRoot=i.closest(".flexbe-cards-root"),this.$slider=this.$cardsRoot.find(".swiper"),this.$pagination=this.$cardsRoot.find(".slider-pagination--cards"),this.$navigation=this.$cardsRoot.find(".slider-button--cards"),this.$swiperHelper=this.$cardsRoot.find(".swiper-mobile-helper"),this.$flexbeCardsSlider=this.$cardsRoot.find(".flexbe-cards-slider"),this.$flexbeCards=this.$cardsRoot.find(".flexbe-cards"),this.$flexbeCard=this.$cardsRoot.find(".flexbe-card"),this.sliderResponsive=this.$slider.attr("data-slider-responsive-mode"),this.$slider.on("bringIntoView",a=>{let n=this.swiper,o=$(a.target).closest(this.$flexbeCard)[0],l=this.$flexbeCard.index(o);s!==l&&(s=l,n?l!==-1&&n.slideTo(l):Pt[this.id]=l)})}}onLoad(){this.sliderDisposer(),this.core.inView&&this.initSwipeAnimation()}onBeside({state:t}){t&&this.sliderDisposer()}onScreen({state:t}){t?this.sliderDisposer():this.destroySwipeAnimation()}onView({state:t}){t&&!this.wasView&&this.swiper&&this.swiper.inited&&(this.swiper.update(),this.checkSlidesVisibility(),this.checkNavigationState()),this.toggleAutoplay(t),t&&this.isLoaded&&this.initSwipeAnimation()}onResize(){if(this.sliderDisposer(),this.swiper){let t=this.getViewportSpecificSettings();this.settings={...this.settings,...t},this.swiper.params={...this.swiper.params,...t},setTimeout(()=>{this.swiper.update(),this.checkSlidesVisibility()},10)}}onHideShowUI(){this.destroySlider(),this.initSlider()}sliderDisposer(){if(this.mode!=="slider"||!this.isLoaded||!this.core.isVisible)return;this.responsiveMode=flexbe_cli.resize.responsiveMode;let t=flexbe_cli.resize.responsiveMode==="mobile",e=this.sliderResponsive,i=t?e!=="desktop":e!=="mobile";this.$cardsRoot.toggleClass("slider-enabled",i).toggleClass("slider-disabled",!i),this.$flexbeCards.toggleClass("slider-wrapper",i),i&&!this.swiper?this.initSlider():!i&&this.swiper&&this.destroySlider()}initSlider(){if(this.mode==="slider"&&!this.swiper&&typeof Swiper<"u")try{this.savePropsFromAttributes(),this.createSwiperSettings(),this.createSwiperInstance(),this.createSwiperNavigation(),this.createSwiperLoopPagination(),this.createSwiperEditorFixes(),Dt(()=>{this.swiper.init(),Dt(()=>this.toggleAutoplay(this.core.inView))})}catch(t){console.warn(t)}}destroySlider(){this.mode==="slider"&&(this.swiper&&this.swiper.destroy(),this.swiper=null,this.$cardsRoot.removeClass("slider-inited slider-enabled"),this.$cardsRoot.addClass("slider-disabled"),this.$flexbeCardsSlider.removeClass("swiper-active"),this.$flexbeCards.removeClass("swiper-wrapper"),this.$flexbeCard.removeClass("swiper-slide-hidden"))}initSwipeAnimation(){this.mode==="slider"&&flexbe_cli.resize.responsiveMode==="mobile"&&this.sliderResponsive!=="desktop"&&!this.$swiperHelper.hasClass("show")&&setTimeout(()=>{this.core.inView&&(this.$swiperHelper.addClass("show"),this.swiper.once("sliderMove",()=>{this.destroySwipeAnimation()}))},500)}destroySwipeAnimation(){this.mode==="slider"&&this.$swiperHelper.hasClass("show")&&this.$swiperHelper.removeClass("show")}savePropsFromAttributes(){this.props={totalSlides:+this.$slider.attr("data-count"),isOverflow:+this.$slider.attr("data-overflow"),autoplayDelay:flexbe_cli.run.is_preview&&Math.floor(1e3*+this.$slider.attr("data-autoplay"))||0,pagination:this.$pagination.attr("data-type")||!1,loop:flexbe_cli.run.is_preview&&!!+this.$slider.attr("data-loop"),effectDesktop:this.$slider.attr("data-effect"),effectMobile:this.$slider.attr("data-effect-mobile"),inRowDesktop:+this.$slider.attr("data-cards"),inRowMobile:+this.$slider.attr("data-cards-mobile")||1}}createSwiperSettings(){let t=this.getViewportSpecificSettings(),{totalSlides:e,isOverflow:i,autoplayDelay:s,pagination:a}=this.props,n=!(e<=t.slidesPerView)&&this.props.loop,o=Math.max(0,Math.min(e-1,Pt[this.id]||0));if(this.freeSlides=0,n&&!i){let l=this.$slider[0].offsetWidth,d=l/t.slidesPerView,h=(flexbe_cli.resize.viewportWidth-l)/2;this.freeSlides=Math.ceil(h/d)}this.settings={autoHeight:this.$slider.find(".align-items-stretch").length===0,preloadImages:!1,allowClick:!0,preventClicks:!1,preventClicksPropagation:!1,touchStartPreventDefault:!1,touchMoveStopPropagation:!1,preventInteractionOnTransition:!1,loopPreventsSlide:!1,simulateTouch:!flexbe_cli.run.isTouch&&flexbe_cli.run.is_preview,longSwipesRatio:.1,longSwipesMs:100,initialSlide:o,loop:n,autoplay:!!s&&{delay:s,stopOnLastSlide:!n,disableOnInteraction:!0,waitForTransition:!0},navigation:{},pagination:{clickable:!0,type:n&&a==="bullets"?"custom":a,el:this.$pagination[0],dynamicBullets:this.$flexbeCard.length>7,dynamicMainBullets:t.slidesPerView,renderCustom:()=>{},formatFractionCurrent:()=>this.getGroupIndex()+1,formatFractionTotal:()=>Math.ceil(this.props.totalSlides/this.swiper.params.slidesPerView)},watchSlidesProgress:!0,loopedSlides:t.slidesPerView+this.freeSlides,...t}}getViewportSpecificSettings(){let t=flexbe_cli.resize.responsiveMode==="mobile",e=t?this.props.inRowMobile:this.props.inRowDesktop,i=t?this.props.effectMobile:this.props.effectDesktop;return e>1&&(i="slide"),{effect:i,speed:flexbe_cli.run.is_preview&&i==="fade"?450:300,slidesPerView:e}}createSwiperInstance(){this.swiper&&(this.swiper.destroy(),this.swiper=null);let t,e=!1,i=new Swiper(this.$slider[0],{init:!1,wrapperClass:"flexbe-cards",slideClass:"flexbe-card",...this.settings});var s;i.params.effect==="fade"?gt(i):((s=i).params.virtualTranslate=!0,s.params.cssMode=!1,s.on("init",O(()=>{$(s.el).addClass("swiper-effect-slide")})),s.on("setTranslate",(d,h)=>{if(d.params.effect!=="slide"||Number.isNaN(h))return;let u=$(d.wrapperEl),f=$(d.slides),g=d.isHorizontal(),c=g?h:0,p=g?0:h;flexbe_cli.is_admin?u.css({position:"relative",top:`${p}px`,left:`${c}px`,transform:""}):u.css({transform:`translate3d(${c}px, ${p}px, 0px)`}),f.css({opacity:"",transform:""})}));let a=()=>{e||(e=!0,this.$cardsRoot.addClass("slider-inited"),this.$slider.addClass("swiper-inited"));let d=this.props.totalSlides>i.params.slidesPerView;t!==d&&(t=d,this.$cardsRoot.toggleClass("slider-enabled",d),this.$cardsRoot.toggleClass("slider-disabled",!d),this.$slider.toggleClass("swiper-active",d),i.update())};flexbe_cli.is_admin||(i.on("beforeInit",()=>{re(this.swiper.el)}),i.on("destroy",()=>{le(this.swiper.el)})),i.onAny((d,h)=>{i.el.dispatchEvent(new CustomEvent(`swiper:${d}`,{detail:h,bubbles:!1,cancelable:!0}))}),i.on("init",O(()=>{a(),(()=>{if(i.loopedSlides){let d=$(i.slides).filter(`.${i.params.slideDuplicateClass}`),h={};d.each((u,f)=>{let g=$(f),c=g.attr("data-swiper-slide-index"),p=$(i.slides).eq(i.loopedSlides+ +c);h[c]=h[c]?h[c]+1:1,g.attr("data-cloned",h[c]);let m=p.find("[data-action]"),v=g.find("[data-action]");m.each((C,S)=>{let F=$(S).data();v.eq(C).data(F)})}),flexbe_cli.entity.initArea(d)}})(),(()=>{if(i.params.autoHeight){let d=new ResizeObserver(()=>{i.updateAutoHeight()});i.slides.forEach(h=>d.observe(h)),i.on("destroy",()=>{d.disconnect()}),i.on("slideChange",()=>{i.updateAutoHeight()})}})(),this.checkSlidesVisibility()})),i.on("slideChange",O(()=>{this.checkSlidesVisibility()})),i.on("resize",$.debounce(()=>{this.swiper&&(a(),this.checkSlidesVisibility())},50));let n=!1,o=()=>{this.$cardsRoot.addClass("swiper-in-interacting"),this.checkSlidesVisibility()},l=()=>{this.$cardsRoot.removeClass("swiper-in-interacting"),this.checkSlidesVisibility()};i.on("sliderFirstMove",()=>{n=!0,o()}),i.on("touchEnd",()=>{n=!1,l()}),i.on("transitionStart",()=>{n||o()}),i.on("transitionEnd",()=>{n||l(),i.realIndex+i.loopedSlides!==i.activeIndex&&i.loopFix()}),this.$slider.on("reduceSliderControls",(d,{state:h=!0})=>{this.preventAutoplay=!!h,this.preventAutoplay&&this.toggleAutoplay({state:!1}),this.$cardsRoot.toggleClass("swiper-reduce-controls",!!h)}),this.$slider.on("preventSliderMove",(d,{state:h=!0})=>{i.allowTouchMove=!h}),this.swiper=i}createSwiperNavigation(){let t=this.swiper;t.on("init",()=>{this.checkNavigationState()}),t.on("resize",$.debounce(()=>{this.swiper&&this.checkNavigationState()},50)),t.on("slideChange",()=>{this._skipSlide||this.checkNavigationState()}),this.$navigation.on("click",e=>{this[e.currentTarget.getAttribute("data-direction")==="prev"?"prevSlide":"nextSlide"]()}),this.$slider.on("click.swiper-hidden",".swiper-slide-hidden",e=>{e.preventDefault(),e.stopPropagation();let i=this.swiper;if(i.animating)return;let s=e.currentTarget,a=Array.from(i.slides||[]).findIndex(d=>d===s),n=i.activeIndex,o=n-a,l=a-(n+i.params.slidesPerView-1);o>0?this.prevSlide(o):l>0&&this.nextSlide(l)})}createSwiperLoopPagination(){let t=this.swiper,e=!1;t.on("paginationRender",()=>{if(this.$pagination.toggleClass("disabled",this.props.totalSlides<=t.params.slidesPerView),this._skipSlide||t.params.pagination.type!=="custom")return;this.customPagination||(this.customPagination=new Bt(this.$pagination[0],{init:!1,tag:"span",onClick:o=>{o<0?this.prevSlide():o>0&&this.nextSlide()}}));let i=t.previousIndex,s=t.activeIndex,a=this.props.totalSlides,n=i<s?"next":"prev";(i===s||n==="next"&&i===s-a||n==="prev"&&i===s+a)&&e||this.customPagination.move(n),e=!0})}createSwiperEditorFixes(){if(!flexbe_cli.is_admin)return;let t=this.swiper;t.on("slideChange",()=>{Pt[this.id]=t.realIndex})}checkSlidesVisibility(){let t=this.swiper;t.updateSlides();let e=$(t.slides),i=e.slice(t.activeIndex,t.activeIndex+t.params.slidesPerView),s=e.not(i);s.removeClass("swiper-slide-visible").addClass("swiper-slide-hidden"),i.removeClass("swiper-slide-hidden").addClass("swiper-slide-visible"),z(s,!1,"sliderDeactivate"),z(i,!1,"sliderActivate")}checkNavigationState(){let t=this.swiper,e=t.params.navigation.disabledClass,i=this.$navigation,s=i.eq(0),a=i.eq(1),{isBeginning:n,isEnd:o}=t;t.loopedSlides&&(n=!1,o=!1),i.toggleClass("disabled",this.props.totalSlides<=t.params.slidesPerView),s.toggleClass(e,n),a.toggleClass(e,o)}getGroupIndex(t,e,i=!0){let s=this.swiper;t==null&&(t=s.realIndex),e||(e=s.params.slidesPerView||1),i&&(s.loopedSlides||e<=1)&&(i=!1);let a=Math.ceil(this.props.totalSlides/e),n=Math.floor(t/e);if(i){let o=n*e,l=t-o>o+e-1-t,d=t%e!==0&&t+e>=this.props.totalSlides;(l||d)&&(n+=1)}return Math.max(0,Math.min(a,n))}getSlideIndex(t,e){return e==null&&(e=this.swiper.params.slidesPerView||1),t*e}toSlide(t,e){let i=this.swiper,s=this.getSlideIndex(t,e);return i.loopedSlides?i.slideToLoop(s):i.slideTo(s)}prevSlide(t){let e,i=this.swiper;t=t?Math.abs(t):1;let s=i.activeIndex;if(i.loopedSlides){let a=s,n=this.props.isOverflow?t:t+this.freeSlides;s+this.props.totalSlides<=i.slides.length&&!(a>=n)&&(this.toggleSkip(!0),i.slideTo(s+this.props.totalSlides,0)),e=i.activeIndex-t}else e=i.activeIndex-t;setTimeout(()=>{this.toggleSkip(!1),i.slideTo(e)},5)}nextSlide(t){let e,i=this.swiper,s=i.params.slidesPerView;t=t?Math.abs(t):1;let a=i.activeIndex,n=a+s-1;if(i.loopedSlides){let o=i.slides.length-n-1,l=this.props.isOverflow?t:t+this.freeSlides;a-this.props.totalSlides>=0&&!(o>=l)&&(this.toggleSkip(!0),i.slideTo(a-this.props.totalSlides,0)),e=i.activeIndex+t}else e=i.activeIndex+t;setTimeout(()=>{this.toggleSkip(!1),i.slideTo(e)},5)}toggleSkip(t=!this._skipSlide){this._skipSlide=!!t,this.$slider.toggleClass("noanimate",this._skipSlide)}toggleAutoplay(t){if(!this.swiper)return;this.preventAutoplay&&(t=!1);let e=this.swiper,i=e.autoplay,s=e.params.autoplay||{};i&&s.enabled&&(t&&!i.running?i.start():t||i.stop())}};G.is="cards";flexbe_cli.entity.setClientJs("element","zone_cards",{components:[G],onUpdate(r){r.originId===r.id&&this.fixSwiper(r)},fixSwiper(r={}){var t;clearTimeout(this._changeTimer);let e=(t=flexbe_cli.components.getInstances(this.area).filter(s=>s.is==="cards"))==null?void 0:t[0],i=e&&e.swiper;if(!i)return!1;if(document.body.contains(i.el)){if(r&&r.reason==="items_add"){let s=i.realIndex,a=r.reasonData.to,n=s;s+i.params.slidesPerView<=a&&(n=a-i.params.slidesPerView+1),n!==s&&(this._changeTimer=setTimeout(()=>i.slideTo(n),30))}r.styleRendered&&!r.templateRendered&&requestAnimationFrame(()=>i.$el&&i.update(!1))}else this._changeTimer=setTimeout(()=>this.fixSwiper(r),16)}});var L={},R=class extends _{constructor(t){super(t),this.isImgLoaded=!1,this.params=null,this.imageLoadingOptions=flexbe_cli.vars.site.images,this.lazyLoad=this.component.hasAttribute("data-img-lazy"),this.autoLoad=this.component.hasAttribute("data-img-autoload"),this.hasImagePlaceholder=this.component.hasAttribute("data-has-placeholder"),this.imageLayer=this.$component.find(".component-image__image").get(0)||this.component,this.overlayLayer=this.$component.find(".component-image__scroll").get(0)}async onInit(){this.autoLoad&&!this.lazyLoad&&await this.loadImage(),this.$component.off(".componentImage"),this.$component.on("setImage.componentImage",$.debounce(async t=>{var e;(((e=t.detail)==null?void 0:e.reason)!=="lazyPriority"||this.autoLoad)&&(this.autoLoad=!0,this.lazyLoad=!0,!this.isVisible||this.isImgLoading||this.isImgLoaded||await this.loadImage())},10))}async onBeside({state:t}){if(!t)return!1;!this.isImgLoaded&&this.autoLoad&&await this.loadImage()}async onResize(){this.isImgLoaded&&this.autoLoad&&(clearTimeout(this._resizeTimeout),this._resizeTimeout=setTimeout(()=>this.loadImage(!0),1e3))}onHideShowUI(t){t==="generation"&&requestAnimationFrame(()=>{var e;this.component&&(e=this.params)!=null&&e.position&&(this.component.style.setProperty("--imagePositionX",this.params.position.x),this.component.style.setProperty("--imagePositionY",this.params.position.y))})}async loadImage(t=!1){if(this.setParams(),!t&&(this.isImgLoaded||this.isImgLoading))return;let e;this.setOverlay();let i=this.params;i.original_resolution||(e=await this.getOptimalSize(),e&&L[this.params.id].sizes&&!L[this.params.id].sizes.includes(e)&&L[this.params.id].sizes.push(e)),this.isImgLoading=!0;let s=B(i,e,this.imageLoadingOptions);if(this.hasImagePlaceholder&&s)try{await U(s)}catch(a){return void console.error("Image preload error",a)}this.setImage(s),this.isImgLoading=!1}async getOptimalSize(){let t=this.params,e=await kt(t);t.proportion=e,L[this.params.id]&&(L[this.params.id].params.proportion=e);let i=this.componentWidth||this.component.offsetWidth,s=this.componentHeight||this.component.offsetHeight,{width:a}=await q(this.params,{width:i,height:s},this.imageLoadingOptions),n=a-2,o=Math.max(50,1.2*a);return a=this.getClosestSize(a,n,o),a}setImage(t){let{$component:e,params:i}=this;t&&(i.type==="image"?this.imageLayer.src=t:i.type==="background"&&(this.imageLayer.style.backgroundImage=`url(${t})`),this.isImgLoaded||(e.removeClass("loading"),this.isImgLoaded=!0),e.trigger("load"))}setOverlay(){let{overlayLayer:t,componentWidth:e,componentHeight:i}=this;if(!t)return;let s="medium";e<=200||i<=150?s="xsmall":e<=400||i<=250?s="small":e>=650&&i>=400&&(s="large"),t.setAttribute("data-size",s),t.getAttribute("data-type")==="hover"&&$(t).on("pointerenter pointerleave",a=>{let n=a.type==="pointerenter";$(t).toggleClass("hover",n)})}setParams(){var t;if(this.params)return;let e=this.component,i=$(e),s={},a=i.attr("data-img-id");if((t=L[a])!=null&&t.params)s={...L[a].params};else if(s.id=a,s.ext=i.attr("data-img-ext"),s.proportion=+i.attr("data-img-proportion"),s.position={x:i.attr("data-img-x")||"50%",y:i.attr("data-img-y")||"50%"},!s.ext){let n=(i.attr("data-img-name")||"image.jpg").match(/\.(\D{2,4})$/i)||[];n[1]&&s.ext!==n[1]&&(s.ext=n[1]||!1)}s.type=i.attr("data-img-type"),s.action=i.attr("data-action"),s.proportion||(s.proportion=100),s.scale=i.attr("data-img-scale")||"cover",s.original_resolution=e.hasAttribute("data-img-original"),L[s.id]||(L[s.id]={params:{...s},sizes:[]}),s.animated=e.hasAttribute("data-img-animated"),s.transparent=e.hasAttribute("data-img-transparent"),this.params=s}getClosestSize(t,e=t,i=t+10){let s=L[this.params.id].sizes||[],a,n=1/0;return s.forEach(o=>{let l=Math.abs(o-t);o>=e&&o<=i&&l<n&&(a=o,n=l)}),a??t}};R.is="image";function W(r,t,e){let i;return typeof t=="function"&&typeof r=="function"&&(r()?t():(e&&setTimeout(()=>{clearInterval(i),t()},e),i=setInterval(()=>{r()&&(clearInterval(i),t())},25))),()=>clearInterval(i)}var st=class{constructor(t){this.inited=!1,this.loaded=!1,this.destroyed=!1,this.abortController=new AbortController,this.options=t,this.target=t.target}async init(){this.inited=!0,await this.whenLoaded(),this.loaded=!0}destroy(){this.abortController.abort(),this.destroyed=!0}whenLoaded(t=()=>{}){return new Promise(e=>{if(this.loaded)return t(),void e();if(this.type==="video")this.loaded=!0,t(),e();else{let i=!1,s=setTimeout(()=>{this.loaded=!0,i||(i=!0,t(),e())},1e3);$(this.target).one("load",()=>{clearTimeout(s),this.loaded=!0,i||(i=!0,t(),e())})}})}async play(){}pause(){}onLoadData(){var t,e;(t=(e=this.options).onLoadData)==null||t.call(e)}onPlay(){var t,e;(t=(e=this.options).onPlay)==null||t.call(e)}onPause(t){var e,i;(e=(i=this.options).onPause)==null||e.call(i,t)}onError(t){var e,i;(e=(i=this.options).onError)==null||e.call(i,t)}},dt=class extends st{constructor(...t){super(...t),this.type="embed"}async init(){let t=this.target;if(!t)return;let e=t.getAttribute("data-src"),i=t.getAttribute("src");e&&!i&&(t.src=e),this.inited=!0,await this.whenLoaded(),this.loaded=!0}async play(){var t;await this.whenLoaded(),(t=this.target.contentWindow)==null||t.postMessage("play","*")}async pause(){var t;(t=this.target.contentWindow)==null||t.postMessage("pause","*")}},zt=class extends st{constructor(...t){super(...t),this.type="embed"}async init(){let t=this.target,e=t.getAttribute("data-src"),i=t.getAttribute("src"),s=a=>{a!==window.YT.PlayerState.BUFFERING&&a!==window.YT.PlayerState.PLAYING||this.onLoadData(),a===window.YT.PlayerState.PLAYING?this.onPlay():a!==window.YT.PlayerState.PAUSED&&a!==window.YT.PlayerState.ENDED||this.onPause()};e&&!i&&(t.src=e),this.inited=!0,await this.whenLoaded(),flexbe_cli.require([`https://www.youtube.com/iframe_api?origin=${window.location.host}`],()=>{!this.destroyed&&this.target.isConnected&&W(()=>{var a;return(a=window.YT)==null?void 0:a.Player},()=>{this.ytVideo=new window.YT.Player(t,{events:{onStateChange:a=>s(a.data),onReady:()=>s(this.ytVideo.getPlayerState())}})})}),this.loaded=!0}async play(){var t;await this.whenLoaded(),(t=this.target.contentWindow)==null||t.postMessage('{"event":"command","func":"playVideo","args":""}',"*")}async pause(){var t;(t=this.target.contentWindow)==null||t.postMessage('{"event":"command","func":"pauseVideo","args":""}',"*")}},Lt=class extends st{constructor(...t){super(...t),this.type="embed"}async init(){let t=this.target,e=t.getAttribute("data-src"),i=t.getAttribute("src");e&&!i&&(t.src=e),this.inited=!0,await this.whenLoaded(),flexbe_cli.require(["https://player.vimeo.com/api/player.js"],()=>{!this.destroyed&&this.target.isConnected&&(this.vPlayer=new window.Vimeo.Player(t),this.vPlayer.on("play",()=>this.onPlay()),this.vPlayer.on("pause",()=>this.onPause()))}),this.loaded=!0}async play(){await this.whenLoaded(),this.vPlayer&&this.vPlayer.play()}async pause(){this.vPlayer&&this.vPlayer.pause()}},Mt=class extends dt{constructor(...t){super(...t),this.type="embed",this.playerReady=!1,this.player=void 0}async init(){let t=this.target;if(!t)return;let e=t.src||t.dataset.src;this.inited=!0,this.loaded=!0,t.id=crypto.randomUUID();try{if(await flexbe_cli.require(["https://player.kinescope.io/latest/iframe.player.js"],null,5e3),this.destroyed||!t.isConnected)return;let i=Object.fromEntries(new URL(e).searchParams.entries());this.player=await Kinescope.IframePlayer.create(t.id,{url:e,playlist:[],behavior:{preload:"none",playsInline:!0,autoPlay:!!i.autoplay&&"viewable",autoPause:!1,localStorage:!1,loop:i.loop==="1",muted:i.muted==="1"},ui:{controls:i.controls!=="0",language:["ru","kk","be"].includes(flexbe_cli.vars.page.language)?"ru":"en"}}),this.player.on(Kinescope.IframePlayer.Events.Play,()=>this.onPlay()),this.player.on(Kinescope.IframePlayer.Events.Pause,()=>this.onPause())}catch(i){if(this.destroyed||!t||!t.isConnected)return;console.error(i),t.src!==e&&(t.src=e),await this.whenLoaded()}this.playerReady=!0}async destroy(){super.destroy(),this.player&&await this.player.destroy()}async play(){return new Promise(t=>{W(()=>this.playerReady,async()=>{var e;await((e=this.player)==null?void 0:e.play()),t()},7e3)})}async pause(){this.player&&await this.player.pause()}},Vt=class extends st{constructor(...t){super(...t),this.type="video",this._wasClicked=!1}async init(){let t=this.target,e=t.poster||t.dataset.poster,i=t.getAttribute("data-src"),s=t.getAttribute("src");if(t.addEventListener("error",a=>this.onError(a.error)),t.addEventListener("loadeddata",this.onLoadData.bind(this)),t.addEventListener("playing",this.onPlay.bind(this)),t.addEventListener("pause",()=>{let a=this._wasClicked||t.currentTime===t.duration;this.onPause(a)}),t.addEventListener("pointerup",this.onClick.bind(this)),e&&(this.target.poster=e),i&&!s){let a=document.createElement("source");a.addEventListener("error",n=>this.onError(n.error||n)),a.setAttribute("type","video/mp4"),a.setAttribute("src",i),t.appendChild(a),t.load()}this.inited=!0,await this.whenLoaded(),this.loaded=!0}async play(){await this.whenLoaded(),await this.target.play()}async pause(){this.target.pause()}onClick(){this.target.paused||(this._wasClicked=!0,setTimeout(()=>{this._wasClicked=!1},100))}},qt=class extends dt{constructor(...t){super(...t),this.playerReady=!1}async init(){await super.init(),window.addEventListener("message",t=>{let e=t.data;if(typeof e=="string")try{e=JSON.parse(t.data)}catch{}t.source===this.target.contentWindow&&(["player:ready","player:changeState"].includes(e.type)&&(this.playerReady=!0),e.type==="player:changeState"&&(e.data.state==="playing"?this.onPlay():e.data.state==="paused"&&this.onPause()))},{signal:this.abortController.signal})}async play(){this.command("player:mute"),this.command("player:setCurrentTime",{time:0}),this.command("player:play")}async pause(){this.command("player:pause")}command(t,e={}){W(()=>this.loaded&&this.playerReady,()=>{var i;(i=this.target.contentWindow)==null||i.postMessage(JSON.stringify({type:t,data:e}),"*")})}},K=j("set"),X=class extends _{constructor(...t){let e;switch(super(...t),Object.defineProperty(this,K,{value:be}),this.$preview=this.$component.find(".component-video__preview"),this.$iframe=this.$component.find("iframe"),this.$video=this.$component.find("video.custom-video"),this.type=this.$component.data("type"),this.autoplay=!!+this.$component.data("autoplay"),this.autoInit=this.autoplay||!this.$preview.length||this.$preview.hasClass("no-image"),this.type){case"custom":e=Vt;break;case"youtube":e=zt;break;case"vimeo":e=Lt;break;case"kinescope":e=Mt;break;case"rutube":e=qt;break;default:e=dt}this.provider=new e({target:this.type==="custom"?this.$video[0]:this.$iframe[0],onPlay:this.onPlay.bind(this),onPause:this.onPause.bind(this),onError:this.onError.bind(this),onLoadData:this.onLoadData.bind(this)}),this.$preview.removeAttr("hidden"),this.$preview.on("click",async()=>{await w(this,K)[K](),await this.play(!0)}),this.$component.off("sliderActivate").on("sliderActivate",async()=>{this.preventAutoplay=!1,this.inScreen&&this.autoInit&&(await w(this,K)[K](),this.autoplay&&await this.play())}),this.$component.off("sliderDeactivate").on("sliderDeactivate",async()=>{this.preventAutoplay=!0,await this.pause()})}onDestroy(){this.provider.destroy()}async onScreen({state:t}){t?(this.autoInit&&await w(this,K)[K](),this.autoplay&&!this.preventAutoplay&&await this.play()):await this.pause()}async play(t=!1){this.isAutoplaying=!t,this.isPaused=!1,this.$preview.off("click").addClass("preloading");try{await this.provider.play(),this.$preview.fadeOut(150,()=>{this.$preview.remove(),this.$component.removeClass("overlayed")})}catch(e){console.warn(e)}}async pause(){this.isAutoplaying=!1,this.isPaused=!0;try{await this.provider.pause()}catch{}}onPlay(){this.isPaused=!1,this.preventAutoplay=!1,this.autoplay||flexbe_cli.is_admin||flexbe_cli.resize.responsiveMode!=="mobile"||!this.component.closest('[data-hidden="desktop"]')||(this.viewportLocked=!0,flexbe_cli.resize.lockMode(!0)),this.autoplay&&this.isAutoplaying||(this.sliderAutoplayPrevented=!0,this.$component.trigger("reduceSliderControls",{state:!0}))}onPause(t=this.inScreen){this.isPaused=!0,t&&(this.preventAutoplay=!0),this.viewportLocked&&(this.viewportLocked=!1,flexbe_cli.resize.lockMode(!1)),this.sliderAutoplayPrevented&&(this.sliderAutoplayPrevented=!1,this.$component.trigger("reduceSliderControls",{state:!1}))}onError(t){console.error(t)}onLoadData(t){this.$component.addClass("started")}};async function be(){this.provider.inited||(this.$component.addClass("loading"),await this.provider.init(),this.$component.removeClass("loading"),this.$component.addClass("loaded"))}X.is="video";flexbe_cli.entity.setClientJs("element","zone_gallery",{components:[G,R,X],onUpdate(r={}){setTimeout(()=>{var t;let e=(t=flexbe_cli.components.getInstances(this.area).filter(s=>s.is==="cards"))==null?void 0:t[0],i=e&&e.swiper;if(i){if(r&&r.reason==="items_add"){let s=i.realIndex,a=r.reasonData.to,n=s;s+i.params.slidesPerView<=a&&(n=a-i.params.slidesPerView+1),n!==s&&i.slideTo(n)}r.styleRendered&&requestAnimationFrame(()=>i.update(!1))}},100)}});flexbe_cli.entity.setClientJs("element","zone_grid",{isPure:!0});flexbe_cli.entity.setClientJs("element","zone_header",{isPure:!0});var ye=new Array(70).fill(1).map((r,t)=>50+50*t),D=class extends _{constructor(...t){super(...t),this.isCreated=void 0,this.isImgLoaded=void 0,this.isLazyLoading=void 0,this.image=void 0,this.imageLoadingOptions=void 0}async onInit(){this.$component.on("setImage",async()=>{this.isVisible&&!this.isImgLoaded&&(this.isCreated||this.create(),await this.loadImage())})}async onBeside({state:t}){t&&(this.isCreated||this.create(),this.isLazyLoading&&!this.isImgLoaded&&await this.loadImage())}async onResize(){this.isCreated&&await this.loadImage()}create(){let t=this.$component.data();this.imageLoadingOptions=flexbe_cli.vars.site.images,this.isLazyLoading=!!t.imgLazy,this.image={url:t.imgUrl||null,id:t.imgId,ext:t.imgExt,proportion:t.imgProportion,width:t.imgWidth,animated:t.imgAnimated,transparent:t.imgTransparent,scale:t.imgScale,type:"background"},this.isCreated=!0}async loadImage(){let t=this.$component.find(".vector-icon use"),e=this.$component.find(".custom-icon");if(t.length&&t.attr("href",this.image.url),e.length){let i=this.image.url;if(this.image.id){let s={width:this.componentWidth,height:this.componentHeight},{width:a}=await q(this.image,s,{...this.imageLoadingOptions,sizes:ye});i=B(this.image,a,this.imageLoadingOptions)}i&&e.css("background-image",`url(${i})`)}this.isImgLoaded=!0}};D.is="icon";function de(r,t,e=1){return 1-r>e&&(r=e),(1-Math.cos(Math.PI*r*t))/2}var we=[0,"parallax","parallax-fade","zoom","zoom-return"],Ot=class{constructor(t,e,i="parallax",s=null){this.imgParams={w:0,h:0,r:1,x:.5,y:.5},this.canvasSize={w:0,h:0,y:0},this.winSize={w:0,h:0},this.overlayOpacity=1,this.id=t,this.shouldRender=!1,this.mode=typeof i=="number"?we[i]:i,this.fadeAnimation=this.mode.includes("fade"),this.parallaxFactor=this.mode.includes("fixed")?1:this.mode.includes("parallax")?.4:0,this.zoomFactor=this.mode.includes("zoom")?.2:0,this.zoomLimit=this.mode==="zoom"?.5:this.mode==="zoom-return"?1:0,this.offCanvas=document.createElement("canvas"),this.offCtx=this.offCanvas.getContext("2d",{alpha:!1}),this.component=e[0],this.canvas=this.component.querySelector("canvas"),this.overlay=this.component.querySelector(".overlay"),this.ctx=this.canvas.getContext("2d",{alpha:!1}),this.init(s),this.reflow()}init(t){t&&t.url&&(this.img=document.createElement("img"),this.img.onload=()=>{this.ready=!0,this.imgParams={w:this.img.width,h:this.img.height,r:this.img.height/this.img.width,x:+t.x.replace("%","")/100,y:+t.y.replace("%","")/100},this.dispatchEvents(),this.draw(),requestAnimationFrame(()=>{$(this.canvas).addClass("ready")})},this.img.src=t.url)}dispatchEvents(){flexbe_cli.events.off(`.bg_${this.id}`),$(window).off(`.bg_${this.id}`),$(window).on(`scroll.bg_${this.id}`,()=>{this.draw()}),$(window).on(`resize.bg_${this.id}`,()=>{this.reflow()}),flexbe_cli.is_admin&&(flexbe_cli.events.on(`entity_render:style.bg_${this.id}`,t=>{t.id===this.id&&this.reflow()}),flexbe_cli.events.on(`layout_change.bg_${this.id}`,()=>{this.reflow()}))}toggleRendering(t){this.shouldRender=t}getZoomCoords(t){let e=1;if(this.zoomFactor){let s=100-100*de(.01*t,2,this.zoomLimit);e=1+this.zoomFactor/100*s}let i={w:0,h:0,x:0,y:0};return i.w=this.canvasSize.w*e,i.h=this.canvasSize.h*e,i.x=(i.w-this.canvas.width)/2,i.y=(i.h-this.canvasSize.h)/2,i}reflow(){let t=this.canvas.getBoundingClientRect();this.canvasSize={w:t.width,h:t.height,y:t.top+window.pageYOffset};let{viewportWidth:e,viewportHeight:i}=flexbe_cli.resize;this.winSize.h=flexbe_cli.run.is_mobile?Math.max(this.winSize.h,i):i,this.winSize.w=e,this.fadeAnimation&&(this.overlayOpacity=parseFloat(getComputedStyle(this.component).getPropertyValue("--componentBgOpacity")||1)),this.draw()}draw(){if(!this.shouldRender||!this.ready||this.pending)return;this.pending=!0;let t=flexbe_cli.scroll.latest+this.winSize.h-this.canvasSize.y,e=100-t/(this.canvasSize.h+this.winSize.h)*100;this.drawOffscreen(),this.drawCanvas(t,e),this.drawOverlay(e),this.pending=!1}drawOffscreen(){let{canvasSize:t,zoomFactor:e,winSize:i,parallaxFactor:s,imgParams:a,offCanvas:n,offCtx:o,img:l}=this,d=e?t.h:t.h+(i.h-t.h)*s,h=t.w,u=h,f=h*a.r,g=0,c=(f-d)*a.y*-1;d/h>a.r&&(u=d/a.r,f=d,g=(u-h)*a.x*-1,c=0),n.width!==h&&(n.width=h),n.height!==d&&(n.height=d),o.drawImage(l,g,c,u,f)}drawCanvas(t,e){if(this.canvas.width!==this.canvasSize.w&&(this.canvas.width=this.canvasSize.w),this.canvas.height!==this.canvasSize.h&&(this.canvas.height=this.canvasSize.h),this.zoomFactor){let i=this.getZoomCoords(e);try{this.ctx.drawImage(this.offCanvas,Math.ceil(-1*i.x),Math.ceil(t*this.parallaxFactor-this.winSize.h*this.parallaxFactor-i.y),i.w,i.h)}catch{}}else try{this.ctx.drawImage(this.offCanvas,0,Math.ceil((t-this.winSize.h)*this.parallaxFactor))}catch{}}drawOverlay(t){if(this.fadeAnimation&&this.overlay){let e=1-(1-this.overlayOpacity)*de(.01*t,2,1);this.overlay.style.setProperty("--componentBgOpacity",e)}}destroy(){var t,e;this.destroyed=!0,cancelAnimationFrame(this._raf),flexbe_cli.events.off(`.bg_${this.id}`),$(window).off(`.bg_${this.id}`),$(this.canvas).removeClass("ready"),(t=this.offCanvas)==null||t.remove(),(e=this.img)==null||e.remove()}},Wt=class{constructor(t,e,i){this.destroyed=!1,this.background=t,this.core=t.core,this.$component=t.$component,this.video=e,typeof i=="function"&&(this.onInited=i),this.initVideo()}initVideo(){this.$container=$('<div class="layer video-holder"></div>'),this.insertVideo(),this.video.type==="custom"?this.initMP4():this.video.type==="vimeo"?this.initVimeo():this.video.type==="youtube"?this.initYoutube():this.video.type==="kinescope"?this.initKinescope():this.initEmbed(),$(document).on(`visibilitychange.bg_effect_${this.core.id}`,()=>{this.background.onscreen&&!document.hidden&&setTimeout(()=>{this.play()},50)})}initVimeo(){let t=0,e=()=>{let i=this.vPlayer;return Promise.all([i.getVideoWidth(),i.getVideoHeight()]).then(s=>{let[a,n]=s;return a/n<2.5&&a/n>.4||t===3?{width:a,height:n}:(t+=1,e())})};flexbe_cli.require(["https://player.vimeo.com/api/player.js"],()=>{this.destroyed||(this.vPlayer=new window.Vimeo.Player(this.$videoElement[0]),e().then(i=>(this.video.width=i.width,this.video.height=i.height,this.fitToSize(),this.play(),null)).catch(()=>{}))})}initYoutube(){let t=()=>{this.yPlayer=new window.YT.Player(this.$videoElement[0],{events:{onReady:()=>{this.fitToSize(),this.play()}}})};window.YT||window.onYouTubeIframeAPIReady?window.onYouTubeIframeAPIReady?window.youtubeBGQueue.push(t):t():(window.onYouTubeIframeAPIReady=()=>{window.youtubeBGQueue.forEach(e=>e()),window.youtubeBGQueue=null,window.onYouTubeIframeAPIReady=null},window.youtubeBGQueue=[],window.youtubeBGQueue.push(t),flexbe_cli.require(["https://www.youtube.com/iframe_api"]))}initKinescope(){this.fitToSize(),this.ready(),flexbe_cli.require(["https://player.kinescope.io/latest/iframe.player.js"],async()=>{this.destroyed||(this.kPlayer=await window.Kinescope.IframePlayer.create(this.$videoElement.attr("id"),{url:this.video.link,behavior:{background:!0,preload:"auto",loop:!0,muted:!0,autoPlay:"viewable",autoPause:!1}}),this.play())})}initEmbed(){this.fitToSize(),this.play()}initMP4(){this.$videoElement[0].oncanplay=()=>{this.play()},this.$videoElement[0].onloadeddata=()=>{this.video.width=this.$videoElement[0].videoWidth,this.video.height=this.$videoElement[0].videoHeight,this.fitToSize(),this.ready()}}insertVideo(){this.video.type==="custom"?(this.$videoElement=$(`<video src="${this.video.link}"
                       controlslist="nodownload"
                       loop="true"
                       muted="true"
                       autoplay="true"
                       playsinline="true"
                       disablePictureInPicture
                       disableRemotePlayback
                       pip="false"
                ></video>`),this.$videoElement[0].disablePictureInPicture=!0,this.$videoElement[0].disableRemotePlayback=!0):this.$videoElement=$(`<iframe 
                id="${crypto.randomUUID()}"
                src="${this.video.link}"
                width="${this.video.width}" 
                height="${this.video.height}" 
                allow="autoplay; encrypted-media; fullscreen; screen-wake-lock; accelerometer; clipboard-write;"
            ></iframe>`),this.$container.append(this.$videoElement),this.$component.prepend(this.$container),this.onInited&&this.onInited(this.$container)}fitToSize(){if(this.video){let t=this.$container.width(),e=this.$container.height(),i=this.video.width/this.video.height;i>t/e?this.$videoElement.css({width:e*i+"px",height:"100%"}):this.$videoElement.css({width:"100%",height:t/i+"px"})}this.videoIsResized=!0}ready(){W(()=>this.videoIsResized,()=>{this.$component.addClass("video-loaded")},5e3)}play(){this.$videoElement&&this.$videoElement[0]&&this.$videoElement[0].play?(this.$videoElement[0].play(),$(document).one("touchstart.video-bg",()=>{this.$videoElement[0].play()}),this.ready()):this.video.type==="vimeo"?W(()=>this.vPlayer&&this.vPlayer.play,()=>{setTimeout(()=>{this.vPlayer.play(),this.ready()},50)},5e3):this.video.type==="youtube"?W(()=>this.yPlayer&&this.yPlayer.playVideo,()=>{this.yPlayer.playVideo(),this.ready()},5e3):this.video.type==="kinescope"?W(()=>this.kPlayer&&this.kPlayer.play,()=>{this.kPlayer.play(),this.ready()},5e3):this.ready()}pause(){var t;this.video.type==="vimeo"&&this.vPlayer?this.vPlayer.pause():this.video.type==="youtube"&&this.yPlayer&&this.yPlayer.pauseVideo?this.yPlayer.pauseVideo():this.video.type==="kinescope"&&(t=this.kPlayer)!=null&&t.pause?this.kPlayer.pause():this.$videoElement&&this.$videoElement[0]&&this.$videoElement[0].pause&&this.$videoElement[0].pause()}destroy(){this.destroyed=!0,this.pause(),this.kPlayer&&this.kPlayer.destroy(),$(document).off(`.bg_effect_${this.core.id}`)}},xe=[800,1366,1920,2160],k=class extends _{constructor(...t){var e,i;super(...t);let{$component:s}=this,a=s.data();this.data={type:a.type||"color",hasImagePlaceholder:!!a.hasPlaceholder,imageLoadingOptions:flexbe_cli.vars.site.images,isLazyLoading:!!a.lazy,isImgLoaded:!!a.loaded,effect:a.effect,effectMobile:(e=a.effectMobile)!=null?e:a.effect,videoId:a.videoId||null,videoType:a.videoType||null,videoLink:a.videoLink||null,videoWidth:a.videoWidth||640,videoHeight:a.videoHeight||360,videoPreview:a.videoPreview||"color",infinityVideo:(i=a.infinityVideo)!=null&&i,mobileVideoEnabled:a.mobileVideoEnabled||!1,videoParallaxFactor:.4},this.image={url:null,id:a.imgId,ext:a.imgExt,x:a.imgX,y:a.imgY,proportion:a.imgProportion,width:a.imgWidth,animated:a.imgAnimated,transparent:a.imgTransparent,scale:"cover",type:"background",original:!!a.imgOriginal}}async onInit(){this.data.isLazyLoading||await this.loadImage(),this.$component.on("setImage",async()=>{!this.isVisible||this.isImgLoading||this.data.isImgLoaded||await this.loadImage()})}onScreen({state:t}){this.videoInstance&&(this.data.infinityVideo||(t?this.videoInstance.play():this.videoInstance.pause())),this.onscreen=t,t&&!this.played&&this.playVideo()}async onBeside({state:t,first:e}){t&&e&&(await this.loadImage(),this.imageEffectInit(),this.videoEffectInit()),this.played||this.playVideo(),this.bgEffect&&(this.bgEffect.toggleRendering(t),this.bgEffect.draw())}onResize(){this.bgEffect&&requestAnimationFrame(()=>{this.bgEffect.reflow()}),this.data.type==="video"&&(this.videoInstance?(this.videoInstance.fitToSize(),this.data.effect&&this.fixHolder&&this.setParallax&&setTimeout(()=>{this.fixHolder(),this.setParallax()},100),setTimeout(()=>{this.videoInstance.fitToSize()},150)):this.fixHolder&&this.fixHolder())}async loadImage(){if(!(this.image.id&&(this.data.type==="image"||this.data.type==="video"&&this.data.videoPreview==="image")))return;this.isImgLoading=!0;let t={width:this.componentWidth||this.component.offsetWidth,height:this.componentHeight||this.component.offsetHeight},{width:e}=this.image.original?{width:0}:await q(this.image,t,{...this.data.imageLoadingOptions,sizes:xe});if(this.image.url=B(this.image,e,this.data.imageLoadingOptions),!this.data.isImgLoaded){if(this.data.hasImagePlaceholder)try{await U(this.image.url)}catch(i){return void console.error("Background preload error",i)}this.setImage(this.image.url)}this.isImgLoading=!1}setImage(t){this.$component.find(".image-holder").css("background-image",`url(${t})`),this.$component.addClass("image-loaded"),this.isImgLoading=!1,this.data.isImgLoaded=!0}imageEffectInit(){var t;if(this.data.type!=="image"||!this.data.effect||flexbe_cli.vars.globals.isScreenshot)return;let{owner:e,$component:i,data:s,image:a}=this,n=((t=e._core)==null?void 0:t.id)||e.getAttribute("data-id");typeof e._bgEffects=="object"&&e._bgEffects.destroy();let o=s.effect!=="fixed";o&&s.effectMobile==="off"&&flexbe_cli.run.is_screen_mobile&&(o=!1),o&&(this.bgEffect=new Ot(n,i,s.effect,a),e._bgEffects=this.bgEffect)}videoEffectInit(){if(this.data.type!=="video"||this.data.effect!=="parallax"||flexbe_cli.vars.globals.isScreenshot)return;let t=this.$component.find(".video-holder, .image-holder"),e=this.owner._core,i=this.data,s=()=>{t.css("height",`${e.tween.height+(flexbe_cli.resize.viewportHeight-e.tween.height)*i.videoParallaxFactor}px`)},a=()=>{if(this.data.effectMobile==="off"&&flexbe_cli.run.is_screen_mobile)return void t.css("top","");let n=1-this.data.videoParallaxFactor,o=Math.floor((flexbe_cli.scroll.latest-e.tween.start)*-n)||0;t.css("top",`${o}px`)};s(),a(),e.$area.off(`fixHeaderHeight.component-bg-${e.id}`).on(`fixHeaderHeight.component-bg-${e.id}`,()=>{a()}),$(window).off(`scroll.component-bg-${e.id}`).on(`scroll.component-bg-${e.id}`,()=>{this.onscreen&&a()}),this.fixHolder=s,this.setParallax=a}playVideo(){if(flexbe_cli.run.is_screen_mobile&&!this.data.mobileVideoEnabled||flexbe_cli.vars.globals.isCriticalCss||flexbe_cli.vars.globals.isScreenshot||flexbe_cli.vars.globals.isBot)return!1;let t=this.data,e={id:t.videoId,type:t.videoType,link:t.videoLink,width:t.videoWidth,height:t.videoHeight};return!(this.data.type!=="video"||!e.id&&!e.link)&&(this.played=!0,this.videoInstance||(this.videoInstance=new Wt(this,e,()=>{this.videoEffectInit()})),!0)}onDestroy(){this.core.$area.off(`fixHeaderHeight.component-bg-${this.core.id}`),$(window).off(`scroll.component-bg-${this.core.id}`),this.bgEffect&&this.bgEffect.destroy(),this.videoInstance&&this.videoInstance.destroy()}};k.is="background";flexbe_cli.entity.setClientJs("modal","BASIC",{components:[k,D],onOpen(){this.$scroll=this.$area.find(".scroller"),this.$content=this.$area.find(".modal-content"),this.$close=this.$scroll.find("> .close--outside"),this.dispatchClasses(),this.$scroll.on("scroll.close-check",$.throttle(()=>{this.dispatchClasses()},60))},onClose(){this.$scroll.off("scroll.close-check")},dispatchClasses(){if(flexbe_cli.resize.responsiveMode!=="mobile"||!this.$close.length)return;let r=this.$scroll[0].scrollTop,t=this.$content[0].offsetTop,e=this.$close[0].offsetHeight;this.$close.toggleClass("stuck",t-r<e)}});var at=class{constructor(t){this.$legend=t.find(".range-legend"),this.$component=t.find(".range-outer"),this.$input=t.find("input"),this.startEdge=this.$component.data("start"),this.isDouble=!!this.$component.data("double"),this.endEdge=this.$component.data("end"),this.range=this.endEdge-this.startEdge,this.barWidth=this.$component.width(),this.step=this.$component.data("step")||1,this.steps=Math.round(this.range/this.step),this.legendType=this.$legend.data("type"),this.legendText=+this.$legend.data("text")==1,this.animated=!0,this.duration=this.steps<10&&1/this.steps*300,this.fractExponent=Math.max(this.getFract(this.startEdge),this.getFract(this.endEdge),this.getFract(this.step)),this.fractDevider=10**this.fractExponent,this.$value=$(".range-value",this.$component),this.$endRunner=$(".range-runner-right",this.$component),this.$endRunnerTip=$(".runner-tip",this.$endRunner),this.$endRunnerValue=$(".value",this.$endRunner),this.$startRunner=$(".range-runner-left",this.$component),this.$startRunnerValue=$(".value",this.$startRunner),this.$startRunnerTip=$(".runner-tip",this.$startRunner),this.startRunnerWidth=this.$startRunner.width(),this.maxAllowedLeft=20,this.maxAllowedRight=flexbe_cli.resize.viewportWidth-20,this.defaultShift=this.$endRunner.width()/2,this.activeRunner=!1,this.startValue=+this.startEdge;let e=String(this.$input.attr("value")).replace(/[^\d-]/g,"");if(this.isDouble){let i=e.split("-");this.startValue=i[1]?Number(i[0]):+this.startEdge,this.endValue=i[1]?Number(i[1]):+this.endEdge}else this.endValue=e?Number(e):+this.startEdge,this.startValue=+this.startEdge;this.$input.attr("value",`${this.startValue} \u2014 ${this.endValue}`),this.endParams={},this.drawLegend(),this.updateTooltip(this.$startRunnerTip),this.updateTooltip(this.$endRunnerTip),this.setEvents(),this.setRunnersValue()}formatN(t){return`${t<0?"-":""}${flexbe_cli.locale.formatNumber(t,this.fractExponent)}`}getFract(t){let e=`${t}`.split(".");return e[1]&&e[1].length||0}drawLegend(){if(this.legendText)return!1;let t=this.$legend.find(".from"),e=this.$legend.find(".to");if(t.text(this.formatN(this.startEdge)),e.text(this.formatN(this.endEdge)),this.legendType!=="complex")return!1;this.$legend.find(".legend-point:not(.from, .to)").off("click").remove(),this.$legend.removeClass("complex").addClass("limits");let i=[`${this.formatN(this.startEdge)}`.length,`${this.formatN(this.endEdge)}`.length,`${this.formatN(this.step)}`.length],s=(i[0]+i[1]+i[2])/3,a=Math.max(this.startEdge,this.endEdge),n=[5*this.step*this.fractDevider/this.fractDevider];for(let c=1;c<=12;c++){let p=10**c*this.step;p<a&&g(n,p,this.fractDevider)}let o,l=Math.ceil(this.$legend.find(i[0]>i[1]?".from":".to").width()/Math.max(i[1],i[0])),d=Math.round(.83*this.barWidth/(l*s)),h=this.range>0?1:-1;for(let c=Math.min(d,10);c>=3;c--){let p=f(this.step,Math.abs(this.steps),c,n);if(p&&Number.isInteger(p/this.step)&&Number.isInteger(this.range/p)){o=p;break}}if(!o||!Number.isInteger(this.range/(o*h))||this.range/(o*h)<3)for(let c=Math.min(Math.round(Math.abs(this.range)/this.step),d,10);c>=2;c-=1){let p=this.roundFraction(Math.abs(this.range)/c);if(p%this.step===0){o=p;break}}let u=this.roundFraction(Math.abs(this.range)/o);if(o&&Number.isInteger(u)){let c=[];for(let m=1;m<u;m+=1){let v=Math.round((this.startEdge+o*m*h)*this.fractDevider)/this.fractDevider;c.push(`<div class="legend-point" data-value="${v}">${this.formatN(v)}</div>`)}u>2&&(this.$legend.attr("data-count",u),this.$legend.removeClass("limits").addClass("complex"));let p=$(c.join(""));this.$legend.find(".from").after(p)}else this.$legend.removeClass("complex").addClass("limits");function f(c,p,m,v){return v.includes(p/m*c)?p/m*c:v.includes((p+1)/m*c)?(p+1)/m*c:v.includes((p+2)/m*c)?(p+2)/m*c:v.includes((p+3)/m*c)?(p+3)/m*c:v.includes((p+4)/m*c)?(p+4)/m*c:v.includes((p+5)/m*c)?(p+5)/m*c:v.includes((p+6)/m*c)?(p+6)/m*c:v.includes((p+7)/m*c)?(p+7)/m*c:v.includes((p+8)/m*c)?(p+8)/m*c:!!v.includes((p+9)/m*c)&&(p+9)/m*c}function g(c,p,m){for(let v=1;v<10;v+=1)c.push(Math.round(p*v*m)/m),c.push(Math.round(p*v*m+p/2)/m)}this.$legend.find(".legend-point:not(.to), .legend-point:not(.from)").each((c,p)=>{$(p).on("click",()=>{if(this.updateBarWidth(),this.isDouble){let m=(this.startValue+this.endValue)/2,v=+$(p).data("value"),C=this.startEdge<this.endEdge?1:-1;v*C>=m*C?this.endValue=v:this.startValue=v}else this.endValue=$(p).data("value");this.setRunnersValue()})})}roundFraction(t){return Math.round(1e10*t)/1e10}setRunnersValue(t=!1){if(!Number.isFinite(this.endValue)||!Number.isFinite(this.range)||this.isDouble&&!Number.isFinite(this.startValue))return!1;let e=this.startEdge<this.endEdge?1:-1;this.activeRunner==="start"?this.startValue*e<=this.startEdge*e?this.startValue=this.startEdge:this.startValue*e>=this.endValue*e&&(this.startValue=this.endValue):this.endValue*e>=this.endEdge*e?this.endValue=this.endEdge:this.endValue*e<=this.startValue*e&&(this.endValue=this.startValue);let i=this.isDouble?this.startValue:this.startEdge,s=this.isDouble?(this.startValue-this.startEdge)/(this.range/100):0,a=(this.endValue-i)/(this.range/100);this.endValue=Math.round(this.endValue*this.fractDevider)/this.fractDevider,this.startValue=Math.round(this.startValue*this.fractDevider)/this.fractDevider,requestAnimationFrame(()=>{this.$endRunnerValue.text(this.formatN(this.endValue)),this.$startRunnerValue.text(this.formatN(this.startValue))}),this.activeRunner==="end"?this.updateTooltip(this.$endRunnerTip):this.updateTooltip(this.$startRunnerTip),this.$value.css({width:`${a}%`,marginLeft:`${s}%`}),t||(this.isDouble?this.$input.val(`${this.startValue} \u2014 ${this.endValue}`):this.$input.val(this.endValue))}updateTooltip(t){let e=t.closest(".range-runner");if(e&&e.length){let i=t.innerWidth(),s=t.closest(".range-runner")[0].getBoundingClientRect().left+this.startRunnerWidth/2,a;a=i/2>s+this.maxAllowedLeft?i/2-(s-this.maxAllowedLeft):i/2+s>this.maxAllowedRight?this.maxAllowedRight-s-i/2:0,t.css({transform:`translateX(${a}px)`})}}getValueFromLength(t){let e=this.range/(this.barWidth/t);return(Math.round(e/this.step)+this.startEdge/this.step)*this.step}applyEndPosition(t){return this[this.activeRunner==="start"?"startValue":"endValue"]=this.getValueFromLength(t),this.setRunnersValue(),!0}touchHendler(t){if(!this.endParams.active||t.touches.length!==1)return $("body")[0].removeEventListener("touchmove",this.touchHendler),!1;this.toggleAnimation(!1),t.preventDefault(),t.stopPropagation();let e=t.touches[0].pageX-this.endParams.left-this.endParams.shift;this.applyEndPosition(e)}startWatchingEvents(t=this.defaultShift){this.endParams={active:!0,left:this.$component.offset().left,shift:t},clearTimeout(this.calmRunnersTimeout),this.activeRunner==="end"?this.$endRunner.addClass("active"):this.$startRunner.addClass("active")}toggleAnimation(t){t?Math.abs(this.barWidth/this.steps)<15?this.$component.addClass("animated"):(this.$component.removeClass("active-animation"),this.duration&&this.$component.removeClass("animation-speed-"+(12-Math.abs(Math.round(this.steps))))):Math.abs(this.barWidth/this.steps)<15?this.$component.removeClass("animated"):(this.$component.addClass("active-animation"),this.duration&&this.$component.addClass("animation-speed-"+(12-Math.abs(Math.round(this.steps)))))}afterRunnerReleased(){this.endParams.active&&(this.activeRunner==="start"?this.$startRunner.focus():this.$endRunner.focus()),this.endParams.active=!1,this.debounceActive(),this.barWidth/this.steps<15?this.$component.addClass("animated"):this.$component.removeClass("active-animation"),this.toggleAnimation(!0)}updateBarWidth(){let t=this.$component.width();t!==this.barWidth&&(this.barWidth=t,this.legendType==="complex"&&this.drawLegend())}setEvents(){let t=$(window),e=this;function i(s){if(!e.endParams.active)return t.off("mousemove.dragRange"),!1;e.toggleAnimation(!1);let a=s.pageX-e.endParams.left-e.endParams.shift;return e.applyEndPosition(a),!0}this.$component.on("resize",()=>{this.updateBarWidth()}),this.$component.on("touchstart",s=>{if(s.touches.length!==1)return!1;if(this.isDouble){let n=(this.$endRunner.offset().left+this.$startRunner.offset().left)/2;this.activeRunner=s.touches[0].pageX>=n?"end":"start",this.activeRunner==="start"?(this.$startRunner.addClass("upper-runner"),this.$endRunner.removeClass("upper-runner")):(this.$endRunner.addClass("upper-runner"),this.$startRunner.removeClass("upper-runner"))}else this.activeRunner="end";s.stopPropagation(),this.updateBarWidth();let a=s.touches[0].pageX-this.$value.offset().left;this.startWatchingEvents(),this.applyEndPosition(a-this.defaultShift),t[0].addEventListener("touchmove",this.touchHendler.bind(this),{passive:!1}),t.on("touchend.range",()=>{this.afterRunnerReleased(),t[0].removeEventListener("touchmove",this.touchHendler),t.off("touchend.range")})}),this.$component.on("mousedown",s=>{let a=s.pageX-this.$component.offset().left;if(this.isDouble){let n=(this.$endRunner.offset().left+this.$startRunner.offset().left)/2;this.activeRunner=s.pageX>=n?"end":"start",this.activeRunner==="start"?(this.$startRunner.addClass("upper-runner"),this.$endRunner.removeClass("upper-runner")):(this.$endRunner.addClass("upper-runner"),this.$startRunner.removeClass("upper-runner"))}this.updateBarWidth(),this.startWatchingEvents(),this.applyEndPosition(a-this.defaultShift),this.activeRunner==="start"?this.$startRunner.focus():this.$endRunner.focus(),t.on("mousemove.dragRange",i),t.on("mouseup.range",()=>{this.afterRunnerReleased(),t.off("mousemove.dragRange"),t.off("mouseup.range")})}),this.$endRunner.on("touchstart",s=>{if(s.touches.length!==1)return!1;s.stopPropagation(),this.updateBarWidth(),this.activeRunner="end",this.$startRunner.removeClass("upper-runner"),this.$endRunner.addClass("upper-runner"),s.stopPropagation(),this.startWatchingEvents(s.touches[0].pageX-this.$endRunner.offset().left),this.toggleAnimation(!1),t[0].addEventListener("touchmove",this.touchHendler.bind(this),{passive:!1}),t.on("touchend.range",()=>{this.afterRunnerReleased(),t[0].removeEventListener("touchmove",this.touchHendler),t.off("touchend.range")})}),this.$startRunner.on("touchstart",s=>{if(s.touches.length!==1)return!1;s.stopPropagation(),this.updateBarWidth(),this.activeRunner="start",this.$startRunner.addClass("upper-runner"),this.$endRunner.removeClass("upper-runner"),s.stopPropagation(),this.startWatchingEvents(s.touches[0].pageX-this.$startRunner.offset().left),this.toggleAnimation(!1),t[0].addEventListener("touchmove",this.touchHendler.bind(this),{passive:!1}),t.on("touchend.range",()=>{this.afterRunnerReleased(),t[0].removeEventListener("touchmove",this.touchHendler),t.off("touchend.range")})}),this.$endRunner.on("mousedown",s=>{s.stopPropagation(),this.activeRunner="end",this.$startRunner.removeClass("upper-runner"),this.$endRunner.addClass("upper-runner"),this.updateBarWidth(),this.$endRunner.focus(),this.startWatchingEvents(s.pageX-this.$endRunner.offset().left),this.toggleAnimation(!1),t.on("mousemove.dragRange",i),t.on("mouseup.range",()=>{this.afterRunnerReleased(),t.off("mousemove.dragRange"),t.off("mouseup.range")})}),this.$startRunner.on("mousedown",s=>{s.stopPropagation(),this.activeRunner="start",this.$startRunner.addClass("upper-runner"),this.$endRunner.removeClass("upper-runner"),this.updateBarWidth(),this.$startRunner.focus(),this.startWatchingEvents(s.pageX-this.$startRunner.offset().left),this.toggleAnimation(!1),t.on("mousemove.dragRange",i),t.on("mouseup.range",()=>{this.afterRunnerReleased(),t.off("mousemove.dragRange"),t.off("mouseup.range")})}),this.$legend.find(".legend-point.to, .legend-point.from").each((s,a)=>{$(a).on("click",()=>{if(this.updateBarWidth(),this.isDouble){let n=this.startEdge<this.endEdge?1:-1,o=(this.startValue+this.endValue)/2,l=+$(a).data("value");l*n>=o*n?this.endValue=l:this.startValue=l}else this.endValue=$(a).data("value");this.setRunnersValue()})}),this.$input.on("change",()=>{if(this.isDouble){let s=this.$input.val().split(" \u2014 ");this.startValue=+s[0],this.endValue=+s[1]}else this.endValue=+this.$input.val();this.setRunnersValue(!0)}),this.$startRunner.on("keyup",s=>{s.preventDefault(),this.activeRunner="start",this.handleKeydown(s,this.$startRunner)}),this.$endRunner.on("keyup",s=>{s.preventDefault(),this.activeRunner="end",this.handleKeydown(s,this.$endRunner)}),this.$startRunner.on("keydown",s=>{this.activeRunner="start",this.handleKeyup(s,this.$startRunner)}),this.$endRunner.on("keydown",s=>{this.activeRunner="end",this.handleKeyup(s,this.$endRunner)}),this.$startRunner.on("blur",()=>{this.handleBlur()})}handleBlur(){this.movingInterval&&(clearInterval(this.movingInterval),this.movingInterval=!1),this.movingDebounceTimeout&&(clearTimeout(this.movingDebounceTimeout),this.movingDebounceTimeout=!1)}handleKeydown(t,e){if(this.movingInterval&&(clearInterval(this.movingInterval),this.movingInterval=!1),this.movingDebounceTimeout&&(clearTimeout(this.movingDebounceTimeout),this.movingDebounceTimeout=!1),[37,38,39,40].includes(t.keyCode)){let i=t.shiftKey?10:1,s=this.activeRunner==="start"?"startValue":"endValue";t.keyCode===38||t.keyCode===39?this[s]=(this[s]/this.step+i)*this.step:t.keyCode!==37&&t.keyCode!==40||(this[s]=(this[s]/this.step-i)*this.step),e.addClass("active"),this.debounceActive(),this.setRunnersValue()}}handleKeyup(t,e){t.keyCode!==9&&[37,38,39,40].includes(t.keyCode)&&(t.preventDefault(),e.addClass("active"),this.debounceActive(),this.startDebouncedMove(t))}startDebouncedMove(t){this.movingDebounceTimeout&&(clearTimeout(this.movingDebounceTimeout),this.movingDebounceTimeout=!1),this.movingDebounceTimeout=setTimeout(()=>{this.movingInterval=setInterval(()=>{this.debounceActive();let e=t.shiftKey?10:1,i=this.activeRunner==="start"?"startValue":"endValue";t.keyCode===38||t.keyCode===39?this[i]=(Math.round(this[i]/this.step)+e)*this.step:t.keyCode!==37&&t.keyCode!==40||(this[i]=(Math.round(this[i]/this.step)-e)*this.step),this.setRunnersValue()},50)},300)}debounceActive(){this.calmRunnersTimeout&&clearTimeout(this.calmRunnersTimeout),this.calmRunnersTimeout=setTimeout(()=>{this.$endRunner.removeClass("active"),this.$startRunner.removeClass("active")},500)}};function $t(r,t){var e;let i=$(r),s=i.closest("[data-type]").attr("data-type"),a=i.attr("data-date-range")||"any",n=(e=i.attr("data-date-work-days"))!=null?e:"0,1,2,3,4,5,6",o=new Date().getFullYear()+3;s==="datetime"&&(o=new Date().getMonth()>=8?new Date().getFullYear()+1:new Date().getFullYear());let l=new Date(new Date().getFullYear()-100,0,1),d=new Date(o,11,31);s!=="datetime"&&a!=="future"||(l=new Date),s==="date"&&a==="past"&&(d=new Date);let h={type:s,lowerLimit:l,upperLimit:d,dateRange:a,locale:flexbe_cli.locale.translation.calendar,dateFormat:flexbe_cli.locale.dateFormat,showDateSelector:s==="date"&&a!=="future",insertTo:t,workDays:n.length?n.split(","):[],workTime:null};if(s==="datetime"){let u=i.attr("data-date-time-interval")||30,f=i.attr("data-date-time-start")||"00:00",g=i.attr("data-date-time-finish")||"00:00";h.workTime={interval:u,start:{hour:+f.substring(0,2),minute:+f.substring(3,5)},finish:{hour:+g.substring(0,2),minute:+g.substring(3,5)}}}i.calendar(h)}function _e(r,t={}){let e=Object.keys(t),i=Object.values(t);return new Function(...e,`return \`${r}\`;`)(...i)}var vt="default",A=j("listeners"),Q=j("context"),ht=j("addEventListeners"),Nt=class{constructor(t,e=!1){Object.defineProperty(this,ht,{value:Ce}),Object.defineProperty(this,A,{writable:!0,value:new Map}),Object.defineProperty(this,Q,{writable:!0,value:null}),this.strict=!1,w(this,Q)[Q]=t||this,this.strict=e}on(t,e){return w(this,ht)[ht](t,e,!1),this}one(t,e){return w(this,ht)[ht](t,e,!0),this}off(t,e){return(Array.isArray(t)?t:t.split(" ")).forEach(i=>{let[s,...a]=i.includes(".")?i.split("."):[i,vt],n=a.join(".")||vt;(s?[w(this,A)[A].get(s)]:[...w(this,A)[A].values()]).filter(Boolean).forEach(o=>{Array.from(o.entries()).forEach(([l,d])=>{e&&e!==l||d.namespace!==n||o.delete(l)}),o.size===0&&w(this,A)[A].delete(s)})}),this}clear(){return w(this,A)[A].clear(),this}async trigger(t,...e){let[i,...s]=t.split("."),a=s.join("."),n=w(this,A)[A].get(i),o=w(this,A)[A].get("*"),l=[];return n&&n.forEach((d,h)=>{a&&!d.namespace.startsWith(a)||(l.push(Promise.resolve(h.call(w(this,Q)[Q],...e))),d.once&&n.delete(h))}),o&&o.forEach((d,h)=>{l.push(Promise.resolve(h.call(w(this,Q)[Q],t,...e)))}),this.strict&&l.length===0&&console.warn(`No listeners for event: ${t}`),Promise.all(l)}async emit(t,...e){return this.trigger(t,...e)}};function Ce(r,t,e){(Array.isArray(r)?r:r.split(" ")).forEach(i=>{let[s,...a]=i.includes(".")?i.split("."):[i,vt],n=a.join(".")||vt;w(this,A)[A].has(s)||w(this,A)[A].set(s,new Map),w(this,A)[A].get(s).set(t,{once:e,namespace:n})})}var Se=0,he=1,Ae=2,Ee=3,ce=4,Ht=class r extends Nt{static async getFileHash(t){let e=t.name,i=await async function(s){return new Promise(a=>{let n=new FileReader;n.addEventListener("load",o=>{a(o.target.result)}),n.readAsBinaryString(s)})}(t);return flexbe_cli.helpers.hashCode(e+i.slice(0,4194304))}constructor(t){super(),this.request=void 0,this.id=void 0,this.file=void 0,this.status=Se,this.name=void 0,this.uri=void 0,this.progress=0,this.file=t,this.name=t.name}async init(){this.id=await r.getFileHash(this.file)}upload(){this.trigger("start");let t=flexbe_cli.helpers.upload(this.file,{onProgress:(e,i)=>{i.lengthComputable&&(this.progress=i.loaded/i.total),this.trigger("progress",{jqXhr:e,progress:this.progress})},onSuccess:(e,i)=>{this.uri=e.fileUri,this.status=Ae,this.trigger("success",{jqXHR:e,textStatus:i})},onError:(e,i)=>{this.progress=1,this.status=i==="abort"?ce:Ee,this.trigger("error",{jqXHR:e,textStatus:i})},onComplete:(e,i)=>{this.trigger("complete",{jqXHR:e,textStatus:i})}});return this.request=t,this.status=he,t}async abort(){this.request&&this.status===he&&(this.status=ce,this.request.abort())}},P={};function bt(r,t,e){let i=(s,a,n)=>{let o=s.find(".form-field-hidden"),l=Array.from(a).map(u=>u.uri).filter(u=>u),d=s.find('input[type="hidden"]'),h=new Set;d.each((u,f)=>{let g=$(f).attr("name");if(g!=null&&g.includes("[fields]")){let c=g.split("[fields]")[0];h.add(c)}}),h.size===0&&h.add(""),h.forEach(u=>{let f=u?`${u}[fields][${n}][value][]`:`fields[${n}][value][]`;s.find(`input[name$="${f}"]`).remove(),l.forEach(g=>{o.append($(`<input class="value" type="hidden" name="${f}" value="${g}">`))})})};r.on(`change${t}`,".file-input--original",async s=>{let a=Object.values(s.currentTarget.files),n=null,o=[];if(!a.length)return;let l=$(s.currentTarget),d=l.closest("[data-field-id]"),h=d.find(".file-list"),u=d.attr("data-field-id"),f=d.attr("data-size"),g=d.attr("data-accept")?d.attr("data-accept").split(", "):[];if(f){let p=parseFloat(f);n=f.replace(/[^a-zA-Z]/g,"").toLowerCase()==="kb"?1e3*p:1e3*p*1e3}a=a.filter(p=>{let m=`.${p.name.split(".").pop().toLowerCase()}`;return g.length&&!g.includes(m)?(o.push(flexbe_cli.locale.tr("form::error_file_accept",{name:p.name})),!1):!(n&&p.size>n)||(o.push(flexbe_cli.locale.tr("form::error_file_size",{name:p.name,size:f})),!1)}),P[u]||(P[u]=[]);let c=a.map(p=>new Ht(p));await Promise.all(c.map(async p=>p.init())),c=c.filter(p=>!P[u].find(m=>m.id===p.id)),c.forEach(p=>{let m=$((v=p.name,C=p.id,_e(e,{id:C,fileName:v})));var v,C;p.on("start",()=>{d.addClass("loading"),d.removeClass("is_error"),h.append(m)}),p.on("progress",({progress:S})=>{let F=124.853-124.853*S;m.find(".circle-loader__path").css({"stroke-dashoffset":`${F}`})}),p.on("success",()=>{i(d,P[u],u)}),p.on("error",S=>{S?.textStatus!=="abort"&&(m.addClass("is-error"),d.addClass("is_error"),d.find(".error-text").append(flexbe_cli.locale.tr("form::error_file")))}),p.on("complete",()=>{m.removeClass("loading"),P[u].every(S=>S.progress===1)&&d.removeClass("loading")}),p.upload()}),d.find(".error-text").html(""),o.length&&(d.addClass("is_error_info"),d.find(".error-text").html(o.join("<br>")).append("<br>"),o=[]),P[u].push(...c),l.val("")}),r.on(`click${t}`,".clear-files",s=>{let a=$(s.currentTarget).parents(".file-item"),n=$(s.currentTarget).closest("[data-field-id]"),o=n.attr("data-field-id"),l=a.attr("data-id"),d=P[o].find(h=>h.id===l);n.removeClass("is_error is_error_info"),n.find(".error-text").html(""),P[o]=P[o].filter(h=>h.id!==d.id),a.remove(),d.abort(),i(n,P[o],o)})}function yt(){P={}}var Ie={phone:{RU:["+7 (***) ***-**-**","8 (***) ***-**-**"],KZ:["+7 (***) ***-**-**","8 (***) ***-**-**"],UA:["+38 (***) ***-****"],BY:["+375 ** *******"],US:["+1 (***) ***-****"]}};function wt(r){if(window.IMask===void 0)return;let t={signed:!0,lazy:!0,padFractionalZeros:!0,definitions:r.getAttribute("type")==="tel"?{"*":/\d/,"#":/\d/}:{"#":/\d/,"@":/[A-Za-z\u00AA\u00B5\u00BA\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u0527\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0\u08A2-\u08AC\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0977\u0979-\u097F\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C33\u0C35-\u0C39\u0C3D\u0C58\u0C59\u0C60\u0C61\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D60\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F4\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191C\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19C1-\u19C7\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FCC\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA697\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA78E\uA790-\uA793\uA7A0-\uA7AA\uA7F8-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA80-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uABC0-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]/,"*":/./}},e=r.required,i=r.getAttribute("data-mask");i=i&&!/[ #()*@{}]/.test(i)?function(s){var a;let n=String(s).toLowerCase(),o=flexbe_cli.vars.site.country,l=(a=Ie[n])==null?void 0:a[o];return l&&typeof l=="string"&&(l=[l]),Object.assign([],l)}(i):[i];try{if(i=i.filter(n=>/[ #()*@_{}]/.test(n)),i=i.map(n=>n.replace(/0/g,"\\0")),i.length===0)throw{message:"Mask is empty"};i=i.length===1?String(i[0]):i.map(n=>({...t,mask:n}));let s=new window.IMask(r,{...t,mask:i,dispatch:(n,o)=>{let l=o.compiledMasks;if(l.length===1)return l[0];let d=(o.value+n).replace(/\W/g,"");return l.find(h=>{let u=h.mask.replace(/\W/g,"")[0];return d[0]===u})||l[0]}}),a=()=>{s.masked.isComplete||!e&&!s.value?r.setAttribute("data-mask-complete",!0):r.removeAttribute("data-mask-complete"),r.setAttribute("value",s.value)};r.value&&a(),s.on("accept",a),$(r).on("focus",()=>{requestAnimationFrame(()=>{$(r).trigger("click")})}),r._mask=s}catch(s){s instanceof Error&&console.error("MASK ERROR:",{masks:i,errorMessage:s.message}),r.removeAttribute("data-mask")}}function xt(r,t={}){let e={fields:[],...t};r.forEach((i,s)=>{Object.prototype.hasOwnProperty.call(e,s)?Array.isArray(e[s])?e[s].push(i):e[s]=[e[s],i]:e[s]=i});try{for(let i in e)if(i.startsWith("fields[")){let s=i.match(/^fields\[(\w+)\]\[(\w+)\]$/);if(s){let a=s[1],n=s[2],o=e.fields.find(l=>l.id===a);o||(o={id:a},e.fields.push(o)),o[n]=e[i],delete e[i]}else{let a=i.match(/^fields\[(\w+)\]\[(\w+)\]\[\]$/);if(a){let n=a[1],o=a[2],l=e.fields.find(d=>d.id===n);l||(l={id:n},e.fields.push(l)),Array.isArray(l[o])||(l[o]=[]),l[o].push(e[i]),delete e[i]}}}typeof e.products=="string"&&(e.products=JSON.parse(e.products)),(e["pay[price]"]||e["pay[desc]"])&&(e.pay={price:Number(e["pay[price]"]),desc:String(e["pay[desc]"])})}catch(i){console.error(i)}return["is_ajax","captcha-token","roistatVisit","jsform","goal_html","goal","forceUpdateProduct","action","utmData","abTest","pay[price]","pay[desc]","results","fileOriginal","g-recaptcha-response"].forEach(i=>{delete e[i]}),Object.entries(e).forEach(([i,s])=>{s==null&&delete e[i]}),e}var M=class r{static getRecaptchaSettings(){let t={env:{},...flexbe_cli.vars.site.captcha||{}};return!t.visible&&flexbe_cli.is_admin&&(t.enabled=0),t}constructor(t,e=r.getRecaptchaSettings()){this.id=t.id,this.options=t,this.$form=t.$form,this.enabled=e.enabled,this.isOptional=e.ttl>0,this.isVisible=e.visible,this.isInvisible=!e.visible,this.inModal=!(!this.isVisible||!this.isOptional&&!t.inModal),this._widgetId=null,this._token=null}get loaded(){return typeof grecaptcha<"u"}get recaptchaSiteKey(){let{env:t}=r.getRecaptchaSettings();return this.isVisible?t.RECAPTCHA_VISIBLE_SITE_KEY:t.RECAPTCHA_INVISIBLE_SITE_KEY}init(){if(!this.enabled||!this.loaded||this._inited)return;this._inited=!0;let t=this.$form.find(".g-recaptcha-"+(this.isVisible?"visible":"invisible"));t[0]&&this.render(t[0])}getToken(){return this._token}render(t){if(!this.enabled||!this.loaded)return;let e=flexbe_cli.run.is_screen_mobile_s?"compact":"normal";this.isInvisible&&(e="invisible");let i={size:e,sitekey:this.recaptchaSiteKey,callback:s=>{this._token=s,this.closeModal(),this._onSuccess(s)},"expired-callback":()=>{this.reset(),this._onExpired()},"error-callback":()=>{this.reset(),this._onError()}};grecaptcha.ready(()=>{try{this._widgetId=grecaptcha.render(t,i)}catch{}typeof this.options.onRecaptchaRendered=="function"&&this.options.onRecaptchaRendered(this)})}async runModalCaptcha(){let t=`captcha-${this.id}`;if(!this._modal){let i=$(`
                <div class="m_modal m_${t}" data-is="modal" data-id="${t}" data-m-id="CAPTCHA">
                    <div class="modal-data" data-overlay="true">
                        <div class="component-bg"><div class="layer overlay"></div></div>
                    
                        <div class="modal-content" data-contrast="dark" data-v="1" data-as="1">
                            <div class="close close-times"></div>

                            <div class="recaptcha-title">
                                ${flexbe_cli.locale.tr("quiz::captcha_label")}
                            </div>

                            <div id="recaptcha-${this.id}" class="g-recaptcha g-recaptcha-visible"></div>
                        </div>
                    </div>
                </div>
            `);flexbe_cli.modal.$list.append(i);let s=await flexbe_cli.entity.initArea(i);this._modal=s[0]}flexbe_cli.events.trigger("ui_modal_open",{id:t,options:{hash:!1,rise:!0,onClose:()=>{this._token||this._onError()}}});let e=this._modal.$area.find(".g-recaptcha");this._widgetId!=null?this.reset():this.render(e[0])}closeModal(){this._modal&&flexbe_cli.events.trigger("ui_modal_close",{id:this._modal.id})}runInvisibleChallenge(){this.enabled&&this.loaded&&!this.isVisible&&(grecaptcha.ready(()=>grecaptcha.execute(this._widgetId)),$('iframe[title="recaptcha challenge"]').parent().parent().css("z-index",2e3))}reset(){this.enabled&&this.loaded&&(this._token=null,this._widgetId!=null&&grecaptcha.ready(()=>grecaptcha.reset(this._widgetId)),typeof this.options.onReset=="function"&&this.options.onReset(this))}_onError(...t){typeof this.options.onError=="function"&&this.options.onError(this,...t)}_onSuccess(...t){typeof this.options.onSuccess=="function"&&this.options.onSuccess(this,...t)}_onExpired(...t){typeof this.options.onExpired=="function"&&this.options.onExpired(this,...t)}};var ke={selectClass:"",dropdownClass:"",selectedClass:"selected",optionSelector:"option",attrValue:"value",position:"over",padding:10,title:!1},jt=(r,t)=>{if(!r)return;let e=r.value;r.innerHTML="";let i=r.getAttribute("data-placeholder");if(i){let s=document.createElement("option");s.value="",s.textContent=i,r.appendChild(s)}t.forEach(s=>{let a=document.createElement("option");a.value=s.value,a.textContent=s.label,r.appendChild(a)}),t.some(s=>s.value===e)&&(r.value=e),(r.querySelector(`option[value="${e}"]`)||r.querySelector("option")).setAttribute("selected","selected")},nt=class{static create(t){return new this(t)}static getInstance(t){return $(t).data("selectComponent")}constructor(t){this.opts=t,this.config={...ke,...t.config},this.element=t.element,this.$select=$(this.element),this.isNativeSelect=this.$select.is("select"),this.selectAllDevice=this.$select.data("type")==="select",this.blurTimeOut=!1,this.blurListTimeOut=!1,this.focused=!1,this.active=!1,this.$select.data("selectComponent",this),this.createSelect()}createSelect(){this.$customSelect=$(`
            <div class="dropdown-container ${this.config.selectClass}">
                <div tabindex="0" class="dropdown-select">
                    <span class="dropdown-select__content selected"></span>

                    <span class="arrow">
                        <svg viewBox="0 0 10 6" xmlns="http://www.w3.org/2000/svg">
                            <path fill="currentColor" d="M 1.4 6.99441e-15L 0 1.34043L 5 6L 10 1.34043L 8.6 0L 5 3.34998L 1.4 6.99441e-15Z"/>
                        </svg>
                    </span>
                </div>
            </div>
        `),this.$customSelect__content=this.$customSelect.find(".dropdown-select__content"),this.$select.after(this.$customSelect),this.syncSelect(),this.$select.on("syncSelectUI",()=>this.syncSelect()),this.selectAllDevice||flexbe_cli.run.is_screen_desktop?(this.$customSelect.off("click.selected").on("click.selected",".dropdown-select",t=>{clearTimeout(this.blurListTimeOut),this.active?this.collapse():this.activate(t)}),this.$customSelect.off("focus.selectFocus").on("focus.selectFocus",".dropdown-select",()=>{this.focused=!0,this.$listWrapper||this.createList()}),this.isNativeSelect&&this.$select.off("change.changeSelect").on("change.changeSelect",t=>{let e=t.currentTarget.value;if(this.$listWrapper){let i=this.$listWrapper.find(".dropdown-select-ul li");i.removeClass(this.config.selectedClass),i.filter((s,a)=>a.getAttribute(this.config.attrValue)===e).addClass(this.config.selectedClass)}this.$customSelect__content.text(e),typeof this.opts.onChange=="function"&&this.opts.onChange(t)}),this.$customSelect.off("blur.selectBlur").on("blur.selectBlur",".dropdown-select",t=>{setTimeout(()=>{this.collapse()},500)}),this.$customSelect.off("keydown.selectKeydown").on("keydown.selectKeydown",".dropdown-select",t=>{if(this.focused&&[13,27,32,38,40].includes(t.keyCode)){t.preventDefault();let e=this.$list.find(`.option-e.${this.config.selectedClass}`).filter(i=>!$(i).attr("disabled"));if(t.keyCode===40)t.preventDefault(),this.select(e.next(),!1),this.scrollToSelected();else if(t.keyCode===38)t.preventDefault(),this.select(e.prev(),!1),this.scrollToSelected();else if(this.active||t.keyCode!==32){if(this.active&&[13,27,32].includes(t.keyCode))return t.preventDefault(),this.collapse(),!1}else t.preventDefault(),this.activate(t)}})):this.$select.off("change.selected").on("change.selected",t=>{let e=t.target.value||$(t.currentTarget.options[0]).text();this.$customSelect__content.text(e)})}syncSelect(){let t=this.$select.children(this.config.optionSelector).filter((i,s)=>{var a;return((a=s.selected)!=null?a:$(s).attr("selected"))||$(s).hasClass(this.config.selectedClass)}).eq(0),e=t.html()||"\u2014";this.$customSelect__content.attr(this.config.attrValue,t.attr(this.config.attrValue)),this.$customSelect__content.html(e)}createList(){let t=this.$select.children(this.config.optionSelector);this.$listWrapper=$(`
            <div class="select-container-in-body">
                <div class="overlay"></div>
                <ul class="dropdown-select-ul scroller ${this.config.dropdownClass}" tabindex="0"></ul>
            </div>
        `),this.$list=this.$listWrapper.find(".dropdown-select-ul"),t.each((e,i)=>{var s,a,n;let o=$(i),l=((s=i.selected)!=null?s:o.attr("selected"))||o.hasClass(this.config.selectedClass),d=((a=i.disabled)!=null?a:o.attr("disabled"))||o.hasClass("disabled"),h=((n=i.locked)!=null?n:o.attr("locked"))||o.hasClass("locked"),u=this.isNativeSelect?o.val():o.attr(this.config.attrValue),f=o.html().trim()||"\u2014",g="";this.config.title&&(g=o.attr("data-title"));let c=$(`<li title='${g}' class="option-e"></li>`);l&&!d&&c.addClass(this.config.selectedClass),d&&c.attr("disabled","disabled"),h&&c.attr("locked","locked"),c.attr(this.config.attrValue,u),c.html(f),this.$list.append(c)})}select(t,e){if(!t[0])return;if(t.attr("disabled"))return clearTimeout(this.blurTimeOut),void this.$list.off("blur.listBlur").on("blur.listBlur",()=>{this.focused=!1,this.blurListTimeOut=setTimeout(()=>{this.$listWrapper&&this.collapse()},200)});let i=t.attr(this.config.attrValue);if(t.siblings("li").removeClass(this.config.selectedClass),t.addClass(this.config.selectedClass),this.isNativeSelect)this.$select.val(i),this.$select.trigger("change");else{let s=this.$select.children(this.config.optionSelector);s.removeAttr("selected").removeClass(this.config.selectedClass),s.filter(`[${this.config.attrValue}=${i}]`).addClass(this.config.selectedClass).attr("selected","selected")}this.$select.closest(".is_error").removeClass("is_error"),this.syncSelect(),e&&this.collapse()}scrollToSelected(){let t=this.$list[0].offsetHeight;if(this.$list[0].scrollHeight<=t)return!1;let e=this.$list.children(".option-e").find(`.${this.config.selectedClass}`)[0];e&&e.scrollIntoView()}collapse(){clearTimeout(this.blurTimeOut),this.active=!1,this.$listWrapper.removeClass("active rise"),this.$listWrapper.detach(),typeof this.opts.onCollapse=="function"&&this.opts.onCollapse()}activate(t){if(this.active)return!1;this.active=!0,this.createList();let e=this.config.padding||0,i=this.$customSelect[0].getBoundingClientRect(),s={left:i.left+window.scrollX,top:i.top+window.scrollY,width:i.width,height:i.height};this.config.position==="under"&&(s.top=s.top+s.height+e),this.$listWrapper.off("click.closeSelect").on("click.closeSelect",".overlay",a=>{this.collapse();let n=document.elementFromPoint(a.clientX,a.clientY);n&&n.focus()}),this.$listWrapper.off("click.selectLi").on("click.selectLi",".dropdown-select-ul li",a=>{let n=$(a.currentTarget);this.select(n,!0),typeof this.opts.onSelect=="function"&&this.opts.onSelect(a)}),this.$listWrapper.off("mousewheel.selectUl").on("mousewheel.selectUl",".dropdown-select-ul",a=>{let n=a.currentTarget.scrollHeight,o=a.currentTarget.clientHeight;return!(a.currentTarget.scrollTop===n-o&&a.deltaY>0||a.currentTarget.scrollTop===0&&a.deltaY<0)}),$("body").append(this.$listWrapper),clearTimeout(this.blurTimeOut),this.$list.css({left:`${s.left}px`,top:`${s.top}px`,width:`${s.width}px`}),this.$listWrapper.outerWidth(),this.$listWrapper.toggleClass("rise",!!this.$select.closest(".m_modal, .w_widget").length),this.$listWrapper.addClass("active"),this.scrollToSelected(),typeof this.opts.onActivate=="function"&&this.opts.onActivate(t)}};var Ut="next",ot="result",_t=class extends _{constructor(...t){super(...t),this.id=this.core.id,this.eventId=`.quiz${this.id}`,this.products=null,this.pay=null,this.createQuiz()}onInit(){this.$masked=this.$form.find("[data-mask]"),this.$file=this.$component.find(".form-field-file"),this.require=[],this.$masked.length&&(this.needInitMasks=!0,this.require.push("/_s/lib/imask/imask.min.js?v1")),this.$file.length&&(this.$itemTemplateFile=this.$itemTemplateFile||this.$file.find("template").clone()),this.$calendars=this.$form.find(".form-field-date__input"),this.$calendars.length&&(this.needInitCalendar=!0,this.require.push("/_s/lib/scroll-lock/scroll-lock.min.js"),this.require.push("/_s/lib/calendar/dist/js/calendar.js?v2.3.13","/_s/lib/calendar/dist/css/calendar.min.css?v2.3.5"))}onLoad(){(this.core.wasScreen||this.core.wasBeside)&&(this.needInitMasks&&this.initFieldMask(),this.needInitCalendar&&this.initFieldDate()),this.isLoaded=!0}onScreen({state:t}){if(!t)return!1;this.initQuiz()}onBeside({state:t}){if(!t)return!1;this.initQuiz()}onOpen(t={}){this.initQuiz(),this.started||this.startQuiz(),t&&t.data&&this.setData(t.data)}onResize(){this.$component.find(".range-outer").trigger("resize")}createQuiz(){this.timeouts=[],this.history=[],this.swiper=[],this.$area=this.core.$area,this.$root=this.core.$root,this.$form=this.$component.is("form")?this.$component:this.$component.find("form"),this.$steps=this.$component.find(".quiz-steps"),this.$actions=this.$component.find(".quiz-actions"),this.$progress=this.$component.find(".quiz-progress"),this.$scroller=this.$root.find(".scroller"),this.$stepsWrapper=this.$steps.find(".steps-wrapper"),this.$outerWrapper=this.$area.find('[data-quiz-part="wrapper"]'),this.$welcomeScreen=this.$outerWrapper.find('[data-quiz-part="welcome"]'),this.$progress.length||(this.$progress=this.$area.find('[data-quiz-part="progress"]')),this.rootModal=this.core.is==="modal"&&this.core,this.hasWelcome=!!this.rootModal||this.$welcomeScreen.length>0,this.autoNextEnabled=+this.$steps.attr("data-autonext")||0,this.currentId=null,this.currentIndex=-1,this.total=parseInt(this.$component.attr("data-total-steps"),10)}initQuiz(){if(this.inited)return;this.inited=!0,this.$form.attr("action",`/mod/project/${flexbe_cli.group_id}/lead/send/`),this.resetForm(),this.bindEvents(),this.initFields(),this.initControls(),this.initCaptcha();let t=flexbe_cli.is_admin&&this.$area.data("initialQuizStepId"),e=flexbe_cli.is_admin&&this.$area.data("initialQuizStepIndex");t?this.toStep({id:t,index:e,animated:!1}):this.hasWelcome||this.startQuiz({animated:!1})}onHideShowUI(){this.resetForm()}bindEvents(){flexbe_cli.events.off(this.eventId),this.$form.off(this.eventId),this.$scroller.off(this.eventId),flexbe_cli.events.on(`quiz_command${this.eventId}`,t=>{this.id===t.id&&(t.command==="welcome"?this.toWelcome():t.command==="start"?this.startQuiz():t.command==="step"&&this.toStep({id:t.stepId,index:t.stepIndex,force:t.force,animated:t.animated,scrl:t.scroll}))}),this.$form.on(`change${this.eventId}`,".policy-data-warning__input",t=>{this.$form.find(".policy-data-warning__input").prop("checked",t.target.checked)}),this.$form.on(`input${this.eventId} change${this.eventId}`,"input, textarea",t=>{let e=t.currentTarget,i=e.value,s=$(e);s.attr("value",i),s.closest(".is_error").removeClass("is_error")}),this.$form.on(`keydown${this.eventId}`,"input, textarea",t=>{let e=t.currentTarget,i=e.getAttribute("data-check"),s=t.key||"",a=t.ctrlKey||t.metaKey;return!(i==="phone"&&!e._mask&&!a&&s.length===1&&/[^\d ()+-]/.test(s))&&(i!=="email"||!/[\s,]/.test(s))&&void 0}),this.needInitCalendar&&this.core.is==="modal"&&setTimeout(()=>{this.$calendars.toArray().forEach(t=>{let e=$(t).data("calendar");this.$scroller.on(`scroll${this.eventId}`,()=>{e.main.toPosition()})})},150),this.$form.on(`submit${this.eventId}`,t=>(t.preventDefault(),t.stopPropagation(),this.onSubmit()))}initControls(){$("body").off(`keydown${this.eventId}`).on(`keydown${this.eventId}`,t=>{let e=t.key==="Tab",i=t.key==="Enter";if(!i&&!e)return;let s=this.inFocus,a=t.metaKey||t.ctrlKey,n=t.shiftKey;if(s&&(t.target.tagName!=="TEXTAREA"||!i||a)){if(n&&e)this.toPrevStep();else if(!n&&!a){let o=this.$currentStep.find(":focus").closest(".field").next(".field");this.focusField(o)||this.toNextStep()}return t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation(),!1}}),this.$component.off("click.control").on("click.control","[data-quiz-action]",t=>{let e=t.currentTarget.getAttribute("data-quiz-action");e==="welcome"?this.toWelcome():e==="prev"?this.toPrevStep():e==="next"&&this.toNextStep(),t.preventDefault()})}setProgress(){let t=this.$progress.find(".progress-loader-bar .current"),e=this.total,i=t.data("unit"),s=this.realIndex+1;flexbe_cli.is_admin&&this.realIndex===-1&&this.currentId!=="welcome"&&(s=(+this.$currentStep.prevAll('[data-linked="linked"]').first().attr("data-real-index")+1||0)+1);let a=parseInt(100*s/e,10)||0;if(s=Math.max(0,Math.min(e,s)),a=Math.max(0,Math.min(100,a)),t.length&&i){let n=`${a}%`;i==="step"?n=`${s} / ${e}`:i==="none"&&(n=""),t.attr("data-value",n)}this.$progress.attr("data-current-progress",a),this.$progress.attr("data-current",s),this.$progress.attr("data-total",e),this.$progress.find(".progress-text .current").text(s),this.$progress.find(".progress-text .total").text(e),this.$progress.find(".progress-percent .current").text(a),this.$progress.find(".progress-loader-bar .current").css("width",`${a}%`),this.$progress.find(".progress-loader-circle .current").attr("stroke-dashoffset",`${Math.abs(100-a)}`)}setActionButtons(){let t=this.hasWelcome||this.history.length>1||!!(flexbe_cli.is_admin&&this.realIndex!==0&&this.currentIndex>0);!flexbe_cli.is_admin||!this.rootModal||this.realIndex&&this.currentIndex||(t=!1),this.$actions.toggleClass("show-prev",t)}toWelcome({scrl:t=!0}={}){if(!this.hasWelcome)return this.startQuiz({scrl:t}),!0;if(this.started=!1,this.currentIndex=-1,this.realIndex=-1,this.currentId="welcome",this.$area.data("initialQuizStepId",this.currentId),this.$area.data("initialQuizStepIndex",this.currentIndex),this.$outerWrapper.attr("data-active-step",this.currentId),this.$outerWrapper.attr("data-active-index",this.currentIndex),this.$outerWrapper.toggleClass("quiz-state-welcome",!0),this.$outerWrapper.toggleClass("quiz-state-started",!1),this.rootModal)flexbe_cli.run.is_preview&&flexbe_cli.events.trigger("ui_modal_close",{id:this.rootModal.id});else if(this.$outerWrapper.length){let e=this.$welcomeScreen.outerHeight()||0;this.$outerWrapper.css("minHeight",e)}return this.setProgress(),this.setActionButtons(),t&&this.core.is==="block"&&flexbe_cli.run.is_preview&&flexbe_cli.scroll.toElement(this.$area),flexbe_cli.events.trigger("quiz_event",{event:"welcome",sender:"core",quiz:this}),!0}startQuiz({animated:t,scrl:e}={}){this.sessionId=parseInt(Date.now()/1e3,10);let i=this.$stepsWrapper.find('.step[data-type="root"][data-linked="linked"]').first();i.length&&this.toStep({$step:i,force:!0,animated:t,scrl:e})}autoNextStep(){!this.autoNextEnabled||this.$currentStep.find(".quiz-fields").data("count")>1||setTimeout(()=>{this.toNextStep()},150)}toPrevStep(){let t=this.history[this.history.length-2];if(!t){let e=this.$currentStep.prevAll('.step[data-type="root"][data-linked="linked"]').first();return e.length?this.toStep({$step:e}):this.hasWelcome&&this.toWelcome(),!1}return this.toStep(t),!0}gatherStepAnswers(t=this.$currentStep){let e=t.find("[data-field-id]").toArray().map(s=>{let a=$(s),n=a.attr("data-field-id"),o=a.find("input, textarea").not('[type="hidden"]'),l=a.find("[data-goto]"),d=a.attr("data-type"),h=a.find(`[name="vars[${n}]"]`).val(),u=o.attr("type"),f=l,g=o.val();["checkbox","radio","image"].includes(d)?f=l.filter(":checked"):d==="select"?(f=f.filter((m,v)=>v.selected),u="select"):d==="file"&&(g=a.find("input.value").map((m,v)=>v.value).toArray());let c=f.toArray(),p=c.map(m=>m.getAttribute("data-goto")).filter(m=>m);return{id:n,title:h,type:d,inputType:u,value:g,variants:c.map(m=>({id:m.getAttribute("data-id"),value:m.value})).filter(m=>m.id),goto:p}}),i=e.map(s=>{let a={id:s.id,title:s.title,type:s.type};return["radio","checkbox","select","image"].includes(s.inputType)?a.variants=s.variants:a.value=s.value,a});return{fields:e,answers:i}}toNextStep(){if(!this.validateStep(this.$currentStep))return!1;let t=this.$currentStep,{fields:e,answers:i}=this.gatherStepAnswers(t),s=e.flatMap(o=>o.goto)[0]||t.attr("data-goto")||Ut,a=this.getNextStep(s,t),n=this.history.find(o=>o.id===this.currentId);n&&(n.fields=e,n.answers=i,n.toId=a,n.goal=this.$currentStep.attr("data-goal"),n.htmlGoal=this.$currentStep.attr("data-html-goal")),this.toStep({id:a})}getNextStep(t,e=this.$currentStep){if(t===ot){let s=this.history.map(n=>n.$step[0]),a=this.$stepsWrapper.find('[data-type="root"][data-linked="linked"][data-required]').filter((n,o)=>!s.includes(o));return a.length?a.eq(0).attr("data-id"):ot}let i=t;return(t===Ut||!this.getStepNodeById(i).length)&&(i=e.nextAll('.step[data-type="root"][data-linked="linked"]').first().attr("data-id")),t!==Ut||i?i:this.getNextStep(ot,e)}getStepNodeById(t){return this.$stepsWrapper.find(`.step[data-id="${t}"]`)}getStepNodeByIndex(t){return this.$stepsWrapper.find(`.step[data-index="${t}"]`)}toStep({id:t,index:e,$step:i,force:s,scrl:a=!0,animated:n=!0}){if(this.inStepAnimation)return!1;let o=this.history.find(m=>m.id===this.currentId);if(t===ot)return void this.toResult();if(i&&i.length||t==null||(i=this.getStepNodeById(t)),i&&i.length||e==null||(i=this.getStepNodeByIndex(e)),!i||!i.length)return!1;if(t=t??i.attr("data-id"),e=parseInt(e??i.attr("data-index"),10),t===this.currentId)return this.enableStep(i),!1;let l=flexbe_cli.is_admin?parseInt(i.attr("data-real-index"),10):e,d=e>this.currentIndex;n||this.$area.addClass("noanimate"),i.find(".is_error").removeClass("is_error");let h=i.outerHeight(),u={$step:i,id:t,title:i.find(".step-title").text().trim(),index:e,realIndex:l,fields:[],answers:[]},f=[];s?(f=this.history,this.history=[]):(f=this.history.filter(m=>m.index>=u.index),this.history=this.history.filter(m=>!f.includes(m))),f.forEach(m=>{this.disableStep(m.$step)}),this.enableStep(i),this.started=!0,this.history.push(u),this.$component.addClass("quiz-started"),n&&this.$component.addClass("step-change-animation");let g=flexbe_cli.helpers.scrollParent(this.$component[0])||document.scrollingElement,c=g&&g.scrollTop||0,p=this.$stepsWrapper.outerHeight();if(this.$area.data("initialQuizStepId",t),this.$area.data("initialQuizStepIndex",e),this.$outerWrapper.attr("data-active-step",t),this.$outerWrapper.attr("data-active-index",e),this.$outerWrapper.toggleClass("quiz-state-welcome",!1),this.$outerWrapper.toggleClass("quiz-state-started",!0),i.toggleClass("higher",h>p),n&&this.$stepsWrapper.css("height",`${p}px`),flexbe_cli.theme_id===4&&this.$outerWrapper.css("minHeight",`${p}px`),i.prevAll().removeClass("active next").addClass("prev"),i.nextAll().removeClass("active prev").addClass("next"),i.removeClass("next prev").addClass("active"),this.currentId=t,this.currentIndex=e,this.realIndex=l,this.$currentStep=i,this.core.updateTween(),this.setProgress(),this.setActionButtons(),this.initImages(),flexbe_cli.theme_id===2){let m=this.$area.find(".b_head");m.length&&flexbe_cli.header.fixHeaderHeight(this.$area,m)}return this.timeouts=this.timeouts.filter(m=>clearTimeout(m)),this.timeouts.push(setTimeout(()=>{n||this.$area.removeClass("noanimate")},20)),n?(this.inStepAnimation=!0,this.timeouts.push(setTimeout(()=>{this.$stepsWrapper.css("height",""),this.$component.removeClass("step-change-animation"),i.find(".range-outer").trigger("resize"),this.inStepAnimation=!1},250)),a&&(this.timeouts.push(setTimeout(()=>{let m=this.$area.get(0).getBoundingClientRect();this.$stepsWrapper.css("height",`${h}px`);let v=g.scrollTop,C=this.$area.get(0).getBoundingClientRect().bottom-m.bottom-(c-v);C&&g.scrollTo(0,v+C)},150)),flexbe_cli.run.is_preview&&this.timeouts.push(setTimeout(()=>{let m=this.$component;this.$area.outerHeight()<=flexbe_cli.resize.viewportHeight&&(m=this.$area),flexbe_cli.scroll.toElement(m,{centered:!0,force:!1,complete:()=>{flexbe_cli.run.is_mobile||this.focusField(i)}})},450)))):i.find(".range-outer").trigger("resize"),flexbe_cli.events.trigger("quiz_event",{event:"step",sender:"core",quiz:this,payload:{fromId:o?.id,fromTitle:o?.title,fromAnswers:o?.answers,toNext:d,toId:t,sessionId:this.sessionId},answerGoals:{goal:o?.goal,htmlGoal:o?.htmlGoal}}),!0}toResult({force:t}={}){let e=t||this.validateStep();return!!(t||!this.busy&&e)&&(this.$form.get(0).dispatchEvent(new Event("submit",{cancelable:!0})),!0)}validateStep(t=this.$currentStep){let e=!0;if(!t||!t.length)return!0;let i=t.find(".policy-data-warning--checkbox"),s=i.find("input")[0];return s&&!s.checked&&(e=!1,i.addClass("is_error animate")),t.find(".field[data-type]").each((a,n)=>{let o=$(n),l=o.attr("data-type"),d;if(o.removeClass("is_error"),l==="captcha"){if(!this.captcha)return;d=!this.captcha.getToken()&&flexbe_cli.locale.tr("form::captcha_not_checked")}else d=this.checkField(o);d&&(o.outerWidth(),o.addClass("is_error animate"),setTimeout(()=>{o.removeClass("animate")},500),l==="file"?o.find(".error-text").text(d):o.find(".error").text(d),e&&this.focusField(o,500),e=!1)}),e}validateHistorySteps(){let t=this.history.every(s=>this.validateStep(s.$step));if(!this.history.length||!t)return!1;let e=this.history.at(-1),i=e.fields.flatMap(s=>s.goto)[0]||e.$step.attr("data-goto")||ot;return this.getNextStep(i,e.$step)===ot}getResult(){let t=this.$form.find("input[name=results]").data("value")||[],e=t.filter(i=>i.id!=="default").find(i=>this.checkResultCondition(i));return e||(e=t.find(i=>i.id==="default")||t[0]),typeof e.action!="object"&&(e.action={pay:e.pay,name:e.action,modal_id:e.modal_id,action_redirect:e.action_redirect}),e}checkResultCondition(t){let e=t.conditions||{},i=e.union,s=e.list||[],a=this.history.reduce((l,d)=>l.concat(d.fields),[]),n=s.map(l=>{let d=a.find(h=>String(h.id)===String(l.field));return{condition:l,field:d}});return!!n.length&&(n=n[i==="and"?"every":"some"](({condition:l,field:d})=>{let h=!0;if(!d)return!1;if(l.type==="vars"){let u=d.variants||[],f=(l.variants||[]).map(g=>`${g}`);if(!u.length)return!!l.emptyVariant;if(l.unionExtra||(h=u.every(g=>f.includes(`${g.id}`))),h){let g=l.union;d.inputType!=="radio"&&d.inputType!=="select"||(g="or"),h=f[g==="and"?"every":"some"](c=>u.find(p=>p.id===c))}}else if(l.type==="range"){let u=`${d.value}`.replace(/\s+/g,"").split(/\s[—-]\s/).map(v=>+v).filter(v=>typeof v=="number"&&!Number.isNaN(v)),f=Math.min.apply(null,u),g=Math.max.apply(null,u),c=f!==g,p=+l.rangeLimitFrom,m=+l.rangeLimitTo;if(l.operator==="equal")return c?f<=p&&p<=g:p===f;o(p)&&o(m)&&(p=Math.min(l.rangeLimitFrom,l.rangeLimitTo),m=Math.max(l.rangeLimitTo,l.rangeLimitFrom)),h&&o(p)&&(h=p<=f),h&&o(m)&&(h=g<=m)}else if(l.type==="text"){let u=l.fill,f=(d.value||"").trim().replace(/ +/g," ").replace(/\+/g,"\u2214"),g=l.answers.map(c=>`${c}`.toLowerCase().replace(/\+/g,"\u2214")).filter(c=>c);if(u==="fill")return!!f;if(u==="empty")return!f;if(u==="include")return g.some(c=>new RegExp(`^${c}|\\s${c}`,"i").test(f));if(u==="exclude")return g.every(c=>!new RegExp(`^${c}|\\s${c}`,"i").test(f))}else if(l.type==="file"){let u=l.fill,f=d.value;if(u==="fill")return!!f.length;if(u==="empty")return!f.length}return h}),n);function o(l){return!Number.isNaN(+l)&&l!=null&&l!==""}}checkField(t){let e=t.find("input, textarea, select").not('[type="hidden"]'),i=e[0],s=t[0];if(!i)return;let a=s.getAttribute("data-type"),n=i.required||t.is('[data-required="true"]'),o=i.getAttribute("data-check")||!1,l=i._mask&&i.getAttribute("data-mask")||!1,d;d=["checkbox","radio","image"].includes(a)?!!e.closest(":checked").length:a==="file"?t.find("input.value"):i.value;let h=!(!n||d)&&"form::required";if(l)!n&&!d||i.getAttribute("data-mask-complete")||(h=a==="phone"&&d?"form::phone":a==="text"&&d?"form::text":"form::required");else if(o){if(d.length&&a==="email")/^(([^\s"(),.:;<>@[\\\]]+(\.[^\s"(),.:;<>@[\\\]]+)*)|(".+"))@((\[(?:\d{1,3}\.){3}\d{1,3}])|(([\wЁА-яё-]+\.)+[A-Za-zЁА-яё]{2,}))$/.test(d)||(h="form::email");else if(d.length&&a==="phone")/[^\d\s()+-]/.test(d)?h="form::digits":d.replace(/\D/g,"").length<5&&(h="form::phone_minlength");else if(a==="file")h=n&&!d.length?"form::required":!!t.hasClass("loading")&&"form::loading";else if(a==="date"||a==="datetime"){let u=$(i).data("calendar"),f=u&&u.input.checkError();f&&(h=f)}}return h=h&&flexbe_cli.locale.tr(h)||!1,h}disableStep(t){t.find("input, textarea, select").prop("disabled",!0)}enableStep(t){t.find("input, textarea, select").prop("disabled",!1)}focusField(t,e=200){if(!t||!t.length||flexbe_cli.run.is_ios)return!1;let i=t.find(".form-field-text__input, .dropdown-select").not(".form-field-date__input").first();return!!i.length&&(e?setTimeout(()=>i.focus(),e):i.focus(),!0)}initImages(){setTimeout(()=>{let t=$(this.component).find(".step.active");$(t).find(".component-image").length&&z(t,"image","setImage")},100)}initFields(){this.initFieldImage(),this.initFieldCheckbox(),this.initFieldRadio(),this.initFieldSelect(),this.initFieldTextarea(),this.initFieldFile(),this.initFieldRange(),this.isLoaded&&(this.needInitMasks&&this.initFieldMask(),this.needInitCalendar&&this.initFieldDate())}initFieldImage(){this.$component.off("click.fieldImages").on("click.fieldImages",".form-field-image-item",t=>{let e=t.currentTarget.querySelector("input"),i=!e.checked;e.checked=i,i&&e.type==="radio"&&this.autoNextStep()})}initFieldFile(){var t;let e=this.$component,i=this.eventId,s=(t=this.$itemTemplateFile)==null?void 0:t.html();bt(e,i,s)}initFieldCheckbox(){}initFieldRadio(){this.autoNextEnabled&&this.$component.off("change.initRadio").on("change.initRadio",".form-field-radio-item",()=>{this.autoNextStep()})}initFieldSelect(){this.$component.find(".dropdown-container").remove();let t=this.$component.find("select.atom-custom-select"),e={position:"under",dropdownClass:this.$component.hasClass("style-underlined")?"sharp size--large":"size--large"};t.each((i,s)=>{let a=$(s).closest('[data-type="select"]');nt.create({element:s,config:e,onChange:this.autoNextStep.bind(this),onSelect:this.autoNextStep.bind(this),onCollapse:()=>{a.removeClass("active")},onActivate:()=>{a.addClass("active"),a.siblings('[data-type="select"]').removeClass("active")}})})}initFieldTextarea(){this.$component.find("textarea.autosize").each((t,e)=>{let i=e.offsetHeight-e.clientHeight,s=$(e);s.removeAttr("data-autoresize"),s.off("keyup input").on("keyup input",function(a){a.currentTarget.style.height="auto",a.currentTarget.style.height=`${a.currentTarget.scrollHeight+i}px`})})}initFieldRange(){this.$component.find(".form-field-range").each((t,e)=>new at($(e)))}addSubmitting(){this.busy=+Date.now(),this.$component.addClass("submitting"),this.$form.addClass("submitting")}clearSubmitting(t=!1){this.busy&&(this.$component.removeClass("submitting"),this.$form.removeClass("submitting"),t?(this.$component.addClass("success"),this.$component.find(".file-list").empty(),this.$component.find("input.value").remove(),setTimeout(()=>{this.busy=!1,this.$component.removeClass("success")},1e3)):this.busy=!1)}onSubmit(){if(!this.validateHistorySteps())return;this.result=this.getResult();let t={id:this.core.id,name:this.result.name,action:this.result.action.name,pageId:flexbe_cli.p_id,utmData:JSON.stringify(flexbe_cli.utm.data),jsform:parseInt(448312,10)};if(flexbe_cli.stat.u_id&&(t.userId=flexbe_cli.stat.u_id),"roistat"in window&&(t.roistatVisit=window.roistat.visit),this.result.action.name==="pay"&&this.result.action.pay){let e=this.result.action.pay;if(e.desc&&(t["pay[desc]"]=e.desc),e.price&&(t["pay[price]"]=e.price,e.title))if(e.productId){let i=flexbe_cli.ecommerce.productsStore.getProduct(e.productId);if(i){let s=i.currentVariant(e.variantId).getCartData("image");s.img=J(s.img[0]),t.products=JSON.stringify([{...s,count:1,id:`product_${e.productId}:${e.variantId||"default"}`}])}}else t.products=JSON.stringify([{title:e.title,id:`${flexbe_cli.p_id}_${flexbe_cli.s_id}`,img:e.img&&J(e.img),count:1,price:e.price}])}return Object.entries(t).forEach(([e,i])=>{i!=null&&this.addFields([{name:e,value:i,type:"hidden"}],!1)}),this.sendForm(),!1}async sendForm(){let t=this.captcha&&this.captcha.getToken();if(this.captcha&&this.captcha.enabled&&!this.captcha.isOptional&&!t)return void(this.captcha.isVisible?this.toStep({id:"captcha"}):this.captchaInvisibleRun());this.addSubmitting();let e=new FormData(this.$form.get(0));e.delete("fileOriginal"),e.delete("g-recaptcha-response"),t&&e.append("captcha-token",t);let i=flexbe_cli.stat.AB.getCookie();if(e.append("abTest",JSON.stringify(i)),flexbe_cli.run.is_OSX&&typeof e.entries=="function")for(let s of e.entries()){let[a,n]=s;typeof n=="object"&&n instanceof File&&n.size===0&&typeof e.delete=="function"&&e.delete(a)}try{let s=await flexbe_cli.helpers.fetch(this.$form.attr("action"),{type:"POST",dataType:"json",processData:!1,contentType:!1,data:e});s.pay!==void 0&&(this.pay=s.pay),this.showDone(e,s),this.captchaRemoveError()}catch(s){let a=s.data||{};if(a.captcha)return this.captcha||await this.initCaptcha({...M.getRecaptchaSettings(),enabled:!0,visible:a.captcha==="visible",ttl:1}),void(t?this.captchaAddError():this.captcha.isVisible?(this.captcha.isOptional=!1,this.total=parseInt(this.$component.attr("data-total-steps"),10)+1,this.clearSubmitting(!1),this.toStep({id:"captcha"})):this.captcha.isInvisible&&this.captchaInvisibleRun());this.clearSubmitting(!1),console.error("sendForm error: ",s),alert("Form submitting error!")}}showDone(t,e={}){let i=this.result.action.name,s=this.history.at(-1),a=xt(t,{leadId:e.lead_id,pays:e.pay}),n=()=>{setTimeout(()=>{this.resetForm(),this.toWelcome({scrl:!1})},500)};if(s){let l=s.answers,d=s.id,h=s.title,u=this.result.goals||{};flexbe_cli.events.trigger("quiz_event",{event:"submit",sender:"core",quiz:this,payload:{fromAnswers:l,fromId:d,fromTitle:h,sessionId:this.sessionId},answerGoals:{goal:s.goal,htmlGoal:s.htmlGoal},resultGoals:{mainGoal:flexbe_cli.stat.getGoal("order_done"),goal:u.goal,htmlGoal:u.goal_html},resultGoalsData:{leadId:e.lead_id,formData:a}})}if(typeof this.afterSent=="function"&&this.afterSent(),i==="pay"&&this.pay!==void 0&&this.pay!==null&&this.pay.pay_link.length>0){let l=`${window.location.origin+window.location.pathname+(window.location.search?`${window.location.search}&`:"?")}pay_id=${this.pay.pay_id}&h=${this.pay.pay_hash}`;try{window.history.pushState(null,null,l),setTimeout(()=>{flexbe_cli.events.trigger("pay",{action:"init"})},200)}catch{setTimeout(()=>{document.location=l},500)}}else if(["redirect","anchor"].includes(i)){let l=this.result.action.action_redirect,d=this.result.action.action_link;l?(flexbe_cli.helpers.gotoLink(l),setTimeout(()=>{n()},1e3)):d&&flexbe_cli.helpers.gotoLink(d)}else if(i==="code"){if(!flexbe_cli.run.is_preview)return;(async d=>{let h=this.result.action.action_code;await new(Object.getPrototypeOf(async()=>{})).constructor("formData",h)(d)})(a).catch(d=>{console.error("Error executing action code:",d)})}else{let l=this.result.action.modal_id;flexbe_cli.events.trigger("ui_modal_open",{id:l})}let o=new Event("submitted",{bubbles:!0});this.$form.get(0).dispatchEvent(o),this.clearSubmitting(!0),n()}resetForm(){this.$form.find(".form-field-file, .file-input-outer").removeClass("active");let t=this.$stepsWrapper.find("input, textarea, select"),e=t.not("select").not('[type="hidden"]').not(".form-field-range__input"),i=t.filter("select"),s=t.filter(".form-field-range__input");t.prop("disabled",!0),i.each((a,n)=>{let o=n.querySelector("option"),l=o&&o.value||"";n.value!==l&&(n.value=l,n.dispatchEvent(new Event("change")))}),s.each((a,n)=>{n.value=n.getAttribute("data-value"),n.dispatchEvent(new Event("change"))}),e.each((a,n)=>{let o=n.defaultChecked;["radio","checkbox"].includes(n.type)?n.checked=o:(n.removeAttribute("value"),n.value="",n.removeAttribute("data-mask-complete"),n._mask&&n._mask.updateValue()),n.dispatchEvent(new Event("change"))}),this.captcha&&this.captcha.enabled&&(this.captcha.reset(),this.captchaRemoveError()),yt(),this.$form[0].reset()}async initCaptcha(t){return t==null&&(t=M.getRecaptchaSettings()),new Promise((e,i)=>{!this.captcha&&t.enabled&&(this.captcha=new M({id:this.id,$form:this.$component,onSuccess:()=>{this.captchaRemoveError(),this.toResult({force:!0})},onError:()=>{this.captchaAddError()}},t),flexbe_cli.require(`https://www.google.com/recaptcha/api.js?render=explicit&hl=${flexbe_cli.vars.site.language}`,()=>{let s=150,a=setInterval(()=>{s-=1,this.captcha.loaded?(this.captcha.init(),clearInterval(a),e()):s===0&&i(new Error("Can not load grecaptcha"))},10)}))})}captchaAddError(t){if(!this.captcha||!this.captcha.enabled)return;t==null&&(t=flexbe_cli.locale.tr("form::captcha_error"));let e=this.$component.find(".captcha-global-error");e.find(".error-text").text(t),e.addClass("show"),this.busy&&this.clearSubmitting()}captchaRemoveError(){if(!this.captcha||!this.captcha.enabled)return;let t=this.$component.find('.field[data-type="captcha"]'),e=this.$component.find(".captcha-global-error");t.removeClass("is_error"),e.removeClass("show")}captchaInvisibleRun(){if(!this.captcha||!this.captcha.enabled||!this.captcha.loaded||this.captcha.isVisible)return;this.addSubmitting(),this.captcha.runInvisibleChallenge();let t=this.busy;setTimeout(()=>{t===this.busy&&this.clearSubmitting()},2500)}setData(t){if(!t)return!1;t&&t.fields&&this.addFields(t.fields),t&&t.items&&this.addItems(t.items)}addFields(t,e=!0){let i=this.$component.find(".form-fields-advanced");t.length&&i[0]&&(e&&this.resetFields(),t.forEach(s=>{i.find(`input[name="${s.name}"]`).remove();let a=$("<input>").attr("type",s.type).attr("name",s.name).attr("value",s.value);i.append(a)}))}resetFields(){let t=this.$component.find(".form-fields-advanced");t[0]&&t.empty()}addItems(t=[]){if(!t||!t.length)return;let e=0,i="",s=[];t=t.map(n=>typeof n!="object"?{}:(n.price=parseFloat(n.price)||0,n.title=typeof n.title=="string"&&n.title.trim()||n.title||"",e+=n.price*n.count||0,n));try{i=JSON.stringify(t)}catch{}let a={products:i};e&&(a={...a,"pay[price]":e,"pay[desc]":""}),Object.entries(a).forEach(([n,o])=>{s.push({type:"hidden",name:n,value:o})}),this.addFields(s)}initFieldMask(){return typeof IMask<"u"&&(this.needInitMasks=!1,this.$masked.each((t,e)=>{wt(e);let i=!!e.getAttribute("data-placeholder"),s=e._mask;i&&s&&($(e).on(`focus${this.eventId}`,()=>{s.updateOptions({lazy:!1})}),$(e).on(`blur${this.eventId}`,()=>{if(!s.unmaskedValue){let a=s.mask.replace(/\*/g,"_"),n=s.value;s.updateOptions({lazy:!0}),s.masked.rawInputValue&&a!==n||(s.unmaskedValue="",s.value="",s.updateValue())}}))}),!0)}initFieldDate(){this.needInitCalendar=!1;let t=this.$component.closest(".scroller")[0];return this.$calendars.each((e,i)=>{$t(i,t)}),!0}};_t.is="quiz";var Ct=class extends _t{setProgress(){let t=this.$progress.find(".progress-loader-bar .current"),e=this.$progress.attr("data-text-style")==="step",i=t.attr("data-unit"),s=this.total,a=this.realIndex;flexbe_cli.is_admin&&this.realIndex===-1&&this.currentId!=="welcome"&&(a=+this.$currentStep.prevAll('[data-linked="linked"]').first().attr("data-real-index")+1||0),a=Math.max(0,Math.min(s-1,a));let n=e?a+1:a,o=parseInt(100*n/s,10);if(this.$progress.attr("data-current",n),this.$progress.attr("data-total",s),this.$progress.attr("data-current-progress",o>0?o:0),t&&i){let l=`${o}%`;i==="step"?l=`${n} / ${s}`:i==="none"&&(l=""),t.find(".progress-runner").attr("data-value",l)}this.$progress.find(".progress-text .current").text(n),this.$progress.find(".progress-text .total").text(s),this.$progress.find(".progress-percent .current").text(o),this.$progress.find(".progress-loader-bar .current").css("width",`${o}%`),this.$progress.find(".progress-loader-circle .current").attr("stroke-dashoffset",`${Math.abs(100-o)}`)}};flexbe_cli.entity.setClientJs("modal","QUIZ",{components:[Ct,k,R]});flexbe_cli.entity.setClientJs("element","figure",{components:[R],isPure:!0});var Jt=class{constructor(t){this.decimalPlaces=void 0,this.max=void 0,this.min=void 0,this.$input=void 0,this.$input=t.find('input:not([type="hidden"]'),this.max=Number(this.$input.data("max")),this.min=Number(this.$input.data("min")),this.decimalPlaces=Number(this.$input.data("decimal-places")||0),this.$input[0]&&(this.$input.val(this.normalize(this.$input.val())),this.setEvents())}normalize(t){return t=this.onlyNumber(t),t=this.decimalPlacesValue(t),Number.isNaN(this.max)||Number.isNaN(this.min)||(t=this.minMaxValue(t)),t}onlyNumber(t){return t=t.replace(/[^\d.,]/g,"").replace(/([.,])[.,]*/g,"$1").replace(/^([^.,]*[.,][^.,]*)[.,].*$/,"$1"),+this.decimalPlaces||(t=t.replace(/[.,]/g,"")),t}minMaxValue(t){let e=parseFloat(t.replace(",","."));return Number.isNaN(e)||(e>this.max?t=this.max.toString():e<this.min&&(t=this.min.toString())),t}decimalPlacesValue(t){let e=t.split(/[.,]/);return e[1]&&e[1].length>this.decimalPlaces&&(t=t.replace(new RegExp(`([.,]\\d{${this.decimalPlaces}})\\d*`),"$1")),t}setEvents(){this.$input.on("input",t=>{let e=t.currentTarget,i=e.value;i=this.onlyNumber(i),i=this.decimalPlacesValue(i),e.value=i}),this.$input.on("blur",t=>{let e=t.currentTarget,i=e.value;e.value=this.minMaxValue(i)})}};function ue({$field:r,selector:t,attribute:e,attrValue:i}){let s=r.attr("data-default-value");if(s){let a=r.find(t);!isNaN(Number(s))&&Number(s)<=a.length?(a.removeAttr(e),a.eq(Number(s)-1).attr(e,i)):a.each((n,o)=>{let l=$(o);l.val()===s&&(a.removeAttr(e),l.attr(e,i))})}}var Yt=class extends Error{constructor(...t){super(...t),this.data=null,this.response=null,this.name="FormError"}},Gt=class extends Error{constructor(...t){super(...t),this.name="NetworkError",this.data=null,this.response=null}},ct={},Fe={hash:0,abortPrev:!1,dataType:"json",contentType:"application/x-www-form-urlencoded",asJson:!1,data:{}},pe={codes:{0:"main::error::network",401:"main::error::not_authorized",404:"main::error::page_not_found"},statuses:{parsererror:"main::error::incorrect_answer",error:"main::error::unknown",abort:""}};async function Te(r,t){return async function(e,i,s){e=e?String(e).trim().toUpperCase():"POST";let a={...Fe,...s,url:i,type:e};a.asJson&&typeof a.data=="object"&&(a.data=JSON.stringify(a.data)),a.data&&typeof a.data=="string"&&(a.contentType="application/json");let n=`${i}:${a.hash||0}`;return a.abortPrev&&function(o){try{if(o){let l=ct[o];typeof l=="number"&&clearTimeout(l),typeof l=="object"&&(l.abort(),delete ct[o])}else Object.values(ct).forEach(l=>{typeof l=="object"&&l.abort()}),ct={}}catch{}}(n),new Promise((o,l)=>{function d({payload:u}){return o(u)}function h({response:u,payload:f={},statusCode:g,statusText:c="error"}){let p,m=f.message||f.error||f.detail;return typeof m=="object"&&m.message!=null&&(m=m.message),m||(m=pe.codes[g]||pe.statuses[c]),g===401&&(window.location.href=`${flexbe.vars.app.url}/login/`),f.violations&&Array.isArray(f.violations)?(p=new Yt(tr(m)),f.violations=f.violations.map(v=>({...v,name:v.propertyPath.replace(/\[(\w*)]/g,".$1").slice(1)}))):p=new Gt(tr(m)),p.response=u,p.data=f,l(p)}ct[n]=$.ajax(a).done((u,f,g)=>{var c;let p=g.status,m=f||g.statusText;(c=u?.status)==null||c?d({payload:u}):h({response:g,payload:u,statusCode:p,statusText:m})}).fail((u,f)=>{let g=u.status,c=f||u.statusText,p=u.responseJSON;c!=="abort"&&h({response:u,payload:p,statusCode:g,statusText:c})})})}("GET",r,t)}var Kt=class{constructor({$component:t,id:e}){this.$component=void 0,this.shippingStore=flexbe_cli.ecommerce.shippingStore,this.cartStore=flexbe_cli.ecommerce.cartStore,this.promotionStore=flexbe_cli.ecommerce.promotionStore,this.id=void 0,this.$shipping=void 0,this.addressMeta=void 0,this.$addressFields=void 0,this.$component=t,this.id=e,this.$shipping=this.$component.find('[data-type="shipping"]'),this.$shipping.length&&(this.addressMeta=null,this.$addressFields={},this.init())}init(){this.setupScrollHandlers(),this.setupAddressFields(),this.setupShippingMethods(),this.onSelectMethod(),this.onUpdatePrices(),this.updateScrollClasses(),this.updateShippingAddress(),this.updateShippingSwitchVisibility(),this.updateAddressFieldsConfig(),this.setupEventListeners()}setupScrollHandlers(){this.$shipping.find(".form-field-shipping-inner").on("scroll",this.updateScrollClasses.bind(this))}updateScrollClasses(t){(t?$(t.target).closest(".form-field-shipping-inner"):this.$shipping.find(".form-field-shipping-inner")).each((e,i)=>{let s=$(i),a=s.closest(".form-field-shipping-wrap"),n=Math.round(s.scrollTop()),o=i.scrollHeight,l=i.clientHeight;a.removeClass("scroll-up scroll-down"),n>0&&a.addClass("scroll-up"),n<o-l&&a.addClass("scroll-down")})}setupAddressFields(){this.$addressFields={country:this.$shipping.find('[data-field-id="country"] select').eq(0),addressLine1:this.$shipping.find('[data-field-id="addressLine1"] input[name*=value]').eq(0),addressLine2:this.$shipping.find('[data-field-id="addressLine2"] input[name*=value]').eq(0),city:this.$shipping.find('[data-field-id="city"] input[name*=value]').eq(0),region:this.$shipping.find('[data-field-id="region"] input[name*=value]').eq(0),regionRow:this.$shipping.find(".region-field-row").eq(0),state:this.$shipping.find('[data-field-id="state"] select').eq(0),stateRow:this.$shipping.find(".state-field-row").eq(0),zipCode:this.$shipping.find('[data-field-id="zipCode"] input[name*=value]').eq(0)},this.$addressFields.country.on("change",()=>{this.updateCountriesAndStates(),this.updateShippingAddress()}),this.$shipping.on("input change",".form-field-address input, .form-field-address select",()=>this.updateShippingAddress())}setupShippingMethods(){let t=this.shippingStore;this.$shipping.on("change",".form-field-switch input[type=radio]",e=>{let i=e.target;t.dispatch("selectType",i.value),this.scrollToActiveMethod(!1)}),this.$shipping.on("change",".form-field-shipping-item input[type=radio]",e=>{let i=e.currentTarget;if(i.checked){var s;let a=(s=i.closest("[data-shipping]"))==null?void 0:s.getAttribute("data-shipping");a&&t.dispatch("selectMethod",a)}})}setupEventListeners(){setTimeout(()=>{this.shippingStore&&this.shippingStore.on(`dispatch.form-component-${this.id}`,({name:t})=>{t==="selectMethod"&&this.onSelectMethod()}),this.cartStore&&this.cartStore.on(`dispatch.form-component-${this.id}`,()=>{this.onUpdatePrices()}),this.promotionStore&&this.promotionStore.on(`dispatch.form-component-${this.id}`,()=>{this.onUpdatePrices()})},10)}async updateCountriesAndStates(){var t;let e=this.shippingStore,i=e.activeMethod,s=this.$addressFields.country.closest(".form-field"),a=this.$addressFields.state.closest(".form-field"),n=this.$shipping.find(".form-field-shipping-item__address");if(s.addClass("loading"),a.addClass("loading"),n.addClass("loading"),await this.loadAddressMeta(),e.getList("pickup").forEach(c=>{var p,m;let v=this.$shipping.find(`.form-field-shipping-item[data-shipping="${c.id}"] .form-field-shipping-item__address`),C=((S,{countriesList:F=[],statesList:y=[]}={})=>{var N,x;let{addressLine1:b,addressLine2:E,country:T,city:rt,region:ft,zipCode:tt}=S||{},et=((N=F.find(V=>V.value===T))==null?void 0:N.title)||T,H=T==="US"&&((x=y.find(V=>V.value===ft))==null?void 0:x.title)||ft,it=[];switch(T){case"RU":case"EN":default:it=[b,E,rt,H,tt,et];break;case"US":it=[b,E,rt,`${H}${tt?` ${tt}`:""}`,et];break;case"DE":case"FR":it=[`${tt} ${rt}`,b,E,H,et]}return it.filter(V=>V&&V.trim().length>0).join(", ")})(c.address,{countriesList:((p=this.addressMeta)==null?void 0:p.countries)||[],statesList:((m=this.addressMeta)==null?void 0:m.states)||[]});v.text(C)}),n.removeClass("loading"),!i)return;let o=i.isInternationalDelivery,l=this.$addressFields.country.val(),d=!this.$addressFields.country.prop("disabled"),h=o?i.availableCountry:[flexbe_cli.vars.site.country],u=(((t=this.addressMeta)==null?void 0:t.countries)||[]).filter(c=>!h.length||h.includes(c.value)).map(c=>({value:c.value,label:c.title}));if(d){if(jt(this.$addressFields.country[0],u),!l||!u.some(c=>c.value===l)){let c=flexbe_cli.vars.site.country;c&&u.some(p=>p.value===c)?this.$addressFields.country.val(c):u.length>0&&this.$addressFields.country.val(u[0].value)}this.$addressFields.country.trigger("syncSelectUI"),s.removeClass("loading")}let f=o&&l==="US"||flexbe_cli.vars.site.country==="US";if(this.updateAddressFieldsConfig(),f){var g;let c=(((g=this.addressMeta)==null?void 0:g.states)||[]).map(p=>({value:p.value,label:p.title}));jt(this.$addressFields.state[0],c),this.$addressFields.state.trigger("syncSelectUI")}a.removeClass("loading")}async loadAddressMeta(){if(this.addressMeta)return;let t=await Te(`/mod/metadata/?filter=country,state&language=${flexbe_cli.vars.page.language}`);t&&(this.addressMeta=t)}updateShippingAddress(){let t=this.shippingStore,e={country:this.$addressFields.country.val(),addressLine1:this.$addressFields.addressLine1.val(),addressLine2:this.$addressFields.addressLine2.val(),city:this.$addressFields.city.val(),region:this.$addressFields.region.val(),state:this.$addressFields.state.val(),zipCode:this.$addressFields.zipCode.val()};t.dispatch("setAddress",e)}updateShippingSwitchVisibility(){let t=this.shippingStore,e=t.getList("delivery").length>0,i=t.getList("pickup").length>0;this.$shipping.find('[data-field-id="shipping-type"]').toggle(e&&i)}updateShippingList(){let t=this.shippingStore.activeType,e=this.$shipping.find(".form-field-shipping-wrap"),i=e.filter(`[data-shipping-type="${t}"]`);e.hide(),i.show()}scrollToActiveMethod(t=!0){let e=this.shippingStore.activeMethod;if(!e)return;let i=this.$shipping.find(".form-field-shipping-item").filter(`[data-shipping="${e.id}"]`),s=i.closest(".form-field-shipping-inner")[0];if(s){let a=i[0].getBoundingClientRect().top-s.getBoundingClientRect().top+s.scrollTop-40;s.scrollTo({top:a,behavior:t?"smooth":"auto"})}}syncSwitch(){let t=this.shippingStore.activeType,e=this.$shipping.find(".form-field-switch input[type=radio]"),i=e.filter(`[value="${t}"]`);i.length&&(e.prop("checked",!1),i.prop("checked",!0)),this.updateShippingList()}updateAddressFieldsConfig(){var t,e,i,s,a,n,o,l,d,h,u,f,g,c,p,m,v,C,S,F,y,N;let x=this.shippingStore.activeMethod,b=x.addressFieldsConfig,E=x?.isInternationalDelivery,T=E&&this.$addressFields.country.val()==="US"||flexbe_cli.vars.site.country==="US",rt={addressLine1:{show:(t=b==null||(e=b.addressLine1)==null?void 0:e.show)==null||t,required:(i=b==null||(s=b.addressLine1)==null?void 0:s.required)==null||i},addressLine2:{show:(a=b==null||(n=b.addressLine2)==null?void 0:n.show)!=null&&a,required:(o=b==null||(l=b.addressLine2)==null?void 0:l.required)!=null&&o},country:{show:E||(b==null||(d=b.country)==null?void 0:d.show)||!1,required:E||(b==null||(h=b.country)==null?void 0:h.required)||!1},state:{show:T&&((b==null||(u=b.region)==null?void 0:u.show)||!1),required:T&&((b==null||(f=b.region)==null?void 0:f.required)||!1)},region:{show:!T&&((b==null||(g=b.region)==null?void 0:g.show)||!1),required:!T&&((b==null||(c=b.region)==null?void 0:c.required)||!1)},city:{show:(p=b==null||(m=b.city)==null?void 0:m.show)!=null&&p,required:(v=b==null||(C=b.city)==null?void 0:C.required)!=null&&v},zipCode:{show:(S=b==null||(F=b.zipCode)==null?void 0:F.show)!=null&&S,required:(y=b==null||(N=b.zipCode)==null?void 0:N.required)!=null&&y}};Object.entries(rt).forEach(([ft,{show:tt,required:et}])=>{let H=this.$shipping.find(`[data-field-id="${ft}"]`),it=H.closest(".form-field-address__row:not(.form-field-address__row--multiple)"),V=H.find(".form-field-title"),It=!tt||!(x!=null&&x.deliveryAddressEnabled);it.attr("data-hidden",It?"true":null),H.attr("data-hidden",It?"true":null),H.find("input, select, textarea").prop("required",et).attr("disabled",It?"disabled":null);let fe=V.text().replace("*","").trim();V.text(fe+(et?" *":""))})}onSelectMethod(){let t=this.shippingStore.activeMethod;if(!t)return;let e=this.$shipping,i=e.find(".form-field-shipping-item"),s=e.find(".form-field-shipping-fields"),a=i.filter(`[data-shipping="${t.id}"]`),n=s.filter(`[data-shipping="${t.id}"]`),o=e.find('[data-type="address"]');i.removeClass("form-field-shipping-item--active"),a.addClass("form-field-shipping-item--active"),s.removeClass("form-field-shipping-fields--active"),n.addClass("form-field-shipping-fields--active"),s.find("input, textarea, select").prop("disabled",!0),n.find("input, textarea, select").prop("disabled",!1),i.find("input[type=radio]").prop("checked",!1),a.find("input[type=radio]").prop("checked",!0),o.toggleClass("form-field--hidden",!t.deliveryAddressEnabled),o.find("input, textarea, select").prop("disabled",!t.deliveryAddressEnabled),this.scrollToActiveMethod(),this.updateCountriesAndStates(),this.updateAddressFieldsConfig(),this.syncSwitch()}onUpdatePrices(){let t=this.shippingStore;this.$shipping.find(".form-field-shipping-item").each((e,i)=>{let s=i.getAttribute("data-shipping"),a=$(i),n=a.find(".item-price"),o=a.find(".delimiter"),l=a.find(".form-field-shipping-item__min-total"),d=a.find(".min-total"),h=t.getPrice(s);if(h.notHasFree||h.untilFree&&h.notFixedPrice?(n.text(""),o.text("")):(n.text(h.currentFormatted),o.text("\u2013")),h.minTotal){let u=`${flexbe_cli.locale.tr("form::delivery_min_total_tip",{sum:h.minTotalFormatted})}`;d.text(u),l.show()}else l.hide()})}},St=class extends _{constructor(...t){super(...t),this.id=this.core.id,this.eventId=`.${this.id}`,this.busy=!1,this.submitDisabled=!1,this.products=null,this.paymentData=null,this.formInited=!1,this.$form=this.$component.is("form")?this.$component:this.$component.find("form"),this.$formSubmit=this.$component.find(".form-submit"),this.$button=this.$formSubmit.find(".component-button"),this.$minSumContainer=this.$formSubmit.find(".cart-min-sum-text"),this.$fields=this.$component.find(".form-fields"),this.action=this.$component.find('input[name="action"]').val(),this.payProducts=this.$component.find('input[name="products"]').val(),this.isInline=this.$component.attr("data-inline")?1:0,this.inCart=this.$component.closest(".w_widget").length>0,this.inModal=this.$component.closest(".m_modal").length>0,this.elementId=this.inCart?this.$component.parents(".w_widget").attr("data-id"):this.$component.parents(".element-item").attr("data-id"),this.$masked=this.$component.find("[data-mask]"),this.$calendars=this.$component.find(".form-field-date__input"),this.$file=this.$component.find(".file-input-outer"),this.$file.length&&(this.$itemTemplateFile=this.$itemTemplateFile||this.$file.find("template").clone()),this.$masked.length&&(this.hasMaskedField=!0,this.require.push("/_s/lib/imask/imask.min.js?v1")),this.$calendars.length&&(this.hasCalendarField=!0,this.require.push("/_s/lib/scroll-lock/scroll-lock.min.js"),this.require.push("/_s/lib/calendar/dist/js/calendar.js?v2.3.13","/_s/lib/calendar/dist/css/calendar.min.css?v2.3.5"))}onLoad(){(this.core.wasScreen||this.core.wasBeside)&&(this.hasMaskedField&&this.inputMask(),this.hasCalendarField&&this.inputDate())}onScreen({state:t}){if(!t)return!1;this.formInit()}onBeside({state:t}){if(!t)return!1;this.formInit()}onOpen(t={}){let{top:e}=this.component.getBoundingClientRect();!flexbe_cli.run.is_screen_mobile&&flexbe_cli.run.is_preview&&flexbe_cli.resize.viewportHeight>e+100&&this.$component.find(".form-field").eq(0).find("input, textarea").eq(0).focus(),t&&t.data&&this.setData(t.data)}onResize(){this.$component.find(".range-outer").trigger("resize")}formInit(){if(this.formInited)return!1;this.formInited=!0,this.$form.attr("action",`/mod/project/${flexbe_cli.group_id}/lead/send/`),this.unbindEvents(),this.bindEvents(),this.initCaptcha(),this.customize()}customize(){this.fileInput(),this.customSelect(),this.textResize(),this.inputRange(),this.inputNumber(),this.shippingField(),this.defaultValue(),this.hasMaskedField&&this.isLoaded&&this.inputMask(),this.hasCalendarField&&this.isLoaded&&this.inputDate(),this.$component.find(".form-field-range").trigger("resize")}unbindEvents(){this.$component.off(this.eventId),this.$form.off(this.eventId)}bindEvents(){let t=this.$component.find('.form-field-text__input, .form-field-text__textarea, input[type="checkbox"], input[type="radio"]'),e=this.$component.closest(".scroller");t.on(`keydown${this.eventId}`,i=>{let s=i.key||"",a=s==="Enter",n=i.ctrlKey||i.metaKey,o=i.currentTarget,l=o.getAttribute("data-check");if(a){if(o.tagName==="TEXTAREA")return;i.preventDefault();let d=t.index(i.currentTarget),h=t.eq(d+1);h.length?h.trigger("focus"):this.$form.trigger("submit")}return!(l==="phone"&&!o._mask&&!n&&s.length===1&&/[^\d ()+-]/.test(s))&&(l!=="email"||!/[\s,]/.test(s))&&void 0}),t.on(`input${this.eventId} change${this.eventId}`,i=>{let s=i.currentTarget,a=$(s);a.attr("value",s.value),a.closest(".is_error").removeClass("is_error")}),this.hasCalendarField&&(this.inModal||this.inCart)&&setTimeout(()=>{let i=this.$calendars.toArray().map(s=>$(s).data("calendar")).filter(s=>s);e.on(`scroll${this.eventId}`,()=>{i.forEach(s=>s.main.toPosition())})},150),this.$formSubmit.find('button[type="button"]').on(`click${this.eventId}`,()=>{this.$form.trigger("submit")}),this.$form.off("submit").on(`submit${this.eventId}`,i=>((async()=>{if(typeof this.beforeSend=="function"&&await this.beforeSend()===!1)return!1;try{await this.sendForm()}catch(s){alert(s.message)}})(),i.preventDefault(),i.stopPropagation(),!1))}setData(t){if(!t)return!1;t&&t.fields&&this.addFields(t.fields),t&&t.items&&this.addItems(t.items)}defineBeforeSend(t){typeof t=="function"&&(this.beforeSend=t)}defineAfterSent(t){typeof t=="function"&&(this.afterSent=t)}defineOnRequestError(t){typeof t=="function"&&(this.onRequestError=t)}addFields(t,e=!0){let i=this.$component.find(".form-fields-advanced");t.length&&i[0]&&(e&&this.resetFields(),t.forEach(s=>{i.find(`input[name="${s.name}"]`).remove();let a=$("<input>").attr("type",s.type).attr("name",s.name).attr("value",s.value);i.append(a)}))}resetFields(){let t=this.$component.find(".form-fields-advanced");t[0]&&t.empty()}addItems(t=[]){if(!t||!t.length)return void(this.products=null);let e=0;t=t.map(i=>{var s;return typeof i!="object"?{}:(i.price=i.price==null?null:parseFloat(i.price)||0,i.title=typeof i.title=="string"&&i.title.trim()||i.title||"",e+=((s=i.price)!=null?s:0)*i.count||0,i)}),this.products=t||[],e&&(this.pays={price:e,desc:""})}async sendForm(t){if(this.submitDisabled)return void setTimeout(()=>{this.$formSubmit.addClass("shake"),setTimeout(()=>{this.$formSubmit.removeClass("shake")},500)},30);if(this.busy||!this.validateForm())return!1;this.captcha&&t&&this.captcha.reset();let e=this.captcha&&this.captcha.getToken();if(this.captcha&&this.captcha.enabled&&!this.captcha.isOptional&&!e){if(this.captcha.inModal)return void this.captchaModalRun();if(this.captcha.isInvisible)return void this.captchaInvisibleRun()}this.addSubmitting();let i=new FormData(this.$form.get(0)),s=i.get("id");if(i.append("is_ajax","true"),s.includes("cart_")||i.append("forceUpdateProduct","true"),i.delete("products"),this.products)i.append("products",JSON.stringify(this.products));else if(this.action==="pay"&&this.payProducts){let d,h=JSON.parse(this.payProducts);if(h=Array.isArray(h)?h[0]:h,h.productId){let u=flexbe_cli.ecommerce.productsStore.getProduct(h.productId);if(u){let f=u.currentVariant(h.variantId).getCartData("image");f.img=J(f.img[0]),d=[{...f,count:1,strict:h.strict,id:`product_${h.productId}:${h.variantId||"default"}`}]}}else h.title&&(d=[{id:`${flexbe_cli.p_id}_${flexbe_cli.s_id}`,title:h.title,img:h.img&&J(h.img),price:h.price==null?null:parseFloat(h.price)||0,count:1}]);d&&i.append("products",JSON.stringify(d)),this.pays={price:h.price,desc:h.title}}i.append("jsform",JSON.stringify(parseInt(448312,10))),i.append("pageId",flexbe_cli.p_id),flexbe_cli.stat.u_id&&i.append("userId",flexbe_cli.stat.u_id),i.append("utmData",JSON.stringify(flexbe_cli.utm.data)),"roistat"in window&&i.append("roistatVisit",window.roistat.visit);let a=flexbe_cli.stat.AB.getCookie();i.append("abTest",JSON.stringify(a)),i.delete("g-recaptcha-response"),i.delete("goal"),i.delete("goal_html"),i.delete("fileOriginal"),e&&i.append("captcha-token",e);let n=[];for(let[d,h]of i.entries()){let u=/.*address\]*\[.+]\[/.test(d),f=u?d.match(/^(.+)\[value\]$/):null;if(f){let c=f[1];c==="shipping[address][state]"?i.append("shipping[address][region]",h):i.append(c,h)}let g=d.match(/^shipping\[fields\]\[([^\]]+)\]\[type\]$/);if(g&&h==="shipping"){let c=g[1];n.push(`shipping[fields][${c}][value]`),n.push(`shipping[fields][${c}][id]`),n.push(`shipping[fields][${c}][type]`),n.push(`shipping[fields][${c}][name]`)}(d.startsWith("shipping[shipping-type]")||u)&&n.push(d)}flexbe_cli.run.is_OSX&&typeof i.entries=="function"&&i.forEach((d,h)=>{typeof d=="object"&&d instanceof File&&d.size===0&&typeof i.delete=="function"&&n.push(h)}),n.forEach(d=>i.delete(d));let o=this.$form.attr("action"),l={type:"POST",dataType:"json",processData:!1,contentType:!1,data:i};try{let d=await flexbe_cli.helpers.fetch(o,l);d.pay!=null&&(this.paymentData=d.pay),this.showDone(i,d),this.captchaRemoveError(),this.action!=="redirect"&&this.clearSubmitting(!0)}catch(d){let h=d.data;if(h&&h.captcha){if(this.captcha)e?this.captchaAddError():this.captcha.inModal?this.captchaModalRun():this.captcha.isInvisible&&(this.captcha.isOptional=!1,this.captchaInvisibleRun());else{let u=h.captcha==="visible";await this.initCaptcha({...M.getRecaptchaSettings(),enabled:!0,visible:u,ttl:1}),u?this.captchaModalRun():(this.captcha.isOptional=!1,this.captchaInvisibleRun())}return}await this.sendFormError(d)}}async sendFormError(t){this.clearSubmitting(),console.error("sendForm error: ",t),typeof this.onRequestError=="function"?await this.onRequestError(t,this):t.status&&t.status===500&&alert("Network error")}addSubmitting(){this.busy=+Date.now(),this.$component.addClass("submitting"),this.$button.addClass("submitting")}clearSubmitting(t=!1){this.busy&&(this.$component.removeClass("submitting"),this.$button.removeClass("submitting"),t?(this.$component.addClass("success"),this.$button.addClass("success"),this.$component.find(".file-list").empty(),this.$component.find("input.value").remove(),setTimeout(()=>{this.busy=!1,this.$component.removeClass("success"),this.$button.removeClass("success")},1e3)):this.busy=!1)}showDone(t,e={}){let i=xt(t,{leadId:e.lead_id,pays:e.pay}),s={leadId:e.lead_id,formData:i};if(typeof this.afterSent=="function"&&this.afterSent(),flexbe_cli.stat.reachGoals({mainGoal:flexbe_cli.stat.getGoal("order_done"),goal:this.$component.find('input[name="goal"]').val(),htmlGoal:this.$component.find('textarea[name="goal_html"]').val()},s),this.action==="pay")if(this.paymentData!==void 0&&this.paymentData!==null){if(this.paymentData.pay_link.length>0){let n=`${window.location.origin+window.location.pathname+(window.location.search?`${window.location.search}&`:"?")}pay_id=${this.paymentData.pay_id}&h=${this.paymentData.pay_hash}`;try{window.history.pushState(null,null,n),setTimeout(()=>{flexbe_cli.events.trigger("pay",{action:"init"})},200)}catch{setTimeout(()=>{document.location=n},500)}}}else window.location.hash="pay",flexbe_cli.events.trigger("pay",{action:"success",withoutPay:!0});else if(this.action==="redirect"){let n=this.$component.find('input[name="action_redirect"]'),o;n&&n.length&&(o=n.val()),o&&setTimeout(()=>{flexbe_cli.helpers.gotoLink(o),this.clearSubmitting(!0)},500)}else if(this.action==="code"){if(!flexbe_cli.run.is_preview)return;(async o=>{let l=this.$component.data("code")||"";await new(Object.getPrototypeOf(async()=>{})).constructor("formData",l)(o)})(i).catch(o=>{console.error("Error executing action code:",o)})}else{let n=this.$component.find("[data-modal-id]").attr("data-modal-id");/^(form|done)$/.test(n)&&!flexbe_cli.modal.find(n)&&(n=`${String(this.id).split("_")[0]}_${n}`),flexbe_cli.events.trigger("ui_modal_open",{id:n})}let a=new Event("submitted",{bubbles:!0});this.$form.get(0).dispatchEvent(a),this.resetForm()}resetForm(){this.$component.find(".file-input-outer").removeClass("active");let t=this.$fields.find("input, textarea, select"),e=t.not("select").not('[type="hidden"]').not(".form-field-range__input").not(".g-recaptcha-response"),i=t.filter("select"),s=t.filter(".form-field-range__input");i.each((a,n)=>{let o=n.querySelector("option"),l=o&&o.value||"";n.value!==l&&(n.value=l,n.dispatchEvent(new Event("change",{bubbles:!0,cancelable:!0})))}),s.each((a,n)=>{n.value=n.getAttribute("data-value"),n.dispatchEvent(new Event("change",{bubbles:!0,cancelable:!0}))}),e.each((a,n)=>{let o=n.defaultChecked;if(["radio","checkbox"].includes(n.type))o?n.setAttribute("checked",!0):n.removeAttribute("checked"),n.checked=o;else{n.removeAttribute("value"),n.value="",n.removeAttribute("data-mask-complete");let l=n._mask;l&&l.updateValue()}n.dispatchEvent(new Event("change",{bubbles:!0,cancelable:!0}))}),this.captcha&&this.captcha.enabled&&(this.captcha.reset(),this.captchaRemoveError()),this.paymentData=null,yt(),this.$form.get(0).reset(),this.resetFields()}validateForm(){let t=!0,e=!0,i=!0;this.removeFieldsErrors();let s=this.$component.find(".policy-data-warning--checkbox"),a=s.find("input")[0];a&&!a.checked&&(t=!1,s.addClass("is_error")),this.$component.find(".form-field[data-type]:not([data-hidden])").each((o,l)=>{let d,h=$(l),u=h.find("input, textarea, select").not('[type="hidden"]'),f=u[0],g=h.attr("data-type");if(!f&&g!=="captcha")return;let c=f.type,p=c==="file"?h.find("input.value"):f.value;if(["radio","checkbox"].includes(c)&&(p=u.toArray().some(m=>m.checked)),g==="captcha"){if(!this.captcha)return;d=!this.captcha.getToken()&&flexbe_cli.locale.tr("form::captcha_not_checked")}else d=this.checkField(h,u);if(d){h.attr("data-type");let m=h.find(".error");h.outerWidth(),h.addClass("is_error"),m.length&&(m.attr("title",d),m.find(".error-text").text(d)),e=!1}i&&p&&g!=="captcha"&&(i=!1)}),this.$fields.removeClass("all-fields-empty"),this.$fields.outerWidth(),e||this.$fields.addClass("has-error");let n=this.$component.find(".is_error");return n.addClass("animate"),setTimeout(()=>{n.removeClass("animate")},500),i&&(this.$fields.toggleClass("all-fields-empty",i),e=!1),e&&t}checkField(t,e){let i=e[0];if(i.disabled||i.hidden)return!1;let s=i.type,a=s==="file"?t.find("input.value"):i.value;["radio","checkbox"].includes(s)&&(a=e.toArray().some(d=>d.checked));let n=i.required,o=i.getAttribute("data-check")||!1,l=!(!n||a)&&"form::required";if(i._mask&&i.getAttribute("data-mask"))!n&&!a||i.getAttribute("data-mask-complete")||(l=s==="tel"&&a?"form::phone":s==="text"&&a?"form::text":"form::required");else if(o)if(o==="date"||o==="datetime"){let d=$(i).data("calendar"),h=d&&d.input.checkError();h&&(l=h)}else a.length&&s==="email"?/^(([^\s"(),.:;<>@[\\\]]+(\.[^\s"(),.:;<>@[\\\]]+)*)|(".+"))@((\[(?:\d{1,3}\.){3}\d{1,3}])|(([\wЁА-яё-]+\.)+[A-Za-zЁА-яё]{2,}))$/.test(a)||(l="form::email"):a.length&&s==="tel"?/[^\d\s()+-]/.test(a)?l="form::digits":a.replace(/\D/g,"").length<5&&(l="form::phone_minlength"):s==="file"&&(l=n&&!a.length?"form::required":!!t.hasClass("loading")&&"form::loading");return l=l&&flexbe_cli.locale.tr(l)||!1,l}removeFieldsErrors(){this.$fields.removeClass("has-error"),this.$component.find(".is_error").removeClass("is_error animate"),this.$fields.outerWidth()}disableSubmit(t){this.submitDisabled=!0,flexbe_cli.run.is_mobile?this.$minSumContainer.text(t):this.$formSubmit.attr("data-tip",t||""),this.$button.attr("disabled","disabled"),flexbe_cli.tip.init(this.$formSubmit)}enableSubmit(){this.submitDisabled=!1,flexbe_cli.run.is_mobile?this.$minSumContainer.empty():this.$formSubmit.removeAttr("data-tip"),this.$formSubmit.removeAttr("data-tip"),this.$button.removeAttr("disabled"),flexbe_cli.tip.destroy(this.$formSubmit)}async initCaptcha(t){return t==null&&(t=M.getRecaptchaSettings()),new Promise((e,i)=>{!this.captcha&&t.enabled&&(this.captcha=new M({id:this.id,$form:this.$component,inModal:this.isInline,onSuccess:s=>{this.captchaRemoveError(),this.clearSubmitting(),(s.inModal||s.isInvisible)&&this.sendForm()},onError:()=>{this.captchaAddError()}},t),flexbe_cli.require(`https://www.google.com/recaptcha/api.js?render=explicit&hl=${flexbe_cli.vars.site.language}`,()=>{let s=150,a=setInterval(()=>{s-=1,this.captcha.loaded?(this.captcha.init(),clearInterval(a),e()):s===0&&i(new Error("Can not load grecaptcha"))},10)}))})}captchaAddError(t){if(!this.captcha||!this.captcha.enabled)return;t==null&&(t=flexbe_cli.locale.tr("form::captcha_error"));let e=this.$component.find(".captcha-global-error");e.find(".error-text").text(t),e.addClass("show"),this.busy&&this.clearSubmitting()}captchaRemoveError(){if(!this.captcha||!this.captcha.enabled)return;let t=this.$component.find('.form-field[data-type="captcha"]'),e=this.$component.find(".captcha-global-error");t.removeClass("is_error"),e.removeClass("show")}captchaModalRun(){this.captcha&&this.captcha.enabled&&this.captcha.loaded&&this.captcha.runModalCaptcha()}captchaInvisibleRun(){if(!this.captcha||!this.captcha.enabled||!this.captcha.loaded||this.captcha.isVisible)return;this.addSubmitting(),this.captcha.runInvisibleChallenge();let t=this.busy;setTimeout(()=>{t===this.busy&&this.clearSubmitting()},2500)}fileInput(){var t;let e=this.$component,i=this.eventId,s=(t=this.$itemTemplateFile)==null?void 0:t.html();bt(e,i,s)}textResize(){this.$component.find(".autosize").each((t,e)=>{let i=e.offsetHeight-e.clientHeight,s=$(e),a=getComputedStyle(e),n=+s.attr("rows")||0,o=parseInt(a.borderTop,10)+parseInt(a.borderBottom,10),l=parseInt(a.paddingTop,10)+parseInt(a.paddingBottom,10),d=Math.round(+a.lineHeight.split("px")[0]);flexbe_cli.run.is_ios&&(d/=parseInt(a.textSizeAdjust||a.webkitTextSizeAdjust||"120%",10)/100),s.removeAttr("data-autoresize"),s.off(".autoresize").on("keyup.autoresize input.autoresize",function(h){let u=h.currentTarget;u.style.height=`${u.scrollHeight+i}px`}),s.css("minHeight",`${o+l+d*n}px`)})}customSelect(){this.$component.find(".dropdown-container").remove();let t=this.$component.find("select.atom-custom-select"),e={dropdownClass:this.$component.hasClass("style-underlined")?`sharp size--medium select-container-${this.elementId} `:`size--medium select-container-${this.elementId}`};t.each((i,s)=>{let a=$(s).closest('[data-type="select"]');ue({$field:a,selector:"option",attribute:"selected",attrValue:"selected"}),nt.create({element:s,config:e,onCollapse:()=>{a.removeClass("active")},onActivate:()=>{a.addClass("active"),a.siblings('[data-type="select"]').removeClass("active")}})})}shippingField(){this.shippingManager=new Kt({$component:this.$component,id:this.id})}inputRange(){this.$component.find(".form-field-range").each((t,e)=>new at($(e)))}inputNumber(){this.$component.find('[data-type="number"]').each((t,e)=>new Jt($(e)))}inputMask(){return typeof IMask<"u"&&(this.hasMaskedField=!1,this.$masked.each((t,e)=>{wt(e);let i=!!e.getAttribute("data-placeholder"),s=e._mask;i&&s&&($(e).on(`focus${this.eventId}`,()=>{s.updateOptions({lazy:!1})}),$(e).on(`blur${this.eventId}`,()=>{if(!s.unmaskedValue){let a=s.mask.replace(/\*/g,"_"),n=s.value;s.updateOptions({lazy:!0}),s.masked.rawInputValue&&a!==n||(s.unmaskedValue="",s.value="",s.updateValue())}}))}),!0)}inputDate(){this.hasCalendarField=!1;let t=this.$component.closest(".scroller")[0];return this.$calendars.each((e,i)=>{$t(i,t)}),!0}defaultValue(){(function(t){let e=t.find('[data-type="radio-radio"]'),i=t.find('[data-type="radio-checkbox"]');e.length&&e.each((s,a)=>{ue({$field:$(a),selector:'input[type="radio"]',attribute:"checked",attrValue:"checked"})}),i.length&&i.each((s,a)=>{let n=$(a),o=n.attr("data-default-value")||"",l=n.find("input.form-field-checkbox__input"),d=o.split(/[,;\s]+/).filter(h=>h!=="").map(h=>isNaN(Number(h))?h:Number(h));l.each((h,u)=>{let f=$(u),g=f.attr("value");(d.includes(g)||d.includes(h+1))&&f.attr("checked","checked")})})})(this.$component),this.$component.find('[data-type="checkbox"]').each((t,e)=>{let i=$(e).attr("data-default-value"),s=$(e).find("input.form-field-checkbox__input");["on",1,"1",!0,"true"].includes(i)&&s.attr("checked","checked"),["off",0,"0",!1,"false"].includes(i)&&s.removeAttr("checked")}),function(t){t.find('.form-field[data-type="phone"]:not([data-hidden])').each((e,i)=>{let s=$(i).find("input").not('[type="hidden"]'),a=s[0];if(!s[0])return;let n=$(a).val();$(a).val(n.replace(/[^0-9+\-_()]/g,""))})}(this.$component)}};St.is="form";var At=class extends St{};flexbe_cli.entity.setClientJs("element","form01",{isPure:!0,components:[At]});var Z=class extends Y{};Z.is="button";flexbe_cli.entity.setClientJs("element","header_button",{components:[Z,D],isPure:!0});flexbe_cli.entity.setClientJs("element","header_divider",{isPure:!0});flexbe_cli.entity.setClientJs("element","header_logo",{isPure:!0});flexbe_cli.entity.setClientJs("element","header_social",{isPure:!0});flexbe_cli.entity.setClientJs("element","header_text",{isPure:!0});flexbe_cli.entity.setClientJs("element","hr01",{isPure:!0});flexbe_cli.entity.setClientJs("element","icon01",{components:[D],isPure:!0});flexbe_cli.entity.setClientJs("element","logo01",{isPure:!0});var me=({lang:r,provider:t})=>{r=r||flexbe_cli.vars.page.language;let e={yandex:{ru:"ru_RU",be:"ru_RU",ka:"ru_RU",kk:"ru_RU",default:"en_US"},google:{ru:"ru",be:"be",ka:"ru",kk:"kk",uk:"uk",fr:"fr",pl:"pl",de:"de",es:"es",it:"it",default:"en"}};return!!e[t]&&(e[t][r]||e[t].default)},ut=class extends _{constructor(...t){super(...t),this.mapScripts=[],this.mapScriptsLoaded=!1,this.data=this.$component.data("data"),this.$component.removeAttr("data-data")}onInit(){this.isUpdated&&this.mapScriptsLoaded&&this.createMap()}async onBeside({state:t}){if(!t||this.isCreated||this.isLoading)return!1;await this.loadMapScripts(),this.createMap()}onOpen(){this.isCreated&&this.fitToViewport()}onResize(){this.isCreated&&this.fitToViewport()}async loadMapScripts(){return this.isLoading=!0,new Promise(t=>flexbe_cli.require(this.mapScripts,()=>{this.isLoading=!1,this.mapScriptsLoaded=!0,t()}))}createMap(){this.isCreated=!0}fitToViewport(){}};ut.is="map";var Xt=class extends ut{constructor(...t){super(...t);let e=flexbe_cli.vars.site.googleMapsKey,i=me({provider:"google"})||"en";this.mapScripts=[`https://maps.googleapis.com/maps/api/js?key=${e}&language=${i}`]}createMap(){typeof google<"u"&&(super.createMap(),this.createVendor(),this.styleMap(),this.setPlaces(),this.dispatchEvents(),this.fixBehavior(),this.$component.trigger("mapInit"),this.$component.removeClass("loading"))}createVendor(){let{data:t}=this,e=t.mapType||"map",i={map:google.maps.MapTypeId.ROADMAP,satellite:google.maps.MapTypeId.SATELLITE,hybrid:google.maps.MapTypeId.HYBRID};this.map=new google.maps.Map(this.$component.find(".map")[0],{center:{lat:t.center[0],lng:t.center[1]},zoom:t.zoom,disableDefaultUI:!0,panControl:!0,zoomControl:!0,fullscreenControl:!0,mapTypeControl:!1,streetViewControl:!1,mapTypeId:i[e],scrollwheel:!1})}dispatchEvents(){let{$component:t,map:e}=this,i=!1;e&&(t.on("selectMark",(s,a)=>{this.selectMark(a,!0)}),this.$component.on("mousedown",()=>{i=!0,this.$component.trigger("preventSliderMove",{state:!0}),this.$component.trigger("reduceSliderControls",{state:!0})}),$(window).on("mouseup",()=>{i&&(this.$component.trigger("preventSliderMove",{state:!1}),this.$component.trigger("reduceSliderControls",{state:!1}),i=!1)}))}fitToViewport(){let{map:t}=this;t&&google.maps.event.trigger(t,"resize")}setPlaces(){let{data:t,map:e}=this;e&&t.places.forEach((i,s)=>{let a=`<svg width="32" height="48" viewBox="0 0 24 32" xmlns="http://www.w3.org/2000/svg"><path d="M12 0C5.36 0 0 5.36 0 12c0 8 12 20 12 20s12-12 12-20c0-6.64-5.36-12-12-12zm0 8a4 4 0 0 1 4 4c0 2.22-1.78 4-4 4a4 4 0 0 1-4-4c0-2.2 1.8-4 4-4z" fill="${i.color||"#222"}" fill-rule="evenodd"/></svg>`,n=new google.maps.Marker({position:{lat:i.coords[0],lng:i.coords[1]},map:e,visible:!0,animation:google.maps.Animation.DROP,icon:{url:`data:image/svg+xml;charset=UTF-8,${encodeURIComponent(a)}`}});i._mark=n,n.addListener("click",()=>{this.selectMark(s)})})}styleMap(){let{data:t,map:e}=this;if(e)if(!t.style||/default|inherit/.test(t.style))e.setOptions({styles:[]});else{let i=`/_s/lib/google/maps/styles/${t.style}.json`;$.getJSON(i,s=>{s&&Array.isArray(s)&&e.setOptions({styles:s})})}}selectMark(t,e=!1){let{data:i,map:s}=this,{places:a}=i;if(!(s&&a&&a.length&&a[t]))return;a.forEach(l=>l._info&&l._info.close());let n=a[t],o="";n.name&&(o+=`<div style="margin-bottom: 3px;"><strong>${n.name}</strong></div>`),n.address&&(o+=`<div>${n.address}</div>`),n._info=new google.maps.InfoWindow({content:o}),n._info.open(s,n._mark),e&&s.panTo({lat:n.coords[0],lng:n.coords[1]}),this.$component.trigger("balloonOpen",t,n)}fixBehavior(){let{$component:t,map:e}=this;if(!e)return;let i;t.off("mouseenter.preventzoom").on("mouseenter.preventzoom",()=>{i=setTimeout(()=>{e.setOptions({scrollwheel:!0})},500)}),t.off("mouseleave.preventzoom").on("mouseleave.preventzoom",()=>{i&&(clearTimeout(i),e.setOptions({scrollwheel:!1}))})}},Qt=class extends ut{constructor(...t){super(...t);let e=me({provider:"yandex"})||"ru_RU",i=flexbe_cli.vars.site.yandexMapsKey?`&apikey=${flexbe_cli.vars.site.yandexMapsKey}`:"";this.mapScripts=[`https://api-maps.yandex.ru/2.1/?lang=${e}${i}`]}fitToViewport(){let{map:t}=this;t&&t.container.fitToViewport()}createMap(){typeof ymaps<"u"&&(super.createMap(),ymaps.ready(()=>{this.createVendor(),this.setPlaces(),this.dispatchEvents(),this.fixBehavior(),this.$component.trigger("mapInit"),this.$component.removeClass("loading")}))}createVendor(){this.map&&this.map.destroy();let t=this.data,e=t.mapType||"map";this.map=new ymaps.Map(this.$component.find(".map")[0],{center:t.center,zoom:t.zoom,controls:["zoomControl"],behaviors:["default","scrollZoom"],type:{map:"yandex#map",satellite:"yandex#satellite",hybrid:"yandex#hybrid"}[e]})}setPlaces(){let{map:t,data:e}=this;if(!t)return;t.geoObjects.removeAll();let i=ymaps.templateLayoutFactory.createClass('<svg title="$[properties.balloonContent]" class="placemark" width="32" height="48" viewBox="0 0 24 32" xmlns="http://www.w3.org/2000/svg"><path d="M12 0C5.36 0 0 5.36 0 12c0 8 12 20 12 20s12-12 12-20c0-6.64-5.36-12-12-12zm0 8a4 4 0 0 1 4 4c0 2.22-1.78 4-4 4a4 4 0 0 1-4-4c0-2.2 1.8-4 4-4z" fill="$[properties.color]" fill-rule="evenodd"/></svg>');ymaps.layout.storage.get("custom#placemark")||ymaps.layout.storage.add("custom#placemark",i),e.places.forEach((s,a)=>{s.color=s.color||"#3D52B0";let n=new ymaps.Placemark(s.coords,{balloonContentHeader:s.name||!1,balloonContent:s.address,color:s.color},{hideIconOnBalloonOpen:!1,balloonOffset:[0,-48],balloonCloseButton:!1,iconLayout:"custom#placemark",iconShape:{type:"Rectangle",coordinates:[[-16,-48],[16,0]]}});n.events.add("balloonopen",()=>{this.$component.trigger("balloonOpen",a,s)}),t.geoObjects.add(n),s._mark=n})}dispatchEvents(){let{data:t,map:e}=this,i=!1;e&&(this.$component.on("selectMark",async(s,a)=>{if(t.places.length&&t.places[a]){let n=t.places[a];await e.setCenter(n.coords,t.zoom,{duration:350,checkZoomRange:!0}),await e.setCenter(n.coords),n._mark&&n._mark.balloon.open()}}),this.$component.on("mousedown",()=>{i=!0,this.$component.trigger("preventSliderMove",{state:!0}),this.$component.trigger("reduceSliderControls",{state:!0})}),$(window).on("mouseup",()=>{i&&(this.$component.trigger("preventSliderMove",{state:!1}),this.$component.trigger("reduceSliderControls",{state:!1}),i=!1)}))}fixBehavior(){let{map:t}=this;if(!t)return;let e;t.behaviors.disable("scrollZoom"),this.$component.off("mouseenter.preventzoom").on("mouseenter.preventzoom",()=>{e=setTimeout(()=>{t.behaviors.enable("scrollZoom")},500)}),this.$component.off("mouseleave.preventzoom").on("mouseleave.preventzoom",()=>{e&&(clearTimeout(e),t.behaviors.disable("scrollZoom"))}),flexbe_cli.run.is_mobile&&t.behaviors.disable("drag")}},pt=class{constructor(t){var e;return((e=t.component.getAttribute("data-type"))!=null?e:"google")==="yandex"?new Qt(t):new Xt(t)}};pt.is="map";flexbe_cli.entity.setClientJs("element","map01",{components:[pt]});var Zt="swiper-slide",mt=class extends _{constructor(...t){super(...t),this.require=["/_s/lib/swiper8/dist/swiper-bundle.min.js?v847"];let{component:e}=this;this.swiper=null,this.initialSlide=0,this.index=$(e).closest("[data-item-id]").attr("data-item-id"),this.sliderEl=e.classList.contains("swiper")?e:e.querySelector(".swiper"),this.paginationEl=e.querySelector(".slider-pagination"),this.prevEl=e.querySelector('.slider-prev, [data-direction="prev"]'),this.nextEl=e.querySelector('.slider-next, [data-direction="next"]'),this.$component.on("bringIntoView",i=>{let s=this.swiper,a=$(this.sliderEl).find(`.${Zt}`),n=$(i.target).closest(`.${Zt}`),o=a.index(n);s?o!==-1&&s.slideTo(o):this.initialSlide=o}),this.setSwiperOptions()}onLoad(){this.inScreen&&!this.swiper&&this.initSwiper()}onScreen({state:t}){t&&this.isLoaded&&!this.swiper&&this.initSwiper()}onView({state:t}){this.isLoaded&&(t&&!this.swiper&&this.initSwiper(),this.swiper&&this.toggleAutoplay({state:t}))}onResize(){this.swiper&&(this.setSliderSize(),this.setThumbnailsSize(),this.swiper&&this.swiper.initialized&&this.swiper.update())}onDestroy(){this.destroySwiper()}onHideShowUI(t){this.setSwiperOptions(t!=="editor"),this.destroySwiper(),this.initSwiper()}setSwiperOptions(t=flexbe_cli.run.is_preview){let e=this.paginationEl&&this.paginationEl.getAttribute("data-type")||"bullets",i=this.paginationEl&&this.paginationEl.getAttribute("data-direction")||"horizontal",s=!!Number(this.$component.attr("data-loop")),a=Number(this.$component.attr("data-autoplay"));this.options={paginationType:e,direction:i,count:this.$component.attr("data-count"),loop:t&&s,autoplay:t&&a||!1,effect:this.$component.attr("data-effect")||"slide",slidesPerView:"auto"}}initSwiper(){if(this.swiper||typeof Swiper>"u")return!1;let{options:t,component:e,core:i,root:s,index:a,sliderEl:n,paginationEl:o,prevEl:l,nextEl:d}=this,h=`${i&&i.id||"-"}:${a}`,{count:u,loop:f,paginationType:g,effect:c,direction:p}=t,m=flexbe_cli.theme_id===4,v=this.owner.closest(".swiper-inited"),C=!!t.autoplay&&{delay:1e3*t.autoplay,stopOnLastSlide:!f,disableOnInteraction:!1,waitForTransition:!1},S=this.initialSlide;flexbe_cli.run.is_preview||(s._sliderState?s._sliderState[h]&&(S=Math.max(0,Math.min(u-1,s._sliderState[h])||0)):s._sliderState={},s._sliderState[h]=S);let F={el:o,type:g,clickable:!0,dynamicBullets:m,dynamicMainBullets:3};g==="thumbs"&&(F.type=!1,F.el=null,this.thumbsSwiper=new Swiper(o,{cssMode:!0,loop:!1,slidesPerView:"auto",normalizeSlideIndex:!1,direction:p}));let y=new Swiper(n,{init:!1,speed:350,nested:v,slideClass:Zt,initialSlide:S,autoplay:C,pagination:F,thumbs:{swiper:this.thumbsSwiper},navigation:{prevEl:l,nextEl:d},effect:c,rewind:f,roundLengths:!0,preventInteractionOnTransition:!0,updateOnWindowResize:!1,slidesPerView:t.slidesPerView,simulateTouch:!flexbe_cli.run.isTouch&&flexbe_cli.run.is_preview,longSwipesMs:100,longSwipesRatio:.1,preloadImages:!1,touchReleaseOnEdges:!1,runCallbacksOnInit:!1});var N;if(this.swiper=y,c==="fade"?gt(y):m&&((N=y).params.virtualTranslate=!0,N.params.cssMode=!0),y.onAny((x,b)=>{y.el.dispatchEvent(new CustomEvent(`swiper:${x}`,{detail:b,bubbles:!1,cancelable:!0}))}),y.on("init",()=>{var x;if(!y.slides)return;this.setSliderSize(),this.setThumbnailsSize(),this.swiper!=null&&this.swiper.$el.addClass("swiper-inited"),$(l).add(d).add(o).removeClass("disabled");let b=y.slides[S],E=y.visibleSlides||[y.slides[S]];this.thumbsSwiper&&(x=this.thumbsSwiper.visibleSlides)!=null&&x.length&&E.push(...this.thumbsSwiper.visibleSlides),lt(E),b&&z(b,!1,"sliderActivate"),this.toggleAutoplay({state:this.inView})}),this.thumbsSwiper&&this.thumbsSwiper.on("slideChange",$.debounce(x=>{lt(x.visibleSlides)},50)),y.on("slideChange",$.debounce(()=>{if(!y.initialized)return;flexbe_cli.run.is_preview||(s._sliderState[h]=y.realIndex);let x=y.slides[y.previousIndex],b=y.slides[y.activeIndex],E=b&&b.getAttribute("data-type"),T=y.previousIndex<y.activeIndex?Array.from(y.slides).slice(y.activeIndex,y.activeIndex+2):Array.from(y.slides).slice(y.activeIndex-2,y.activeIndex);e.setAttribute("data-current-content",E),z(x,null,"sliderDeactivate"),z(b,null,"sliderActivate"),lt(T)},50)),y.on("touchStart",()=>{$(n).addClass("swiper-in-interacting")}),y.on("touchEnd",()=>{$(n).removeClass("swiper-in-interacting")}),y.params.cssMode){let x;y.on("slideChange",()=>{clearTimeout(x),y.animating=!0,y.allowSlidePrev=!1,y.allowSlideNext=!1,x=setTimeout(()=>{y.animating=!1,y.allowSlidePrev=!0,y.allowSlideNext=!0},150)})}this.$component.off("reduceSliderControls").on("reduceSliderControls",(x,{state:b=!0})=>{this.preventAutoplay=!!b,this.preventAutoplay&&this.toggleAutoplay({state:!1})}),this.$component.off("pointerenter").one("pointerenter",()=>{let x=Array.from(y.slides||[]),b=[y.activeIndex-1,y.activeIndex+1].map(E=>x.at(E));lt(b)}),this.$component.off("pointerdown wheel").on("pointerdown wheel",()=>{this.toggleAutoplay({state:!1})}),ne(()=>y.init())}destroySwiper(){if(this.swiper)try{this.swiper.destroy()}catch{}finally{this.swiper=null}}toggleAutoplay({state:t}){let{swiper:e,options:i}=this;if(!e||!i.autoplay||!e.autoplay)return!1;this.preventAutoplay&&(t=!1);let s=e.autoplay.running;t&&!s&&e.autoplay.start(),!t&&s&&e.autoplay.stop()}slideTo(t,e=!0){if(!this.swiper)return void(this.initialSlide=t);let i=this.swiper.params.loop;this.swiper.realIndex!==void 0&&this.swiper.realIndex!==t&&(i?this.swiper.slideToLoop(t,e?null:0):this.swiper.slideTo(t,e?this.swiper.params.speed:0))}setSliderSize(){let t=this.$component.find(".swiper");if(!t.length)return;let e=t[0];e.style.width="";let i=e.getBoundingClientRect().width,s=e.offsetWidth;if(i%1>0&&Math.abs(s-i)<2){e.style.width=`${Math.round(i)}px`;try{this.swiper.update()}catch{}}}setThumbnailsSize(){if(!this.thumbsSwiper||this.options.paginationType!=="thumbs")return;let t=this.options.direction==="horizontal",e=$(this.paginationEl),i=e.find(".thumb-item"),s=i.length,a=this.thumbsSwiper.params.slidesPerView;e.add(i).css({"--thumbSize":"","--thumbPad":"",width:"",height:""});let n=parseInt(i.css("--thumbPad"),10),o=t?e[0].offsetWidth:e[0].offsetHeight,l=t?i[0].offsetWidth:i[0].offsetHeight,d=Math.max(2,Math.round(o/(l+n)));s>=2&&(s===d+1||s===d-1)?d=s:!a||a!==d+1&&a!==d-1||(d=a),e.toggleClass("is-filled",s>=d),this.thumbsSwiper.params.slidesPerView=d,this.thumbsSwiper.params.spaceBetween=n,this.thumbsSwiper.update(),this.thumbsSwiper.slides.forEach(h=>{h.style.setProperty("--thumbSize",`${h.swiperSlideSize}px`)})}};mt.is="slider";flexbe_cli.entity.setClientJs("element","media01",{components:[R,X,mt]});var Et=class{get isOnScreen(){if(!this.$tabsList)return!1;let{top:t,height:e}=this.$tabsList[0].getBoundingClientRect();return t>0&&t+e<flexbe_cli.resize.viewportHeight}constructor(t){if(this.inited=!1,this.interacted=!1,this.opts=void 0,this.$area=void 0,this.uidAttr=void 0,this.classContainer=void 0,this.activeUid=void 0,this.$activeTab=void 0,this.$activeSection=void 0,this.$mainContainer=void 0,this.$tabsContainer=void 0,this.$tabsList=void 0,this.$swiperHelper=void 0,this.$tabs=void 0,this.$sections=void 0,this.opts=t,this.$area=t.$area,this.uidAttr=t.uidAttr||"data-tab-uid",this.classContainer=t.classContainer,this.initTabs(),t.activeUid)this.selectTab(t.activeUid);else if(window.location.hash){let e=window.location.hash.replace("#",""),i=$(`._anchor[name="${e}" i]`),s=i.length?i.closest("[data-id]"):$(`[data-id="${e}" i]`),a=i[0]||s[0];a&&this.selectTabFromTarget(a)}this.$area.on("bringIntoView",e=>this.selectTabFromTarget(e.target))}initTabs(){if(this.$mainContainer=this.classContainer==="self"?this.$area:this.$area.find(this.classContainer),this.$tabsContainer=this.$area.find(".container-tabs"),this.$tabsList=this.$area.find('[role="tablist"]'),this.$swiperHelper=this.$area.find(".tab-swiper-helper"),this.inited=!!this.$tabsList.length,this.inited&&(this.$tabs=this.$tabsList.find('[role="tab"]'),this.$sections=this.$mainContainer.find('[role="tabpanel"]'),flexbe_cli.is_admin&&this.normalizeLines(),setTimeout(()=>{this.$mainContainer.addClass("main-area--tabs-inited")},50),this.$tabsContainer.on("click",".tab",t=>{let e=$(t.currentTarget).closest(`[${this.uidAttr}]`).attr(`${this.uidAttr}`);e&&this.selectTab(e)}),this.$tabsList.on("wheel",t=>{let e=this.$tabsList[0],i=t.originalEvent.wheelDeltaX,s=t.originalEvent.wheelDeltaY;e.scrollWidth<=e.clientWidth||s<0&&e.scrollLeft===0||s>0&&e.scrollLeft===e.scrollWidth-e.clientWidth||flexbe_cli.run.is_pointer&&!i&&s&&(t.preventDefault(),e.scrollLeft+=s)}),this.$tabsList.on("touchstart",()=>{this.interacted=!0,this.destroySwipeAnimation()}),flexbe_cli.is_admin)){let t;this.$tabsContainer.on("mouseenter",".tab",e=>{e.buttons===1&&document.body.classList.contains("state--in-move")&&(clearTimeout(t),t=setTimeout(()=>{let i=$(e.target).closest(`[${this.uidAttr}]`).attr(`${this.uidAttr}`);this.selectTab(i)},700))}),this.$tabsContainer.on("mouseleave",".tab",()=>{clearTimeout(t)})}}swipeAnimationController(){if(!this.inited)return;let t=this.$tabsList[0]&&this.$tabsList[0].scrollWidth>this.$tabsList[0].clientWidth,e=this.isOnScreen;t&&e?this.initSwiperAnimation():e||this.destroySwipeAnimation()}initSwiperAnimation(){this.$swiperHelper.hasClass("show")||this.interacted||this.$swiperHelper.addClass("show")}destroySwipeAnimation(){this.$swiperHelper.hasClass("show")&&this.$swiperHelper.removeClass("show")}selectTabFromIndex(t){let e=this.$tabs.get(t);this.selectTabFromTarget(e)}selectTabFromTarget(t){let e=$(t).closest(`[${this.uidAttr}]`).attr(`${this.uidAttr}`);this.selectTab(e)}selectTab(t,{force:e}={}){var i,s;if(!t||!e&&this.activeUid===t)return;this.inited||this.initTabs();let a=(i=(s=this.$tabs)==null?void 0:s.filter(`[${this.uidAttr}="${t}"]`))!=null?i:[];if(!a.length)return;let n=this.$sections.filter(".active"),o=n[0]&&n[0].offsetTop,l=this.$sections.filter(`[${this.uidAttr}="${t}"]`);this.scrollToTab(a),this.$tabs.removeClass("active").attr("aria-selected",!1).attr("tabindex",-1),a.addClass("active").attr("aria-selected",!0).attr("tabindex",0),this.$sections.removeClass("active").prop("hidden",!0),l.addClass("active").prop("hidden",!1);let d=l[0]&&l[0].offsetTop;if(this.activeUid=t,this.$activeTab=a,this.$activeSection=l,n[0].dispatchEvent(new CustomEvent("element-become-hidden")),l[0].dispatchEvent(new CustomEvent("element-become-visible")),typeof this.opts.onSelectTab=="function"&&this.opts.onSelectTab({uid:t,$tab:a}),!flexbe_cli.run.is_mobile&&o!=null&&d!=null&&Math.abs(o-d)>0&&typeof anime<"u"){let h=this.$mainContainer,u=o-d;h.css("will-change","transform"),anime({targets:h[0],translateY:[u,0],duration:250,easing:"easeOutCubic",complete:()=>{h.css({transform:"","will-change":""})}})}}normalizeLines(){if(!this.inited)return;let t,e=this.$tabs;this.$tabsList.find(".tab-spacer").remove(),e.removeClass("first-in-line last-in-line"),e.first().addClass("first-in-line"),e.last().addClass("last-in-line"),e.each((i,s)=>{t&&t.offsetTop!==s.offsetTop&&($(s).addClass("first-in-line"),$(t).addClass("last-in-line"),$(t).after('<span class="tab-spacer"></span>')),t=s})}scrollToTab(t){if(!this.inited)return;let e=this.$tabsList,i=e[0].scrollWidth;if(i>e[0].offsetWidth){let s=t[0].offsetLeft,a=t[0].getBoundingClientRect(),n=flexbe_cli.resize.viewportWidth,o;a.width>n||a.left<20?o=s-20:a.right>n-20&&(o=s-(n-20-a.width)),o!=null&&(o=Math.max(0,Math.min(i-n,o)),e.animate({scrollLeft:o},{duration:250}))}}resetHash(){this.inited&&String(window.location.hash).replace(/^#{1,2}(tab)?/,"")===this.activeUid&&(flexbe_cli.lockPopstate=!0,window.history.replaceState(null,null,window.location.pathname),flexbe_cli.lockPopstate=!1)}};flexbe_cli.entity.setClientJs("block","BUNDLE",{components:[k],tabsController:void 0,shouldInitTabs:!0,onUpdate({templateRendered:r,reasonData:t}){r&&(this.shouldInitTabs=!0),["create","copy"].includes(t.source)&&requestAnimationFrame(()=>this.tabsController.selectTabFromIndex(t.to))},onResize(){this.tabsController&&this.tabsController.normalizeLines()},onBeside({state:r}){r&&this.shouldInitTabs&&this.createTabs()},onScreen({state:r}){this.tabsController&&(r||(this.tabsController.swipeAnimationController(),this.tabsController.resetHash()))},onFocus({state:r}){this.tabsController&&r&&this.tabsController.swipeAnimationController()},createTabs(){this.shouldInitTabs=!1,this.$area.find('[role="tabpanel"]').length?this.tabsController=new Et({$area:this.$area,classContainer:".main-area",activeUid:this.selectedTabUid,onSelectTab:({uid:r})=>{this.selectedTabUid=r,this.updateTween()}}):this.tabsController=null}});flexbe_cli.entity.setClientJs("block","FOOTER",{components:[k]});flexbe_cli.entity.setClientJs("block","FREE",{components:[k]});flexbe_cli.entity.setClientJs("block","HEADER",{onInit(){flexbe_cli.is_admin&&(flexbe_cli.events.off(`layout_change.${this.id}`).on("layout_change.anchors",$.debounce(r=>{r?.action==="layout_render"&&this.fixOverlayContrast()},200)),flexbe_cli.events.on(`entity_render:template.${this.id}`,r=>{r.is==="block"&&this.fixOverlayContrast()}))},onDestroy(){flexbe_cli.events.off(`layout_change.${this.id}`)},onLoad(){this.ownContrast=this.$area.attr("data-contrast")||"auto",this.isOverlayed=this.$area.attr("data-overlayed")||!1,this.fixOverlayContrast()},onHideShowUI(){this.fixOverlayContrast()},fixOverlayContrast(){if(this.isOverlayed&&this.ownContrast==="auto"){let r=(this.$area.parent().is(".b_block")?this.$area.parent():this.$area).nextAll(".b_block:visible:not([data-overlayed])").eq(0).attr("data-contrast");r&&(this.$area.attr("data-static-contrast",r),this.$area.attr("data-contrast",r))}}});flexbe_cli.entity.setClientJs("element","button01",{components:[Z,D],isPure:!0});
